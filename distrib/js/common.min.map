{"version":3,"file":"common.min.js","sources":["common.js"],"names":["VERSION","guid","Object","create","CachedFunction","slice","Array","prototype","_","attributes","eventHandlers","-1","addEvent","event","type","push","handler","scope","addEventHandler","argTypeOrMap","argHandlerOrScope","argScope","eventMap","eventString","events","split","i","l","length","eventType","call","this","_guid","addGuid","object","forceGuid","attr","clone","obj","typeOf","extend","proto","createSubclass","props","includeEvents","constructor","Error","on","realConstructor","apply","arguments","superclass","hasOwnProperty","Events","extendThis","parent","subclass","key","emitEvents","data","explicitType","explicitGuid","handlers","args","shift","unshift","makeUuid","replace","c","r","Math","random","v","toString","removeAttribute","keys","silent","trim","mutateData","oldValue","emit","removeEventHandler","h","splice","setAttribute","value","itemExists","has","newValue","specificEvent","str","val","String","toLowerCase","updateAttribute","fn","item","get","types","splittedTypes","all","off","Module","each","ctx","filter","filtered","input","results","items","getAll","getAllAsArray","arr","id","map","mapped","remove","set","objOrKey","valueOrSilent","size","update","keyOrFn","Stapes","mixinEvents","classOnly","version","exports","module","define","amd","window","IX","currentVersion","isEmptyFn","undefined","BaseTypes","function","Function","string","boolean","Boolean","number","Number","isTypeFn","typeUtils","isEmpty","isBoolean","isObject","isString","isNumber","isFn","isArray","ob","isElement","el","nodeType","getClass","match","loopFn","varr","sIdx","eIdx","acc0","fun","isAscLoop","len","acc","min","max","xlen","idx","iterateFn","loopUtils","iterate","fnIterate","fname","loop","loopbreak","_ex","partLoop","loopDsc","p","arrUtils","cvtToArray","iterable","toArray","cloneFn","Date","RegExp","propertyName","property","deepCompare","y","x","propertyUtils","hasProperty","pName","ex","names","pObj","getProperty","defV","setProperty","_name","pop","_sname","e","getPropertyAsFunction","fName","emptyFn","nsLoopFn","nsname","nsObj","flag","curname","namespaceUtils","ns","name","nsExisted","setNS","getNS","objName","extendFn","dst","src","_p","extendUtils","inherit","getTimeInMS","getTime","ua","navigator","userAgent","checkUA","keywords","indexOf","hasEventListener","_handlerWrapper","evt","target","srcElement","_bindHandlers","isBind","isOnce","_EVENTNAMES","eventName","browserUtils","isMSIE7","document","isSafari","openDatabase","isMSIE","isOpera","isChrome","isFirefox","isMSWin","getComputedStyle","defaultView","currentStyle","style","getUrlParam","paramList","location","search","substring","listen","eName","etype","attachEvent","addEventListener","detachEvent","removeEventListener","bind","bindOnce","locationUtils","toAnchor","hash","selfFn","o","checkReadyFn","condFn","execFn","period","_config","_checkFn","maxAge","startTick","expireFn","setTimeout","_period","$XP","$XF","isNaN","executeUtils","safeExec","execute","checkReady","tryFn","domUtils","decodeTXT","txt","replaceAll","encodeTXT","createDiv","clz","node","createElement","className","body","appendChild","domEl","getElementById","errUtils","err","errMsg","alert","mathUtils","inRange","x1","x2","_idx","idUtils","ifRectIntersect","_rect1","_rect2","abs","maxx","minx","maxy","miny","$X","$XA","$XE","Test","detectAttrsFn","checkFn","injectorFn","count","nc","listFn","matchorFn","isListFn","n","trunc","join","listProp","matchor","listFun","log","s","console","getEqualFn","equalFn","a","b","equal","isFoundFn","elem","_merge","arr1","arr2","_arr1","_arr2","j","k","len1","len2","concat","_self","init","isFound","toSet","sort","cmpFn","isSameSet","compact","validFn","pushx","flat","matchFn","start","deleteCount","insertArray","iArr","merge","IState","toggle","origStat","newStat","IManager","_ht","isRegistered","register","unregister","clear","destroy","IList","_keyList","IXArray","indexOfFn","removeFn","appendFn","isLast","getList","getSize","tryRemove","append","tryAdd","insertBefore","dstKey","dstIdx","I1ToNManager","eqFn","_eqFn","_mgr","hasEntryFn","list","hasValue","put","IListManager","_super","_list","registerFn","hasKey","isLastKey","getKeys","getByKeys","getFirst","inst","DataStore","_items","_fields","row","col","_isUTC","fields4Day","fields4Time","ds","ts","_formatStr","sp","nstr","multi","substr","_format","date","fields","getPrefix","format","checkData","checkTime","isValid","isDate","sps","m","d","setDS","setTS","setUTC","isUTC","getDS","getTS","formatDate","formatTime","formatStr","formatDateStr","formatTimeStr","getDateText","olderTSInSec","tsInSec","interval","round","dateStr","dt","getDateByFormat","_dateStr","_formatType","_dateObj","dateFormat","getFullYear","_month","getMonth","_day","getDate","_hour","getHours","_minute","getMinutes","_second","getSeconds","getTimeTickInSec","_str","parseInt","Net","head","getElementsByTagName","getRequestFn","XMLHttpRequest","ActiveXObject","loadFn","durl","cbFun","request","onreadystatechange","readyState","status","responseText","statusText","open","send","loadJsFn","nextFn","script","onload","loadJsFilesInSeqFn","jsFiles","_nextFn","loadCssFn","cssFile","cssNode","rel","href","media","loadFile","loadCss","loadJsFiles","nextFun","fnName","argList","dependencyConfig","afterFn","config","beforeFn","cssFiles","delay","win","fnHT","eventFnHT","handlersHT","keySn","genKey","executeEvent","fKey","_register","_key","_unregister","fnKey","bindFn","ids","unbind","handlerIds","scrollTo","$Xw","defaultParamFn","_params","defaulRspFn","cbFn","getFunProp","_cfg","defFn","_fn","ajaxRouteFn","callerRouteDef","channel","dataType","onsuccess","preAjax","postAjax","onfail","urlRouteFn","routeDef","ifAjax","_url","route","url","urlType","createRouteHT","routes","UrlRouter","urlFac","_routeHT","params","genUrl","tryLockChannel","unlockChannel","parentNode","removeChild","AjaxCaller","_ajaxFn","_callerHT","failFn","_caller","_channel_","_t","code","_cbFn","_contentType","_data","JSON","stringify","contentType","success","fail","error","UrlFactory","_urls","_route","replaceByParams","_urlBase","baseUrl","cfg","UrlEngine","_urlFac","ajaxFn","reset","createRouter","createCaller","ajaxParam","urlEngine","ajaxEngine","Xml","parser","doc","DOMParser","parseFromString","async","loadXML","getXmlString","xmlDoc","XMLSerializer","serializeToString","xml","duplicate","Dom","valueFn","cnode","nextSibling","getFn","tagN","nodeName","textFn","innerText","textContent","cdataFn","nodeValue","firstFn","inTagFn","tag","content","attrs","_attrs","inPureTagFn","attrFn","attN","getAttribute","setAttrFn","first","next","cdata","text","setAttr","dataAttr","setDataAttr","isAncestor","ancestor","tagName","is","inTag","inPureTag","$XD","HtmlDocument","hasFn","clzName","addFn","clzs","getStyle","_elem","styles","_value","filters","opacity","camelize","_css","getPropertyValue","_i","display","capitalize","hasClass","removeClass","addClass","toggleClass","parentEl","firstChild","pnode","getWindowScreen","documentElement","_scrollX","scrollX","scrollLeft","_scrollY","scrollY","scrollTop","scroll","scrollWidth","scrollHeight","clientWidth","clientHeight","getScroll","_dom","_window","parentWindow","pageYOffset","pageXOffset","getZIndex","zIndex","offsetParent","rect","ri","getWindowScrollTop","getPosition","isFixed","getBoundingClientRect","left","top","offsetWidth","offsetHeight","$XH","Cookie","getOptions","options","vals","expires","toUTCString","setTime","path","domain","secure","_set","encodeURIComponent","cookie","cookies","cookieN","decodeURIComponent","Task","taskFn","times","execFlag","_times","_total","_ts","stop","clearTimeout","tplRegex","rpRegex","idRegex","regSplit","reg","_splitArr","_matchArr","_len","_arr","separate","parseTpl","tplstr","tplMgr","newTpl","html","tpl","appendTpl","reformTpl","curTpl","_openTpl","newName","newTplName","_closeTpl","_regSplit","tplArr","contentArr","nameArr","emptyTpl","render","renderData","getTpl","ITemplate","_tpl","_dataFn","getProps","renderFn","tplId","t","charAt","itm","idata","loopReplace","_render","_get_p_tpl","_id","tm","ci","substrByLength","maxLength","stringArr","matchPRC_regx","strLen","simpleCharLen","subStringByMaxLength","reString","reLength","stringLength","UrlRegEx","EmailPattern","ScriptPattern","FormPattern","TrimPattern","ReplaceKeyPattern","B","A","toUpperCase","os","end","ws","test","stripTags","stripScripts","stripFormTag","strip","isSpaces","isPassword","isEmail","email","exec","tail","dehtml","enhtml","pickUrls","replaceUrls","_r","_f","pick4Replace","toSafe","padLeft","nLen","ch","padRight","movePointLeft","scale","s1","s2","ps","sign","movePointRight","movePoint","__method","UUID","itoh","generate","floor","Util","Image","_getImageDataUrl","img","cw","w","canvas","width","height","getContext","drawImage","dataURL","toDataURL","getRatioWH","rw","rh","wratio","hratio","getImageData","imgEl","wh","setImageData","imgData","keepRatio","cwEl","getData","setData","timeInSecond","getFieldValues","_time","f","time","toText","toWeek","toDate","incYear","curTime","toTime","toShort","strs","shouldAppend","toInterval","_date","toSimpleInterval","Event","stopPropagation","cancelBubble","preventDefault","returnValue","getIXScriptEl","scripts","ixEl","SELF_PATH","SCRIPT_ROOT","urlItemFn","columns","urlDef","RouteAttrDefValue","UrlStore","_routes","_urlItemFn","routeName","urlList","_urlGenerator","urlGenerator","createEntries","isCaller","isRef","ajaxStore","initEngine","urlStore","Hualala","mappingUrls","genUrls","createRoute","Common","getSourceImage","settings","watermark","cut","offsetX","offsetY","rotate","quality","imgDomain","Global","IMAGE_RESOURCE_WATERMARK_DOMAIN","IMAGE_RESOURCE_DOMAIN","lastSlash","lastIndexOf","fileName","suffix","scaleE","cutE","paramE","scaleRule","percent","lockMin","lockMax","unlock","lockMinZoomOut","lockMinZoomIn","lockMaxZoomOut","lockMaxZoomIn","unlockZoomOut","unlockZoomIn","cutRule","normal","ret","jQuery","$","loadImageErr","defaultPhotoImg","avatarFn","getDefaultImage","formatDateTimeValue","fullLen","setCenter","offset","strByteLength","sum","charCode","charCodeAt","substrByte","s3","Browser","browser","getMinuteIntervalOptions","Constants","SecondsOfDay","parseForm","form","$form","serializeArray","result","codeMask","orig","mapBankInfo","bankCode","banks","TypeDef","BankOptions","bankHT","iconSizes","icons","getGender","GENDER","find","getOrderStatus","OrderStatus","getShopUrl","shopID","HualalaWebSite","prettyNumeric","num","separator","l1","restoreNumeric","prettyPrice","price","parseFloat","toFixed","dot","add","baseNum","v1","sub","precision","numberToFixed","div","ceil","SiteNavType","label","OrderSubNavType","pkeys","valueStr","ShopNoteType","TASTE","COOKING","FOOD_COMMENT","ORDER_COMMENT","FREE_REASON","RETURN_REASON","CHARGE_BACK","OrderSubType","EATIN","RESERVE","Flash","DIY","QUEUE","TAKEOUT","PICKUP","TimeID","allday","breakfast","lunch","afternoon","dinner","supper","ShopStatus","FoodAttr","AUTOADD","SPECIALTY","RECOMMEND","NEW","DISCOUNT","COMMENTS","CANREFUND","SETFOOD","TakeawayTag","NOTAKEAWAY","TAKEAWAY","ONLYTAKEAWAY","HASIMAGE","FSMTransType","queryCall","queryKeys","FSMTransStatus","FSMTransDetail","AccountReceiverTypes","ShopBusiness","businessIsSupported","callServer","formKeys","operationMode",1,"PayMethodOptions","PayMethodAtShopOptions","FetchFoodModeOptions","HolidayFlagOptions","MinuteIntervalOptions","endMin","gap","cur","minsOfHour","SecondsOfHour","minsOfDay","day","hour","NameOfDay","SecondsOfWeek","NumberKeys","Alphabet","PersonUnit","CashUnit","Router","mode","root","history","clearSlashes","getFragment","fragment","decodeURI","pathname","re","param","flush","check","self","current","clearInterval","setInterval","navigate","pushState","Pymatch","name2pys","setNames","is_sim","sa","simpy","sb","getAlt","py","c2","c1","sc","split2","pinyin","cache","pymatch","pyprefix","pys","isHz","W_first_exactly_match","W_other_match","alt","W_fuzzy_match","W_zcs_match_zhchsh","pmatch","pattern","inplace","q","W_hzmatch","match2","input_c","ai","stkp","instr","is_py","pyidx","ti","tpys","tn","tpy","stack","rnames","name2py","hz","nhz","searchLetter","handledIdx","bi","bn","back","get_match","get_input","langs","Matcher","lang","_matcher","_loadMatchConfig","callback","_match","refresh"],"mappings":"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","sourcesContent":["/** \r\n * -------------------------------------------------\r\n * Copyright (c) 2014, All rights reserved. \r\n * Hualala-Merchant-Management\r\n * \r\n * @version : 0.1.0\r\n * @author : HuHao\r\n * @description : Hualala Merchant Management System.  \r\n * -------------------------------------------------\r\n */ \r\n\r\n//\r\n//  ____  _                           _\r\n// / ___|| |_ __ _ _ __   ___  ___   (_)___  (*)\r\n// \\___ \\| __/ _` | '_ \\ / _ \\/ __|  | / __|\r\n//  ___) | || (_| | |_) |  __/\\__ \\_ | \\__ \\\r\n// |____/ \\__\\__,_| .__/ \\___||___(_)/ |___/\r\n//              |_|              |__/\r\n//\r\n// (*) the Javascript MVC microframework that does just enough\r\n//\r\n// (c) Hay Kranen < hay@bykr.org >\r\n// Released under the terms of the MIT license\r\n// < http://en.wikipedia.org/wiki/MIT_License >\r\n//\r\n// Stapes.js : http://hay.github.com/stapes\r\n;(function() {\r\n    'use strict';\r\n\r\n    var VERSION = \"0.8.1\";\r\n\r\n    // Global counter for all events in all modules (including mixed in objects)\r\n    var guid = 1;\r\n\r\n    // Makes _.create() faster\r\n    if (!Object.create) {\r\n        var CachedFunction = function(){};\r\n    }\r\n\r\n    // So we can use slice.call for arguments later on\r\n    var slice = Array.prototype.slice;\r\n\r\n    // Private attributes and helper functions, stored in an object so they\r\n    // are overwritable by plugins\r\n    var _ = {\r\n        // Properties\r\n        attributes : {},\r\n\r\n        eventHandlers : {\r\n            \"-1\" : {} // '-1' is used for the global event handling\r\n        },\r\n\r\n        guid : -1,\r\n\r\n        // Methods\r\n        addEvent : function(event) {\r\n            // If we don't have any handlers for this type of event, add a new\r\n            // array we can use to push new handlers\r\n            if (!_.eventHandlers[event.guid][event.type]) {\r\n                _.eventHandlers[event.guid][event.type] = [];\r\n            }\r\n\r\n            // Push an event object\r\n            _.eventHandlers[event.guid][event.type].push({\r\n                \"guid\" : event.guid,\r\n                \"handler\" : event.handler,\r\n                \"scope\" : event.scope,\r\n                \"type\" : event.type\r\n            });\r\n        },\r\n\r\n        addEventHandler : function(argTypeOrMap, argHandlerOrScope, argScope) {\r\n            var eventMap = {},\r\n                scope;\r\n\r\n            if (typeof argTypeOrMap === \"string\") {\r\n                scope = argScope || false;\r\n                eventMap[ argTypeOrMap ] = argHandlerOrScope;\r\n            } else {\r\n                scope = argHandlerOrScope || false;\r\n                eventMap = argTypeOrMap;\r\n            }\r\n\r\n            for (var eventString in eventMap) {\r\n                var handler = eventMap[eventString];\r\n                var events = eventString.split(\" \");\r\n\r\n                for (var i = 0, l = events.length; i < l; i++) {\r\n                    var eventType = events[i];\r\n                    _.addEvent.call(this, {\r\n                        \"guid\" : this._guid || this._.guid,\r\n                        \"handler\" : handler,\r\n                        \"scope\" : scope,\r\n                        \"type\" : eventType\r\n                    });\r\n                }\r\n            }\r\n        },\r\n\r\n        addGuid : function(object, forceGuid) {\r\n            if (object._guid && !forceGuid) return;\r\n\r\n            object._guid = guid++;\r\n\r\n            _.attributes[object._guid] = {};\r\n            _.eventHandlers[object._guid] = {};\r\n        },\r\n\r\n        // This is a really small utility function to save typing and produce\r\n        // better optimized code\r\n        attr : function(guid) {\r\n            return _.attributes[guid];\r\n        },\r\n\r\n        clone : function(obj) {\r\n            var type = _.typeOf(obj);\r\n\r\n            if (type === 'object') {\r\n                return _.extend({}, obj);\r\n            }\r\n\r\n            if (type === 'array') {\r\n                return obj.slice(0);\r\n            }\r\n        },\r\n\r\n        create : function(proto) {\r\n            if (Object.create) {\r\n                return Object.create(proto);\r\n            } else {\r\n                CachedFunction.prototype = proto;\r\n                return new CachedFunction();\r\n            }\r\n        },\r\n\r\n        createSubclass : function(props, includeEvents) {\r\n            props = props || {};\r\n            includeEvents = includeEvents || false;\r\n\r\n            var superclass = props.superclass.prototype;\r\n\r\n            // Objects always have a constructor, so we need to be sure this is\r\n            // a property instead of something from the prototype\r\n            var realConstructor = props.hasOwnProperty('constructor') ? props.constructor : function(){};\r\n\r\n            function constructor() {\r\n                // Be kind to people forgetting new\r\n                if (!(this instanceof constructor)) {\r\n                    throw new Error(\"Please use 'new' when initializing Stapes classes\");\r\n                }\r\n\r\n                // If this class has events add a GUID as well\r\n                if (this.on) {\r\n                    _.addGuid( this, true );\r\n                }\r\n\r\n                realConstructor.apply(this, arguments);\r\n            }\r\n\r\n            if (includeEvents) {\r\n                _.extend(superclass, Events);\r\n            }\r\n\r\n            constructor.prototype = _.create(superclass);\r\n            constructor.prototype.constructor = constructor;\r\n\r\n            _.extend(constructor, {\r\n                extend : function() {\r\n                    return _.extendThis.apply(this, arguments);\r\n                },\r\n\r\n                // We can't call this 'super' because that's a reserved keyword\r\n                // and fails in IE8\r\n                'parent' : superclass,\r\n\r\n                proto : function() {\r\n                    return _.extendThis.apply(this.prototype, arguments);\r\n                },\r\n\r\n                subclass : function(obj) {\r\n                    obj = obj || {};\r\n                    obj.superclass = this;\r\n                    return _.createSubclass(obj);\r\n                }\r\n            });\r\n\r\n            // Copy all props given in the definition to the prototype\r\n            for (var key in props) {\r\n                if (key !== 'constructor' && key !== 'superclass') {\r\n                    constructor.prototype[key] = props[key];\r\n                }\r\n            }\r\n\r\n            return constructor;\r\n        },\r\n\r\n        emitEvents : function(type, data, explicitType, explicitGuid) {\r\n            explicitType = explicitType || false;\r\n            explicitGuid = explicitGuid || this._guid;\r\n\r\n            // #30: make a local copy of handlers to prevent problems with\r\n            // unbinding the event while unwinding the loop\r\n            var handlers = slice.call(_.eventHandlers[explicitGuid][type]);\r\n\r\n            for (var i = 0, l = handlers.length; i < l; i++) {\r\n                // Clone the event to prevent issue #19\r\n                var event = _.extend({}, handlers[i]);\r\n                var scope = (event.scope) ? event.scope : this;\r\n\r\n                if (explicitType) {\r\n                    event.type = explicitType;\r\n                }\r\n\r\n                event.scope = scope;\r\n                event.handler.call(event.scope, data, event);\r\n            }\r\n        },\r\n\r\n        // Extend an object with more objects\r\n        extend : function() {\r\n            var args = slice.call(arguments);\r\n            var object = args.shift();\r\n\r\n            for (var i = 0, l = args.length; i < l; i++) {\r\n                var props = args[i];\r\n                for (var key in props) {\r\n                    object[key] = props[key];\r\n                }\r\n            }\r\n\r\n            return object;\r\n        },\r\n\r\n        // The same as extend, but uses the this value as the scope\r\n        extendThis : function() {\r\n            var args = slice.call(arguments);\r\n            args.unshift(this);\r\n            return _.extend.apply(this, args);\r\n        },\r\n\r\n        // from http://stackoverflow.com/a/2117523/152809\r\n        makeUuid : function() {\r\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n                var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\r\n                return v.toString(16);\r\n            });\r\n        },\r\n\r\n        removeAttribute : function(keys, silent) {\r\n            silent = silent || false;\r\n\r\n            // Split the key, maybe we want to remove more than one item\r\n            var attributes = _.trim(keys).split(\" \")\r\n                ,mutateData = {}\r\n                ;\r\n\r\n            // Actually delete the item\r\n            for (var i = 0, l = attributes.length; i < l; i++) {\r\n                var key = _.trim(attributes[i]);\r\n\r\n                if (key) {\r\n                    // Store data for mutate event\r\n                    mutateData.key = key;\r\n                    mutateData.oldValue = _.attr(this._guid)[key];\r\n\r\n                    delete _.attr(this._guid)[key];\r\n\r\n                    // If 'silent' is set, do not throw any events\r\n                    if (!silent) {\r\n                        this.emit('change', key);\r\n                        this.emit('change:' + key);\r\n                        this.emit('mutate', mutateData);\r\n                        this.emit('mutate:' + key, mutateData);\r\n                        this.emit('remove', key);\r\n                        this.emit('remove:' + key);\r\n                    }\r\n\r\n                    // clean up\r\n                    delete mutateData.oldValue;\r\n                }\r\n            }\r\n        },\r\n\r\n        removeEventHandler : function(type, handler) {\r\n            var handlers = _.eventHandlers[this._guid];\r\n\r\n            if (type && handler) {\r\n                // Remove a specific handler\r\n                handlers = handlers[type];\r\n                if (!handlers) return;\r\n\r\n                for (var i = 0, l = handlers.length, h; i < l; i++) {\r\n                    h = handlers[i].handler;\r\n                    if (h && h === handler) {\r\n                        handlers.splice(i--, 1);\r\n                        l--;\r\n                    }\r\n                }\r\n            } else if (type) {\r\n                // Remove all handlers for a specific type\r\n                delete handlers[type];\r\n            } else {\r\n                // Remove all handlers for this module\r\n                _.eventHandlers[this._guid] = {};\r\n            }\r\n        },\r\n\r\n        setAttribute : function(key, value, silent) {\r\n            silent = silent || false;\r\n\r\n            // We need to do this before we actually add the item :)\r\n            var itemExists = this.has(key);\r\n            var oldValue = _.attr(this._guid)[key];\r\n\r\n            // Is the value different than the oldValue? If not, ignore this call\r\n            if (value === oldValue) {\r\n                return;\r\n            }\r\n\r\n            // Actually add the item to the attributes\r\n            _.attr(this._guid)[key] = value;\r\n\r\n            // If 'silent' flag is set, do not throw any events\r\n            if (silent) {\r\n                return;\r\n            }\r\n\r\n            // Throw a generic event\r\n            this.emit('change', key);\r\n\r\n            // And a namespaced event as well, NOTE that we pass value instead of\r\n            // key here!\r\n            this.emit('change:' + key, value);\r\n\r\n            // Throw namespaced and non-namespaced 'mutate' events as well with\r\n            // the old value data as well and some extra metadata such as the key\r\n            var mutateData = {\r\n                \"key\" : key,\r\n                \"newValue\" : value,\r\n                \"oldValue\" : oldValue || null\r\n            };\r\n\r\n            this.emit('mutate', mutateData);\r\n            this.emit('mutate:' + key, mutateData);\r\n\r\n            // Also throw a specific event for this type of set\r\n            var specificEvent = itemExists ? 'update' : 'create';\r\n\r\n            this.emit(specificEvent, key);\r\n\r\n            // And a namespaced event as well, NOTE that we pass value instead of key\r\n            this.emit(specificEvent + ':' + key, value);\r\n        },\r\n\r\n        trim : function(str) {\r\n            return str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n        },\r\n\r\n        typeOf : function(val) {\r\n            if (val === null || typeof val === \"undefined\") {\r\n                // This is a special exception for IE, in other browsers the\r\n                // method below works all the time\r\n                return String(val);\r\n            } else {\r\n                return Object.prototype.toString.call(val).replace(/\\[object |\\]/g, '').toLowerCase();\r\n            }\r\n        },\r\n\r\n        updateAttribute : function(key, fn, silent) {\r\n            var item = this.get(key);\r\n\r\n            // In previous versions of Stapes we didn't have the check for object,\r\n            // but still this worked. In 0.7.0 it suddenly doesn't work anymore and\r\n            // we need the check. Why? I have no clue.\r\n            var type = _.typeOf(item);\r\n\r\n            if (type === 'object' || type === 'array') {\r\n                item = _.clone(item);\r\n            }\r\n\r\n            var newValue = fn.call(this, item, key);\r\n            _.setAttribute.call(this, key, newValue, silent || false);\r\n        }\r\n    };\r\n\r\n    // Can be mixed in later using Stapes.mixinEvents(object);\r\n    var Events = {\r\n        emit : function(types, data) {\r\n            data = (typeof data === \"undefined\") ? null : data;\r\n\r\n            var splittedTypes = types.split(\" \");\r\n\r\n            for (var i = 0, l = splittedTypes.length; i < l; i++) {\r\n                var type = splittedTypes[i];\r\n\r\n                // First 'all' type events: is there an 'all' handler in the\r\n                // global stack?\r\n                if (_.eventHandlers[-1].all) {\r\n                    _.emitEvents.call(this, \"all\", data, type, -1);\r\n                }\r\n\r\n                // Catch all events for this type?\r\n                if (_.eventHandlers[-1][type]) {\r\n                    _.emitEvents.call(this, type, data, type, -1);\r\n                }\r\n\r\n                if (typeof this._guid === 'number') {\r\n                    // 'all' event for this specific module?\r\n                    if (_.eventHandlers[this._guid].all) {\r\n                        _.emitEvents.call(this, \"all\", data, type);\r\n                    }\r\n\r\n                    // Finally, normal events :)\r\n                    if (_.eventHandlers[this._guid][type]) {\r\n                        _.emitEvents.call(this, type, data);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        off : function() {\r\n            _.removeEventHandler.apply(this, arguments);\r\n        },\r\n\r\n        on : function() {\r\n            _.addEventHandler.apply(this, arguments);\r\n        }\r\n    };\r\n\r\n    _.Module = function() {\r\n\r\n    };\r\n\r\n    _.Module.prototype = {\r\n        each : function(fn, ctx) {\r\n            var attr = _.attr(this._guid);\r\n            for (var key in attr) {\r\n                var value = attr[key];\r\n                fn.call(ctx || this, value, key);\r\n            }\r\n        },\r\n\r\n        extend : function() {\r\n            return _.extendThis.apply(this, arguments);\r\n        },\r\n\r\n        filter : function(fn) {\r\n            var filtered = [];\r\n            var attributes = _.attr(this._guid);\r\n\r\n            for (var key in attributes) {\r\n                if ( fn.call(this, attributes[key], key)) {\r\n                    filtered.push( attributes[key] );\r\n                }\r\n            }\r\n\r\n            return filtered;\r\n        },\r\n\r\n        get : function(input) {\r\n            if (typeof input === \"string\") {\r\n                // If there is more than one argument, give back an object,\r\n                // like Underscore's pick()\r\n                if (arguments.length > 1) {\r\n                    var results = {};\r\n\r\n                    for (var i = 0, l = arguments.length; i < l; i++) {\r\n                        var key = arguments[i];\r\n                        results[key] = this.get(key);\r\n                    }\r\n\r\n                    return results;\r\n                } else {\r\n                    return this.has(input) ? _.attr(this._guid)[input] : null;\r\n                }\r\n            } else if (typeof input === \"function\") {\r\n                var items = this.filter(input);\r\n                return (items.length) ? items[0] : null;\r\n            }\r\n        },\r\n\r\n        getAll : function() {\r\n            return _.clone( _.attr(this._guid) );\r\n        },\r\n\r\n        getAllAsArray : function() {\r\n            var arr = [];\r\n            var attributes = _.attr(this._guid);\r\n\r\n            for (var key in attributes) {\r\n                var value = attributes[key];\r\n\r\n                if (_.typeOf(value) === \"object\" && !value.id) {\r\n                    value.id = key;\r\n                }\r\n\r\n                arr.push(value);\r\n            }\r\n\r\n            return arr;\r\n        },\r\n\r\n        has : function(key) {\r\n            return (typeof _.attr(this._guid)[key] !== \"undefined\");\r\n        },\r\n\r\n        map : function(fn, ctx) {\r\n            var mapped = [];\r\n            this.each(function(value, key) {\r\n                mapped.push( fn.call(ctx || this, value, key) );\r\n            }, ctx || this);\r\n            return mapped;\r\n        },\r\n\r\n        // Akin to set(), but makes a unique id\r\n        push : function(input, silent) {\r\n            if (_.typeOf(input) === \"array\") {\r\n                for (var i = 0, l = input.length; i < l; i++) {\r\n                    _.setAttribute.call(this, _.makeUuid(), input[i], silent || false);\r\n                }\r\n            } else {\r\n                _.setAttribute.call(this, _.makeUuid(), input, silent || false);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        remove : function(input, silent) {\r\n            if (typeof input === 'undefined') {\r\n                // With no arguments, remove deletes all attributes\r\n                _.attributes[this._guid] = {};\r\n                this.emit('change remove');\r\n            } else if (typeof input === \"function\") {\r\n                this.each(function(item, key) {\r\n                    if (input(item)) {\r\n                        _.removeAttribute.call(this, key, silent);\r\n                    }\r\n                });\r\n            } else {\r\n                // nb: checking for exists happens in removeAttribute\r\n                _.removeAttribute.call(this, input, silent || false);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        set : function(objOrKey, valueOrSilent, silent) {\r\n            if (typeof objOrKey === \"object\") {\r\n                for (var key in objOrKey) {\r\n                    _.setAttribute.call(this, key, objOrKey[key], valueOrSilent || false);\r\n                }\r\n            } else {\r\n                _.setAttribute.call(this, objOrKey, valueOrSilent, silent || false);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        size : function() {\r\n            var size = 0;\r\n            var attr = _.attr(this._guid);\r\n\r\n            for (var key in attr) {\r\n                size++;\r\n            }\r\n\r\n            return size;\r\n        },\r\n\r\n        update : function(keyOrFn, fn, silent) {\r\n            if (typeof keyOrFn === \"string\") {\r\n                _.updateAttribute.call(this, keyOrFn, fn, silent || false);\r\n            } else if (typeof keyOrFn === \"function\") {\r\n                this.each(function(value, key) {\r\n                    _.updateAttribute.call(this, key, keyOrFn);\r\n                });\r\n            }\r\n\r\n            return this;\r\n        }\r\n    };\r\n\r\n    var Stapes = {\r\n        \"_\" : _, // private helper functions and properties\r\n\r\n        \"extend\" : function() {\r\n            return _.extendThis.apply(_.Module.prototype, arguments);\r\n        },\r\n\r\n        \"mixinEvents\" : function(obj) {\r\n            obj = obj || {};\r\n\r\n            _.addGuid(obj);\r\n\r\n            return _.extend(obj, Events);\r\n        },\r\n\r\n        \"on\" : function() {\r\n            _.addEventHandler.apply(this, arguments);\r\n        },\r\n\r\n        \"subclass\" : function(obj, classOnly) {\r\n            classOnly = classOnly || false;\r\n            obj = obj || {};\r\n            obj.superclass = classOnly ? function(){} : _.Module;\r\n            return _.createSubclass(obj, !classOnly);\r\n        },\r\n\r\n        \"version\" : VERSION\r\n    };\r\n\r\n    // This library can be used as an AMD module, a Node.js module, or an\r\n    // old fashioned global\r\n    if (typeof exports !== \"undefined\") {\r\n        // Server\r\n        if (typeof module !== \"undefined\" && module.exports) {\r\n            exports = module.exports = Stapes;\r\n        }\r\n        exports.Stapes = Stapes;\r\n    } else if (typeof define === \"function\" && define.amd) {\r\n        // AMD\r\n        define(function() {\r\n            return Stapes;\r\n        });\r\n    } else {\r\n        // Global scope\r\n        window.Stapes = Stapes;\r\n    }\r\n})();\r\n;/* \r\n * Shortcut list: \r\n$X = IX.get;\r\n$XA = IX.cvtToArray;\r\n$XD = IX.Dom;\r\n$XE = IX.err;\r\n$XF = IX.getPropertyAsFunction;\r\n$XH = IX.HtmlDocument;\r\n$XP = IX.getProperty;\r\n *\r\n*/\r\n\r\n/**\r\n *  IX is a basic library which provider following functions: {\r\n *  \tisEmpty(param) : return if param is undefined, null or empty string.\r\n *  \tisObject(parma) : return if param is an instance of object.\r\n *  \tisString(param) : return if param is an instance of string. Empty string will not be taken as String.\r\n *  \tisFn(param): return if param is an instance of string.\r\n *  \tisBoolean(param): return if param is an Boolean.\r\n *  \tisArray(param) : return if param is an instance of Array.\r\n *\t\tgetClass(param) : return param's type with toLowerCase\r\n *  \r\n *  \thasProperty(object, propertyName)\r\n *  \tsetProperty(object, propertyName, defaultValue)\r\n *  \tgetProperty(object, propertyName, defaultValue): \r\n *  \t\t\tif object has a property named as propertyName, return its value no matter if it is null or empty;\r\n *  \t\t\totherwise return the defaultValue; \r\n *  \tgetPropertyAsFunction\r\n *\t\tclone(object): create a duplicate object and return it. \r\n *\t\t\t\tThe new object is totally different with object although the value is same.\r\n *\r\n *\t\tns(namespaceName): check if namespaceName is existed in current page window. \r\n *\t\t\t\tIf not, create it to keep. \r\n *\t\tnsExisted(namespaceName) : return if namespaceName is existed in current page wilndow.\r\n *\t\tgetNS(namespaceName): check if namespaceName is existed in current page window,\r\n *\t\t\t\tIf yes, return the object identified by namespaceName. Otherwise, return false.\r\n *\r\n *\t\titerate(arrayObject, fn): iterate to call fn for every elements in arrayObject by sequence.\r\n *\t\t\t\tfn is a function to accept such object and index of object in arrayObject. \r\n *\t\t\t\tit can be defined as function(item, indexOfItemInArray)\r\n *\t\tfnIterate(arrayObject, fnName): similar with iterate function, but no need to provide function.\r\n\r\n *\t\t\t\tfnName should be a string to identified a function for each element in array.\r\n *\t\tloop(arrayObject, accumulator, iterateFunction): iterate to do accumulation for every elements in arrayObject by sequence.\r\n *\t\t\t\titerateFunction can be defined as function(oldAccumulator, item, indexOfItemInArray), its task is\r\n *\t\t\t\t\tdeal with the item and the oldAccumulator and return the newAccumulator to help loop function to \r\n *\t\t\t\t\tget the result of accumulation.\r\n * \t\tpartLoop(arrayObject, startIndex, endIndex, accumulator, iterateFunction):  basically, it is same as loop function.\r\n * \t\t\t\tBut it will not deal with all elements by the elements from startIndex to endIndex(not include endIndex).\r\n * \t\t\t\t\tIf the startIndex or endIndex is over-ranged, it just uses the proper index. \r\n *      loopDsc(arrayObject, accumulator, iterateFunction): basically, it is same as loop function. \r\n *      \t\tBut it will deal with element from the last one to the first one.\r\n *      each(object, accumulator, iterateFunction) : it will deal with all properties for object and return the accumulated result.\r\n *      \t\t iterateFunction can be defined as function(oldAccumulator, propertyValue, propertyName, indexOfPropertyInObject), \r\n *      \t\t\tits task is\tdeal with the property and the oldAccumulator and return the newAccumulator to help each function to \r\n *\t\t\t\t\tget the result of accumulation.\r\n *\t\t\r\n *\t\textend(dst, src): copy all properties from src to dst no matter if the property has existed in dst. \r\n *\t\t\t\tAfter copying, return new dst. src will not be changed but dst should be changed.\r\n *\t\tinherit(src, ...): create a new object, copy all properties from each src by sequence.\r\n *\t\t\t\tAfter copying, return new object. Each src will not be changed.\r\n *\r\n *\t\tisMSIE: the value to indicate if current browser is MicroSoft IE.\r\n *\t\tisMSIE7: the value to indicate if current browser is MicroSoft IE 7.0.\r\n *\t\tisSafari: the value to indicate if current browser is Safari.\r\n *\t\tgetUrlParam(key, defaultValue) : try to return the value of parameter identified by key in current URL. \r\n *\t\t\t\tIf current URL has not included the key, return the default value.\r\n *\t\tlisten(type, target, eventName,  handerFunction): try to attach/detach an event handler on specified target.\r\n *\t\t\t\ttype: \"attach\" or \"detach\"\r\n *\t\t\t\ttarget: should be a DOM object.\r\n *\t\t\t\teventName:  for example \"click\", \"mousemove\",...\r\n *\t\t\t\thandlerFunction : an event handler.\r\n *\r\n *\t\ttoAnchor(anchorName): let current focus jump to specified anchor named as anchorName.\r\n *\r\n *\t\temptyFn: just a function shell but do nothing.\r\n *\t\texecute(functionName, arguments): find the object which namespace is functionName. \r\n *\t\t\t\tIf it is function, call it using the given arguments which is array.\r\n *\t\ttryFn(functionObject): try to execute the given functionObject. If the given object is not function, do nothing.\r\n *\r\n *\t\tget(domEl): try to get a DOM element by domEl which can be element or id of element.\t\r\n *  }\r\n */\r\nwindow.IX = (function(){\r\n\tvar currentVersion=\"1.0\";\r\n\t\r\n\tvar isEmptyFn = function(str){\r\n\t\treturn (str===undefined||str===null||str===\"\");\t\t\r\n\t};\r\n\tvar BaseTypes = {\r\n\t\t\"object\": Object,\r\n\t\t\"function\": Function,\r\n\t\t\"string\":String,\r\n\t\t\"boolean\":Boolean,\r\n\t\t\"number\": Number\r\n\t};\r\n\tvar isTypeFn = function(type){\r\n\t\tvar fn =function(obj){\r\n\t\t\treturn (!isEmptyFn(obj) && (typeof(obj)==type || obj instanceof BaseTypes[type]));\r\n\t\t};\r\n\t\treturn fn; \r\n\t};\r\n\r\n\tvar typeUtils = {\r\n\t\tisEmpty : isEmptyFn,\r\n\t\tisBoolean : isTypeFn(\"boolean\"),\r\n\t\tisObject : isTypeFn(\"object\"),\r\n\t\tisString : isTypeFn(\"string\"),\r\n\t\tisNumber : isTypeFn(\"number\"),\r\n\t\tisFn : isTypeFn(\"function\"),\r\n\t\tisArray : function(ob) {return (!!ob && ob instanceof Array);},\r\n\t\tisElement: function(el){return el.nodeType===1;},\r\n\t\tgetClass : function (ob) { return Object.prototype.toString.call(ob).match(/^\\[object\\s(.*)\\]$/)[1].toLowerCase();}\r\n\t};\r\n\t\r\n\tvar loopFn = function(varr,sIdx,eIdx, acc0, fun, isAscLoop) {\r\n\t\tif (varr==null ||varr.length==0){\r\n\t\t\treturn acc0;\r\n\t\t}\r\n\t\tvar len=varr.length;\r\n\t\teIdx = (eIdx==-1)?len: eIdx;\r\n\t\tif (sIdx>=eIdx){\r\n\t\t\treturn acc0;\r\n\t\t}\r\n\t\tvar acc = acc0, min = Math.max(0, sIdx), max = Math.min(len, eIdx);\r\n\t\tvar xlen = len -1;\r\n\t\tfor (var i=0; i<=xlen; i+=1) {\r\n\t\t\tvar idx = isAscLoop?i:(xlen-i);\r\n\t\t\t//try{\r\n\t\t\tif (idx>=min && idx <max && (idx in varr)){\r\n\t\t\t\tacc = fun(acc, varr[idx], idx);\r\n\t\t\t}\r\n\t\t\t//}catch(e){\r\n\t\t\t\t//alert(e);\r\n\t\t\t//}\r\n\t\t}\r\n\t\treturn acc;\r\n\t};\r\n\tvar iterateFn = function(arr, fun){\r\n\t\tif (isEmptyFn(arr))\r\n\t\t\treturn;\r\n\t\tvar len = arr.length;\r\n\t\tfor (var i=0; i<len; i+=1)\t\t\t\r\n\t\t\tfun(arr[i], i);\r\n\t};\r\n\tvar loopUtils = {\r\n\t\titerate: iterateFn,\r\n\t\tfnIterate :function(arr, fname){\r\n\t\t\titerateFn(arr, function(item){\r\n\t\t\t\tif ((fname in item) && typeUtils.isFn(item[fname]))\r\n\t\t\t\t\titem[fname]();\r\n\t\t\t});\r\n\t\t},\r\n\t\tloop:function(varr, acc0, fun) {\r\n\t\t\treturn loopFn(varr, 0, -1, acc0, fun, true);\r\n\t\t},\r\n\t\tloopbreak: function(varr, fun) {\r\n\t\t\ttry{\r\n\t\t\t\tloopFn(varr, 0, -1, 0, fun, true);\r\n\t\t\t}catch(_ex){\r\n\t\t\t\t//log(_ex);\r\n\t\t\t}\r\n\t\t},\r\n\t\tpartLoop:function(varr,sIdx,eIdx, acc0, fun) {\r\n\t\t\treturn loopFn(varr,sIdx,eIdx, acc0, fun, true);\r\n\t\t},\r\n\t\tloopDsc:function(varr, acc0, fun) {\r\n\t\t\treturn loopFn(varr,0, -1, acc0, fun, false);\r\n\t\t},\r\n\t\tmap : function(arr, fun){\r\n\t\t\treturn loopFn(arr, 0, -1, [], function(acc, item, idx){\r\n\t\t\t\tacc.push(fun(item,idx));\r\n\t\t\t\treturn acc;\r\n\t\t\t}, true);\r\n\t\t},\r\n\t\teach:function(obj, acc0, fun){\r\n\t\t\tvar acc = acc0, p=\"\", idx = 0;\r\n\t\t\tfor (p in obj){\r\n\t\t\t\tacc = fun(acc, obj[p], p, idx);\r\n\t\t\t\tidx+=1;\r\n\t\t\t}\r\n\t\t\treturn acc;\r\n\t\t}\r\n\t};\r\n\r\n\tvar arrUtils = {\r\n\t\tcvtToArray : function (iterable) {\r\n\t\t\tif (!iterable)\r\n\t\t\t\treturn [];\r\n\t\t\tif (iterable.toArray)\r\n\t\t\t\treturn iterable.toArray();\r\n\t\r\n\t\t\tvar results = [];\r\n\t\t\tvar len = iterable.length;\r\n\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\tresults.push(iterable[i]);\r\n\t\t    return results;\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a deep copy of an object.\r\n\t * Attention: there is no support for recursive references.\r\n\t * @param {Object} object The object to be cloned.\r\n\t * @returns {Object} The object clone.\r\n\t * @example\r\n\t * var obj =  {\r\n\t *         name : 'John',\r\n\t *         cars : {\r\n\t *                 Mercedes : { color : 'blue' },\r\n\t *                 Porsche : { color : 'red' }\r\n\t *         }\r\n\t * };\r\n\t * var clone = IX.clone( obj );\r\n\t * clone.name = 'Paul';\r\n\t * clone.cars.Porsche.color = 'silver';\r\n\t * alert( obj.name );\t// John\r\n\t * alert( clone.name );\t// Paul\r\n\t * alert( obj.cars.Porsche.color );\t// red\r\n\t * alert( clone.cars.Porsche.color );\t// silver\r\n\t */\r\n\tvar cloneFn =function(obj) {\r\n\t\tvar clone;\r\n\r\n\t\t// Array.\r\n\t\tif (typeUtils.isArray(obj)) {\r\n\t\t\tclone = [];\r\n\t\t\tfor (var i = 0; i < obj.length; i++)\r\n\t\t\t\tclone[i] = cloneFn(obj[i]);\r\n\t\t\treturn clone;\r\n\t\t}\r\n\r\n\t\t// \"Static\" types.\r\n\t\tif (obj === null || (typeof(obj) != 'object') || (obj instanceof String) || (obj instanceof Number)\r\n\t\t\t\t|| (obj instanceof Boolean) || (obj instanceof Date) || (obj instanceof RegExp)) {\r\n\t\t\treturn obj;\r\n\t\t}\r\n\r\n\t\t// Objects.\r\n\t\tclone = new obj.constructor();\r\n\t\tfor (var propertyName in obj) {\r\n\t\t\tvar property = obj[propertyName];\r\n\t\t\tclone[propertyName] = cloneFn(property);\r\n\t\t}\r\n\t\treturn clone;\r\n\t};\r\n\r\n\t/*\r\n\t\tdeepCompare\r\n\t*/\r\n    var deepCompare = function (y, x) {\r\n        if (x == null || y == null || x == undefined || y == undefined) return x == y;\r\n        for (p in y) {\r\n            if (!(p in x) || typeof (x[p]) == 'undefined')\r\n                return false;\r\n            if (y[p]) {\r\n                if (typeof (x[p]) != typeof (y[p])) return false;\r\n                switch (typeof (y[p])) {\r\n                    case 'object':\r\n                        if (!deepCompare(y[p], x[p]))\r\n                            return false;\r\n                        break;\r\n                    case 'function':\r\n                        if (typeof (x[p]) == 'undefined' || y[p].toString() != x[p].toString())\r\n                            return false;\r\n                        break;\r\n                    default:\r\n                        if (y[p] != x[p])\r\n                            return false;\r\n                }\r\n            }\r\n            else if (x[p])\r\n                return false;\r\n        }\r\n        for (p in x) {\r\n            if (!(p in y) || typeof (y[p]) == 'undefined')\r\n                return false;\r\n        }\r\n        return true;\r\n    };\r\n\tvar propertyUtils = {\r\n\t\thasProperty : function(obj, pName){\r\n\t\t\tif (!obj)\r\n\t\t\t\treturn false;\r\n\t\t\ttry{\r\n\t\t\t\tif(pName in obj) return true;\r\n\t\t\t}catch(ex){}\r\n\t\t\tvar names = pName.split(\".\");\r\n\t\t\tvar pObj = obj;\r\n\t\t\tvar len = names.length;\r\n\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif (pObj && (names[i] in pObj)) \r\n\t\t\t\t\t\tpObj = pObj[names[i]];\r\n\t\t\t\t\t else \r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t}catch(_ex){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetProperty : function(obj, pName, defV) {\r\n\t\t\tvar v = (defV!=undefined) ? defV : null;\r\n\t\t\tif (obj==null)\r\n\t\t\t\treturn v;\r\n\t\t\ttry{\r\n\t\t\t\tif(pName in obj) return obj[pName];\r\n\t\t\t}catch(ex){}\r\n\t\t\tvar names = pName.split(\".\");\r\n\t\t\tvar pObj = obj;\r\n\t\t\tvar len = names.length;\r\n\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif (pObj && (names[i] in pObj)) {\r\n\t\t\t\t\t\tpObj = pObj[names[i]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn v;\r\n\t\t\t\t\t}\r\n\t\t\t\t}catch(_ex){\r\n\t\t\t\t\treturn v;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn pObj;\r\n\t\t},\r\n\t\tsetProperty : function(obj, pName, v){\r\n\t\t\ttry{\r\n\t\t\t\tif(pName in obj) {\r\n\t\t\t\t\tobj[pName] = v;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}catch(ex){}\r\n\t\t\tvar names = pName.split(\".\");\r\n\t\t\tvar pObj = obj, _name = names.pop();\r\n\t\t\tvar len = names.length;\r\n\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\tvar _sname = names[i];\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif (!(_sname in pObj) || !pObj[_sname] || typeof pObj[_sname] !=\"object\" )\r\n\t\t\t\t\t\tpObj[_sname] = {};\r\n\t\t\t\t} catch(e){\r\n\t\t\t\t\tpObj[_sname] = {};\r\n\t\t\t\t}\r\n\t\t\t\tpObj = pObj[_sname];\r\n\t\t\t}\r\n\t\t\tpObj[_name] = v;\r\n\t\t},\r\n\t\tgetPropertyAsFunction:function(obj, fName){\r\n\t\t\tvar fn = IX.getProperty(obj, fName);\r\n\t\t\treturn IX.isFn(fn)?fn : IX.emptyFn;\r\n\t\t},\r\n\t\tclone :cloneFn,\r\n\t\tdeepCompare: deepCompare\r\n\t};\r\n\r\n\tvar nsLoopFn = function(nsname, fn){\r\n\t\tvar names = nsname.split(\".\");\r\n\t\tif (names[0]==\"window\")\r\n\t\t\tnames.shift();\r\n\t\tvar nsObj = window, flag = true, i=0, len = names.length; \r\n\t\twhile(i<len && flag){\r\n\t\t\tvar curname = names[i];\r\n\t\t\tflag = fn(curname, nsObj);\r\n\t\t\tif(flag)\r\n\t\t\t\tnsObj = nsObj[curname];\r\n\t\t\ti++;\r\n\t\t}\r\n\t\treturn flag;\r\n\t};\r\n\tvar namespaceUtils = {\r\n\t\tns : function(nsname){\r\n\t\t\tnsLoopFn(nsname, function(name, obj){\r\n\t\t\t\tif (!(name in obj))\r\n\t\t\t\t\tobj[name] = {};\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t},\r\n\t\tnsExisted : function(nsname){\r\n\t\t\treturn nsLoopFn(nsname, function(name, obj){\r\n\t\t\t\treturn obj && (name in obj);\r\n\t\t\t});\r\n\t\t},\r\n\t\tsetNS : function(nsname, obj){\r\n\t\t\tvar names = nsname.split(\".\");\r\n\t\t\tif (names[0]==\"window\")\r\n\t\t\t\tnames.shift();\r\n\t\t\tif (names.length==0 || IX.isEmpty(names[0]))\r\n\t\t\t\treturn;\r\n\t\t\tvar nsObj = window, len = names.length;\r\n\t\t\tfor (var i=0; i<len-1; i++){\r\n\t\t\t\tvar curname = names[i];\r\n\t\t\t\tif (!(curname in nsObj))\r\n\t\t\t\t\tnsObj[curname] = {};\r\n\t\t\t\tnsObj = nsObj[curname];\r\n\t\t\t}\r\n\t\t\tnsObj[names[len-1]] = obj;\r\n\t\t},\r\n\t\tgetNS :function(objName) {\r\n\t\t\treturn nsLoopFn(objName, function(name, obj){\r\n\t\t\t\treturn (name in obj)?obj[name]:false;\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tvar extendFn = function(dst, src) {\r\n\t\tif (dst==null || dst==undefined)\r\n\t\t\tdst = {};\r\n\t\tfor (var _p in src)\r\n\t\t\tdst[_p] = src[_p];\r\n\t\treturn dst;\r\n\t};\r\n\tvar extendUtils = {\r\n\t\t// obj = IX.extend(dst, src);\r\n\t\t// obj will has all members in both dst and src, \r\n\t\t// in same time, dst will has all members in src. \r\n\t\textend: extendFn,\r\n\t\t// obj = IX.inherit(src1, src2, src3,...);\r\n\t\t// obj will has all members in all src*, \r\n\t\t// and all src* will not be changed. \r\n\t\tinherit : function(){\r\n\t\t\treturn loopUtils.loop(arrUtils.cvtToArray(arguments), {}, function(acc, item){\r\n\t\t\t\treturn extendFn(acc, item);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tvar getTimeInMS = function() {return (new Date()).getTime();};\r\n\tvar ua = navigator.userAgent.toLowerCase();\r\n\tvar checkUA = function(keywords){\r\n\t\treturn ua.indexOf(keywords)!=-1;\r\n\t};\r\n\tvar hasEventListener = (\"addEventListener\" in window) ;\r\n\tvar _handlerWrapper = function(handler) {\r\n\t\tvar fn = function(evt){\r\n\t\t\tvar e = evt || window.event;\r\n\t\t\tif (!(\"target\" in e))\r\n\t\t\t\te.target = e.srcElement; // for IE hack\r\n\t\t\treturn handler(e);\r\n\t\t};\r\n\t\treturn fn;\r\n\t};\r\n\tvar _bindHandlers = function(el, handlers, isBind, isOnce){\r\n\t\tif(!el) return;\r\n\t\t\t\t\r\n\t\tisBind&&(el._EVENTNAMES||(el._EVENTNAMES={}));\r\n\t\tIX.iterate([\"click\", \"dblclick\", \"focus\", \"blur\", \"keyup\", \"keydown\", \"mouseover\", \"mouseout\", \"resize\", \"scroll\" ,\"mousedown\", \"mousemove\", \"mouseup\",\"touchstart\", \"touchend\", \"touchmove\"], function(eventName){\r\n\t\t\tif (eventName in handlers){\t\t\t\t\t\t\t\t\r\n\t\t\t\tif(isBind){\r\n\t\t\t\t\tif(isOnce&&el._EVENTNAMES[eventName])\r\n\t\t\t\t\t\treturn;\t\t\t\r\n\t\t\t\t\tel._EVENTNAMES[eventName] = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tIX[isBind?\"attachEvent\":\"detachEvent\"](el, eventName, _handlerWrapper(handlers[eventName]));\r\n\t\t\t}\t\t\t\r\n\t\t});\r\n\t};\r\n\tvar browserUtils = {\r\n\t\tisMSIE7:(document.all && checkUA(\"msie 7.0\")),\r\n\t\tisSafari:(window.openDatabase && checkUA(\"safari\")),\r\n\t\t\r\n\t\tisMSIE: checkUA(\"msie\") && !checkUA(\"opera\"),    //IE\r\n\r\n\t\tisOpera : checkUA(\"opera\"),   //Opera\r\n\t\tisChrome: checkUA(\"chrome\"),   //Chrome\r\n\t\tisFirefox: checkUA(\"firefox\") && !checkUA(\"webkit\"),   //Firefox\r\n\t\t// isYunfisClient: checkUA(\"Yunfis\") || !checkUA(\"yunfis\"),   //yunfis\r\n\t\t\r\n\t\tisMSWin : checkUA(\"windows\"),\r\n\t\t\r\n\t\tgetTimeInMS : getTimeInMS,\r\n\t\t\r\n\t\tgetComputedStyle : (document.defaultView && \"getComputedStyle\" in document.defaultView) ? function(el){\r\n\t\t\treturn document.defaultView.getComputedStyle(el);  \r\n\t\t}:function(el){\t\t\r\n\t\t\treturn el.currentStyle || el.style; \r\n\t\t},\r\n\t\t\r\n\t\tgetUrlParam :function (key, defV){\r\n\t\t\tvar paramList = window.location.search.substring(1).split(\"&\");\r\n\t\t\tvar len = paramList.length;\r\n\t\t\tfor(var i=0; i<len; i+=1){\r\n\t\t\t\tvar _p = paramList[i]; \r\n\t\t\t\tif(_p.indexOf(key+\"=\")==0)\r\n\t\t\t\t\treturn _p.substring(key.length+1);\r\n\t\t\t}\r\n\t\t\treturn defV;\r\n\t\t},\r\n\t\t/** low performance. should not use it */\r\n\t\tlisten : function(type, target, eName, fn){\r\n\t\t\tvar _p = hasEventListener ?  {\r\n\t\t\t\tfname : type==\"detach\"?\"removeEventListener\":\"addEventListener\",\r\n\t\t\t\tetype  :eName\r\n\t\t\t} :{\r\n\t\t\t\tfname : type+ \"Event\",\r\n\t\t\t\tetype : \"on\" + eName\r\n\t\t\t};\r\n\t\t\ttarget[_p.fname](_p.etype, fn, false);\r\n\t\t},\r\n\t\tattachEvent : hasEventListener?function(target, eName, fn){\r\n\t\t\t\ttarget.addEventListener(eName, fn, false);\r\n\t\t\t}:function(target, eName, fn){\r\n\t\t\t\ttarget.attachEvent(\"on\" + eName, fn);\r\n\t\t\t},\r\n\t\tdetachEvent : hasEventListener?function(target, eName, fn){\r\n\t\t\t\ttarget.removeEventListener(eName, fn, false);\r\n\t\t\t}:function(target, eName, fn){\r\n\t\t\t\ttarget.detachEvent(\"on\" + eName, fn);\r\n\t\t\t},\r\n\t\tbind : function(el, handlers) {_bindHandlers(el, handlers, true);},\t\t\r\n\t\t//unbind : function(el, handlers) {_bindHandlers(el, handlers, false);}, //TODO: invalid\t\r\n\t\t//Attach a handler to an event for the element. The handler is executed at most once per element.\r\n\t\tbindOnce: function(el, handlers){\t\t\t\r\n\t\t\t_bindHandlers(el, handlers, true,true);\r\n\t\t},\r\n\t\ton : function(target, eName, fn) {\r\n\t\t\ttarget[\"on\" + eName] = fn;\r\n\t\t}\r\n\t};\r\n\t\r\n\tvar locationUtils = {\t\t\t\t\r\n\t\ttoAnchor : function(name){\r\n\t\t\twindow.location.hash = \"#\" + name;\r\n\t\t}\t\t\r\n\t};\r\n\t\r\n\tvar emptyFn=function(){/**Empty Fn*/};\r\n\tvar selfFn = function(o){return o;};\r\n\t/**\r\n\t *  _config :{\r\n\t *     maxAge : timeInMSec, default no limit;\r\n\t *     expire:\r\n\t *  } \r\n\t */\r\n\tvar checkReadyFn = function(condFn, execFn, period, _config){\t\t\r\n\t\tvar _period = Math.max(20, period || 100);\r\n\t\tvar maxAge = $XP(_config, \"maxAge\", null), expireFn = $XF(_config, \"expire\"), startTick = null;\r\n\t\tif (isNaN(maxAge))\r\n\t\t\tmaxAge = null;\t\t\r\n\t\tfunction _checkFn(){\t\t\t\r\n\t\t\tif (condFn())\r\n\t\t\t\texecFn();\r\n\t\t\telse if (maxAge!=null && (getTimeInMS()-startTick)>maxAge)\r\n\t\t\t\texpireFn();\r\n\t\t\telse\r\n\t\t\t\tsetTimeout(_checkFn, _period);\r\n\t\t}\r\n\t\tif (maxAge!=null)\r\n\t\t\tstartTick = getTimeInMS();\r\n\t\t_checkFn();\r\n\t};\r\n\tvar executeUtils = {\r\n\t\temptyFn : emptyFn,\r\n\t\tselfFn: selfFn,\r\n\t\tsafeExec : function(fn){\r\n\t\t\t//try {\r\n\t\t\t\tfn();\r\n\t\t\t//}catch(e){\r\n\t\t\t//\talert(IX.Test.listProp(e));\r\n\t\t\t//}\r\n\t\t},\r\n\t\texecute : function(fname, args) {\r\n\t\t\tvar fn = namespaceUtils.getNS(fname);\r\n\t\t\tif (typeUtils.isFn(fn)){\r\n\t\t\t\tfn.apply(null, args);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckReady : checkReadyFn, \r\n\t\ttryFn : function(fn){\r\n\t\t\treturn (typeUtils.isFn(fn))? fn() : emptyFn();\r\n\t\t}\r\n\t};\r\n\t\r\n\tvar domUtils = {\r\n\t\tdecodeTXT : function(txt){\r\n\t\t\treturn (txt+\"\").replaceAll(\"&nbsp;\", ' ').replaceAll(\"&lt;\", \"<\").replaceAll(\"&gt;\", \">\").replaceAll(\"&amp;\", \"&\");\r\n\t\t},\r\n\t\tencodeTXT : function(txt){\r\n\t\t\treturn (txt+\"\").replaceAll('&', '&amp;').replaceAll(\"<\",\"&lt;\").replaceAll(\">\", \"&gt;\").replaceAll(\" \", \"&nbsp;\");\r\n\t\t},\r\n\t\tcreateDiv : function(id,clz){\r\n//\t\t\tlog (\"createDiv :\" + id + \" \" + clz);\r\n\t\t\tvar node = document.createElement('div');\r\n\t\t\tif (!IX.isEmpty(clz))\r\n\t\t\t\tnode.className = clz;\r\n\t\t\tnode.id = id;\r\n\t\t\tdocument.body.appendChild(node);\r\n\t\t\treturn node;\r\n\t\t},\r\n\t\tget : function(domEl){\r\n\t\t\tif (IX.isEmpty(domEl))\r\n\t\t\t\treturn null;\r\n\t\t\tif (typeUtils.isString(domEl) || typeUtils.isNumber(domEl) )\r\n\t\t\t\treturn document.getElementById(domEl);\r\n\t\t\tif (\"ownerDocument\" in domEl)\r\n\t\t\t\treturn domEl;\r\n\t\t\treturn null;\t\r\n\t\t}\r\n\t};\r\n\tvar errUtils = {\r\n\t\terr : function(errMsg) {\r\n\t\t\talert(errMsg);\r\n\t\t}\r\n\t};\r\n\tvar mathUtils = {\r\n\t\tinRange : function(x, x1, x2){return (x-x1)*(x-x2)<=0;}\t\r\n\t};\r\n\t\r\n\tvar _idx = 0;\r\n\tvar idUtils = {\r\n\t\tid : function(){\r\n\t\t\t_idx ++;\r\n\t\t\treturn \"ix\"+_idx;\r\n\t\t}\t\r\n\t};\r\n\r\n\tvar ifRectIntersect = function (_rect1, _rect2) {\r\n        return Math.abs(_rect1.maxx + _rect1.minx - _rect2.minx - _rect2.maxx) <= _rect2.maxx - _rect2.minx + _rect1.maxx - _rect1.minx\r\n            && Math.abs(_rect1.maxy + _rect1.miny - _rect2.miny - _rect2.maxy) <= _rect2.maxy - _rect2.miny + _rect1.maxy - _rect1.miny;\r\n    };\r\n\t\r\n\treturn extendUtils.inherit(typeUtils, arrUtils, propertyUtils, namespaceUtils, loopUtils, \r\n\t\t\textendUtils, browserUtils, locationUtils, executeUtils,domUtils,errUtils, mathUtils, idUtils, {\r\n\t\tversion: currentVersion,\r\n\t\tifRectIntersect: ifRectIntersect\r\n\t});\r\n})();\r\n$X = IX.get;\r\n/**\r\n * $XA is an shortcut to IX.cvtToArray.\t\r\n * @param {} iterable : an object which can be iterated.\r\n * @return : Array object\r\n */\r\n$XA = IX.cvtToArray;\r\n$XE = IX.err;\r\n/**\r\n * $XP is an shortcut for IX.getProperty. For example:\r\n * \t\tvar myId = $XP(config, \"id\", 123)\r\n * \t\tit means assign config.id to myId, if config has no property named as \"id\", assign 123 to myId. \r\n *  \r\n */\r\n$XP = IX.getProperty;\r\n/**\r\n * $XF is an shortcut for IX.getPropertyAsFunction. For example:\r\n * \t\tvar closeFn = $XF(config, \"close\")\r\n * \t\tit means assign config.close to closeFn, if config has no property named as \"close\", assign IX.emptyFn to closeFn. \r\n *  \r\n */\r\n$XF = IX.getPropertyAsFunction;\r\n\r\nIX.Test =(function(){\r\n\tvar detectAttrsFn = function(obj, checkFn, injectorFn) { // injectorFn: function(result, name, value)\r\n\t\tvar count = 0;\r\n\t\treturn  IX.each(obj, \"\", function(acc, item, nc){\r\n\t\t\ttry{\r\n\t\t\t\tif (checkFn(item,nc)){\r\n\t\t\t\t\tcount += 1;\r\n\t\t\t\t\treturn injectorFn(acc,  nc, item) + (count%5==4?\"\\r\\n\":\"\");\r\n\t\t\t\t}\r\n\t\t\t}catch(e){alert(e);}\r\n\t\t\treturn acc;\r\n\t\t});\r\n\t};\r\n\tvar listFn = function(obj, matchorFn, type){\r\n\t\tif (type!=\"fun\" && IX.isString(obj)){\r\n\t\t\treturn \"String:\" + obj.toString();\r\n\t\t}\r\n\t\tvar isListFn = type==\"fun\"; \r\n\t\treturn (isListFn?\"Funcs:\":\"Props:\") + detectAttrsFn(obj, function(o){\r\n\t\t\t\treturn (((!isListFn && !IX.isFn(o)) || (isListFn && IX.isFn(o))));\r\n\t\t\t}, function(r, n, v) {\r\n\t\t\t\treturn [r, n, isListFn?\"\": [':\"', (\"\"+v).trunc(60), '\" '].join(\"\"), \", \"].join(\"\");\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\treturn {\r\n\t\tlistProp:function(obj, matchor) {\r\n\t\t\treturn listFn(obj, matchor, \"\");\r\n\t\t},\r\n\t\tlistFun:function(obj, matchor) {\r\n\t\t\treturn listFn(obj, matchor, \"fun\");\r\n\t\t}\r\n\t};\r\n})();\r\n\r\nwindow.log = (\"IXDEBUG\" in window)? function(s){\r\n\tif (console)\r\n\t\tconsole.log(s);\r\n} : IX.emptyFn;\r\n\r\n//////////////////////////////////////////////////// TEST-Utils finished////////\r\n\r\n/**\r\n *  IX.Array is a supplement for Array.prototype. It includes: {\r\n *  \tinit(length, defaultValue): create a new Array that each element is set to defaultValue.\r\n *  \tisFound(element, arrayObject, equalFn): return if element is in current arrayObject by equalFn.\r\n *  \t\t\tFor equalFn, should be defined as function(a,b) and return boolean value; \r\n *  \t\t\tif the caller don't provide the function and a has equal operator, use a.equal to compare.\r\n *  \t\t\totherwise, using default operator \"==\".\r\n *  \ttoSet(arrayObject, equalFn): return unduplicated array of arrayObject by equalFn.\r\n *  \tisSame(arrayObject1, arrayObject2, equalFn): return if arrayObject1 is same set as arrayObject2 no matter thr order of array elements.\r\n *  \tcompact(arrayObject, validFn):return an array object which remove all not valid elements from arrayObject by validFn. \t \r\n *  \tremove(arrayObject, element, equalFn): return new array object which removed matched elements from arrayObject.\r\n *  \tpushx(arrayObject, item): return arrayObject which add item as last element.\r\n *  \tindexOf(arrayObject, matchFn): return the index of first matched element. If no matched, return -1;\r\n *  \tsplice(arrayObject, startIndex, deleteCount, insertArrayObject): \r\n *  \t\t\tdelete \"deleteCount\" elements from startIndex in arrayObject and insert insertArrayObject into startIndex of arrayObject\r\n *  \t\t\tafter all, return the new array object.   \r\n *  }\r\n * \r\n */\r\nIX.Array = (function(){\r\n\tvar getEqualFn = function(equalFn){\r\n\t\treturn IX.isFn(equalFn)?equalFn:function(a, b) {\r\n\t\t\treturn (IX.isObject(a) &&(\"equal\" in a) &&  IX.isFn(a.equal))?a.equal(b):(a==b);\r\n\t\t};\r\n\t};\r\n\t\r\n\tvar isFoundFn = function(elem, arr, equalFn){\r\n\t\tif (arr==null ||arr.length==0)\r\n\t\t\treturn false;\r\n\t\tfor (var i=arr.length-1; i>=0; i--) {\r\n\t\t\tif (equalFn(elem, arr[i]))\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t/** merge arr1 and and arr2 into new arr:\r\n\t * \tarr1: [1,3,5,7,9, 19,21,22], arr2: [2,3,4, 18,19,20]\r\n\t * merge[arr1,arr2] = [2,1,  3,  4,18, 5,7,9,  19, 21,22, 20] \r\n\t *  3 and 19 are key points:  \r\n\t */ \r\n\tvar _merge = function(arr1, arr2, equalFn){\r\n\t\tvar _arr1 = arr1 ||[], _arr2 = arr2 ||[];\r\n\t\tvar i=0, j=0, k=0, arr = [];\r\n\t\tvar len1= _arr1.length, len2 = _arr2.length;\r\n\t\tfor(i=0; i<len2; i++){\r\n\t\t\tfor (j=0; j<len1; j++){\r\n\t\t\t\tif (equalFn(_arr2[i], _arr1[j])) {\r\n\t\t\t\t\tfor (k=0; k<i; k++)\r\n\t\t\t\t\t\tarr.push(_arr2.shift());\r\n\t\t\t\t\t_arr2.shift();\r\n\t\t\t\t\tfor (k=0; k<=j; k++)\r\n\t\t\t\t\t\tarr.push(_arr1.shift());\r\n\t\t\t\t\treturn arr.concat(_merge(_arr1, _arr2, equalFn));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr.concat(_arr1, _arr2);\r\n\t};\r\n\t\r\n\tvar _self = null;\r\n\t_self = {\r\n\t\tinit : function(len, defV){\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i=0; i<len; i++)\r\n\t\t\t\tarr[i] = IX.clone(defV);\r\n\t\t\treturn arr;\r\n\t\t},\r\n\t\tisFound : function(elem, arr, equalFn){\r\n\t\t\treturn isFoundFn(elem, arr, getEqualFn(equalFn));\r\n\t\t},\r\n\t\ttoSet : function(arr, equalFn) {\r\n\t\t\tvar fn = getEqualFn(equalFn);\r\n\t\t\treturn IX.loop(arr, [], function(acc, item){\r\n\t\t\t\tif (!_self.isFound(item, acc, fn))\r\n\t\t\t\t\tacc.push(item);\r\n\t\t\t\treturn acc;\r\n\t\t\t});\r\n\t\t},\r\n\t\tsort : function(arr, cmpFn){\r\n\t\t\tvar arr1 = IX.map(arr, function(item){return item;});\r\n\t\t\treturn arr1.sort(cmpFn);\r\n\t\t},\r\n\t\tisSameSet:function(_arr1, _arr2, equalFn){\r\n\t\t\tvar arr1 = _self.toSet(_arr1), arr2 = _self.toSet(_arr2);\r\n\t\t\tif (arr1==null && arr2==null)\r\n\t\t\t\treturn true;\r\n\t\t\tif (arr1==null || arr2==null || arr1.length!=arr2.length)\r\n\t\t\t\treturn false;\r\n\t\t\tif (arr1.length==0 && arr2.length==0)\r\n\t\t\t\treturn true;\r\n\t\t\t\r\n\t\t\tvar fn = getEqualFn(equalFn);\r\n\t\t\tfor (var i=arr1.length-1; i>=0; i--){\r\n\t\t\t\tif (!isFoundFn(arr1[i], arr2, fn))\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tcompact: function(arr, validFn) {\r\n\t\t\tvar fn = IX.isFn(validFn)?validFn:function(item){return item;};\r\n\t\t\treturn IX.loop(arr, [], function(acc, item) {\r\n\t\t\t\tif (fn(item))\r\n\t\t\t\t\tacc.push(item);\r\n\t\t\t\treturn acc;\r\n\t\t\t});\r\n\t\t},\r\n\t\tremove:function(arr, elem, equalFn){\r\n\t\t\tvar fn = getEqualFn(equalFn);\r\n\t\t\treturn IX.loop(arr, [], function(acc, item){\r\n\t\t\t\tif (!fn(elem, item))\r\n\t\t\t\t\tacc.push(item);\r\n\t\t\t\treturn acc;\r\n\t\t\t});\r\n\t\t},\r\n\t\tpushx:function(arr, item){\r\n\t\t\tarr.push(item);\r\n\t\t\treturn arr;\r\n\t\t},\r\n\t\t\r\n\t\tflat : function(arr) {\r\n\t\t\treturn IX.isArray(arr)?IX.loop(arr, [], function(acc, item){\r\n\t\t\t\treturn acc.concat(_self.flat(item));\r\n\t\t\t}) : [arr];\r\n\t\t},\r\n\t\tindexOf :function(arr, matchFn) {\r\n\t\t\tif(!arr || arr.length==0)\r\n\t\t\t\treturn -1;\r\n\t\t\tvar len = arr.length;\r\n\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\tif (matchFn(arr[i]))\r\n\t\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t},\r\n\r\n\t\t// exmaples:\r\n\t\t// arr= [\"a\", \"b\", \"c\", \"d\"]\r\n\t\t// (arr, 4) : return []\r\n\t\t// (arr, 3):  remove 1 elem: arr[3]; return [\"a\", \"b\", \"c\"];\r\n\t\t// (arr, 3, 4) : return []\r\n\t\t// (arr, 1, 2) : remove 2 elems: arr[1], arr[2]; return [\"a\", \"d\"];\r\n\t\t// (arr, 1, 2, [\"g\", \"k\", \"l\"]) : remove 2 elems: arr[1], arr[2] and add 3 elems; \r\n\t\t//              return [\"a\", \"g\", \"k\", \"l\", \"d\"];\r\n\t\t// (arr, 1, 0, [\"g\", \"k\", \"l\"]) : remove 0 elems and add 3 elems; \r\n\t\t//              return [\"a\", \"g\", \"k\", \"l\", \"b\", \"c\", \"d\"];\r\n\t\tsplice:function(arr, start, deleteCount, insertArray) {\r\n\t\t\tvar count = isNaN(deleteCount)?1:deleteCount;\r\n\t\t\tvar len = arr.length;\r\n\t\t\tif (start<0 || start>len || count<0 || (start+count)>len){\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t\tvar iArr = insertArray?insertArray:[];\r\n\t\t\treturn [].concat(arr.slice(0, start), iArr, arr.slice(start+count));\r\n\t\t},\r\n\t\t\r\n\t\t/** merge arr1 and and arr2 into new arr:\r\n\t\t * \tarr1: [1,3,5,7,9, 19,21,22], arr2: [2,3,4, 18,19,20]\r\n\t\t * merge[arr1,arr2] = [2,  1,3,  4,18, 5,7,9,19, 21,22, 20] \r\n\t\t *  3 and 19 are key points:  \r\n\t\t */ \r\n\t\tmerge : function(arr1, arr2, equalFn){\r\n\t\t\treturn _merge(arr1, arr2, getEqualFn(equalFn));\r\n\t\t}\r\n\t};\r\n\treturn _self;\r\n})();\r\n\r\nIX.IState = (function(){\r\n\treturn {\r\n\t\ttoggle :function(origStat, newStat){\r\n\t\t\treturn (newStat==undefined)?!origStat : newStat;\r\n\t\t}\r\n\t};\r\n})();\r\n\r\nIX.IManager = function(){\r\n\tvar _ht = {};\r\n\treturn {\r\n\t\tisRegistered : function(name){\r\n\t\t\treturn (name in _ht) && (_ht[name]);\r\n\t\t},\r\n\t\tregister: function(name, obj) {\r\n\t\t\t_ht[name] = obj;\r\n\t\t},\r\n\t\tunregister : function(name){\r\n\t\t\t_ht[name] = null;\r\n\t\t},\r\n\t\tget: function(name){\r\n\t\t\treturn (name in _ht)?_ht[name]: null;\r\n\t\t},\r\n\t\tclear : function() {\r\n\t\t\t_ht = {};\r\n\t\t},\r\n\t\tdestroy : function() {\r\n\t\t\tdelete _ht;\r\n\t\t}\r\n\t};\r\n};\r\n\r\nIX.IList = function(){\r\n\tvar _keyList = [];\r\n\tvar IXArray =  IX.Array;\r\n\tvar indexOfFn = function(key) {\r\n\t\treturn key ? IXArray.indexOf(_keyList, function(item) {\r\n\t\t\treturn item == key;\r\n\t\t}) : -1;\r\n\t};\r\n\tvar removeFn = function(idx) {\r\n\t\tif (idx >= 0 && idx<_keyList.length)\r\n\t\t\t_keyList = _keyList.slice(0, idx).concat(_keyList.slice(idx+1));\r\n\t};\r\n\tvar appendFn = function(key){\r\n\t\tif (!_keyList || _keyList.length == 0)\r\n\t\t\t_keyList = [key];\r\n\t\telse {\r\n\t\t\tvar idx = indexOfFn(key);\r\n\t\t\tremoveFn(idx);\r\n\t\t\t_keyList.push(key);\r\n\t\t}\r\n\t};\r\n\treturn {\r\n\t\tisEmpty :function(){return _keyList.length==0;},\r\n\t\tisLast : function(k){return _keyList.length>0 && k==_keyList[_keyList.length-1];},\r\n\t\tgetList : function(){return _keyList;},\r\n\t\tgetSize: function(){return _keyList.length;},\r\n\t\tindexOf : indexOfFn,\r\n\t\tremove : removeFn,\r\n\t\ttryRemove : function(key){\r\n\t\t\tremoveFn(indexOfFn(key));\r\n\t\t},\r\n\t\tappend : appendFn,\r\n\t\ttryAdd :function(key){\r\n\t\t\tif (!_keyList || _keyList.length == 0)\r\n\t\t\t\t_keyList = [key];\r\n\t\t\telse if (indexOfFn(key) <0)\r\n\t\t\t\t_keyList.push(key);\r\n\t\t},\r\n\t\tinsertBefore : function(key, dstKey) {\r\n\t\t\t// find the dstKey, if not exist, append current key to the end of list.\r\n\t\t\tvar dstIdx = indexOfFn(dstKey);\r\n\t\t\tif (dstIdx == -1) {\r\n\t\t\t\tappendFn(key);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// find the key, if current key is before dstKey, do nothing.\r\n\t\t\tvar idx = indexOfFn(key);\r\n\t\t\tif (idx != -1 && dstIdx - idx == 1)\r\n\t\t\t\treturn;\r\n\t\t\t// else remove the existed record and insert it before dstKey.\r\n\t\t\tif (idx >= 0) {\r\n\t\t\t\tremoveFn(idx);\r\n\t\t\t\tdstIdx = indexOfFn(dstKey);\r\n\t\t\t}\r\n\t\t\t_keyList = _keyList.slice(0, dstIdx).concat([key], _keyList.slice(idx));\r\n\t\t},\r\n\t\tclear : function(){\r\n\t\t\t_keyList = [];\r\n\t\t},\r\n\t\tdestroy : function(){\r\n\t\t\tdelete _keyList;\r\n\t\t}\r\n\t};\r\n};\r\nIX.I1ToNManager = function(eqFn) {\r\n\tvar _eqFn = IX.isFn(eqFn)?eqFn : function(item, value){return item==value;};\r\n\t\r\n\tvar _mgr = new IX.IManager();\r\n\t\r\n\tvar hasEntryFn = function(key) {\r\n\t\tvar list = _mgr.get(key);\r\n\t\treturn list && list.length>0;\t\t\r\n\t};\r\n\tvar indexOfFn = function(arr, value) {\r\n\t\treturn IX.Array.indexOf(arr, function(item){return _eqFn(item, value);});\r\n\t};\r\n\t\r\n\treturn IX.inherit(_mgr, {\r\n\t\thasValue :hasEntryFn,\r\n\t\tput : function(k, v) {\r\n\t\t\tif (!hasEntryFn(k)) {\r\n\t\t\t\t_mgr.register(k, [v]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar list = _mgr.get(k);\r\n\t\t\tif (indexOfFn(list, v)==-1)\r\n\t\t\t\t_mgr.register(k, list.concat(v));\r\n\t\t},\r\n\t\tremove : function(k, v){\r\n\t\t\tvar list = _mgr.get(k);\r\n\t\t\tvar idx = indexOfFn(list, v);\r\n\t\t\tif (idx >= 0)\r\n\t\t\t\t_mgr.register(k, IX.Array.splice(list, idx));\t\r\n\t\t}\t\r\n\t});\r\n};\r\nIX.IListManager = function() {\r\n\tvar _super = new IX.IManager();\r\n\tvar _list = new IX.IList();\r\n\t\r\n\tvar registerFn = function(key, obj) {\t\t\r\n\t\t_super.register(key, obj);\r\n\t\tvar idx = _list.indexOf(key);\r\n\t\tif (obj) {\r\n\t\t\tif (idx == -1)\r\n\t\t\t\t_list.append(key);\r\n\t\t} else \r\n\t\t\t_list.remove(idx);\r\n\t};\r\n\tvar listFn = function(keys) {\r\n\t\treturn IX.map(keys, function(item) {return _super.get(item);});\r\n\t};\r\n\treturn IX.inherit(_super, {\r\n\t\t// register should not change the sequence of key.\r\n\t\tregister : registerFn,\r\n\t\tunregister : function(key){registerFn(key);},\r\n\t\tisEmpty :function(){return _list.isEmpty();},\r\n\t\tgetSize : function(){return _list.getSize();},\r\n\t\thasKey : _super.isRegistered,\r\n\t\tisLastKey : function(key){return _list.isLast(key);},\r\n\t\tgetKeys : function() {return _list.getList();},\r\n\t\tgetByKeys : function(keys){return listFn(keys);},\r\n\t\tgetAll : function() {return listFn(_list.getList());},\r\n\t\titerate: function(fn){IX.iterate(_list.getList(), function(item){fn(_super.get(item));}); },\r\n\t\tgetFirst : function() {\r\n\t\t\tvar arr = _list.getList();\r\n\t\t\tif (!arr || arr.length == 0)\r\n\t\t\t\treturn null;\r\n\t\t\tvar len = arr.length;\r\n\t\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\t\tvar inst = _super.get(arr[i]);\r\n\t\t\t\tif (inst) \r\n\t\t\t\t\treturn inst;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\t// only for key. append will remove existed record in keyList and append it to the end\r\n\t\tappend : _list.append,\r\n\t\tinsertBefore : _list.insertBefore,\r\n\t\tremove : function(key) {registerFn(key);},\r\n\t\t\r\n\t\tclear : function(){\r\n\t\t\t_super.clear();\r\n\t\t\t_list.clear();\r\n\t\t},\r\n\t\t\t\t\r\n\t\tdestroy : function() {\r\n\t\t\t_super.destroy();\r\n\t\t\tdelete _super;\r\n\t\t\t_list.destroy();\r\n\t\t\tdelete _list;\r\n\t\t}\r\n\t});\r\n};\r\n\r\n/**\r\n * data : {\r\n * \t\ttype : \"array\"/\"json\", [option; default :\"json\"]\r\n * \t\t// for array:\r\n * \t\tfields :[\"name1\", \"name2\", ...],\r\n * \t\titems:[ [value1, value2, ...], ...]\r\n * \t\t// for json:\r\n * \t\titems : [{name1: value1, name2: value2},...]\r\n *  }\r\n *  return: [{name1: value1, name2: value2},...]\r\n */\r\nIX.DataStore = function(data){\r\n\tvar _items = $XP(data, \"items\", []);\r\n\tif (_items.length>0 && $XP(data, \"type\", \"json\")!=\"json\"){\r\n\t\tvar _fields = $XP(data, \"fields\", []);\r\n\t\t_items =  IX.map(_items, function(row){\r\n\t\t\treturn IX.loop(_fields, {}, function(acc, col, idx){\r\n\t\t\t\tacc[col] = IX.isArray(row)?row[idx]:row[col];\r\n\t\t\t\treturn acc;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn IX.map(_items, function(item){\r\n\t\tvar id = $XP(item, \"id\");\r\n\t\tif (IX.isEmpty(id))\r\n\t\t\titem.id = IX.id();\r\n\t\treturn item;\r\n\t});\r\n};\r\n\r\nIX.Date = (function(){\r\n\tvar _isUTC = false;\r\n\tvar fields4Day = [\"FullYear\", \"Month\", \"Date\"], fields4Time = [\"Hours\", \"Minutes\", \"Seconds\"];\r\n\tvar ds = \"-\", ts = \":\";\r\n\t\r\n\tvar _formatStr = function(str, sp) {\r\n\t\tif (IX.isEmpty(str))\r\n\t\t\treturn \"\";\r\n\t\tstr = str.split(sp, 3);\r\n\t\treturn IX.map(sp==ds?[4,2,2]:[2,2,2], function(item, idx){\r\n\t\t\tvar nstr = (str.length>idx?str[idx]:\"\");\r\n\t\t\treturn (\"0\".multi(item) + nstr).substr(nstr.length, item);\r\n\t\t}).join(sp);\r\n\t}; \r\n\t\r\n\tvar _format = function(date, fields, sp){\r\n\t\tvar getPrefix = \"get\" + (_isUTC?\"UTC\":\"\");\r\n\t\tvar str = IX.map(fields, function(item){\r\n\t\t\treturn date[getPrefix + item]()*1 + (item==\"Month\"?1:0);\r\n\t\t}).join(sp);\r\n\t\treturn _formatStr(str, sp);\r\n\t};\r\n\t\r\n\tvar format = function(date, type) {\r\n\t\tif (type==\"Date\")\r\n\t\t\treturn _format(date, fields4Day, ds);\r\n\t\tif (type==\"Time\")\r\n\t\t\treturn _format(date, fields4Time, ts);\r\n\t\treturn _format(date, fields4Day, ds) + \" \" + _format(date,fields4Time, ts);\r\n\t};\r\n\r\n\tvar checkData =function(acc, item, idx){\r\n\t\treturn acc || isNaN(item) || item.indexOf(\".\")>=0 || (idx==0 && item.length!=4) || (idx>0 && item.length>2);\r\n\t};\r\n\tvar checkTime =function(acc, item, idx){\r\n\t\treturn acc || isNaN(item) || item.indexOf(\".\")>=0 || item.length>2;\r\n\t};\r\n\tvar isValid = function(str, type){\r\n\t\tvar isDate = type == \"Date\";\r\n\t\tvar sps  = str.split(isDate?ds :ts, 3);\r\n\t\tif (sps.length!=3 || IX.loop(sps, false, isDate?checkData:checkTime))\r\n\t\t\treturn false;\r\n\t\tif (isDate){\r\n\t\t\tvar m = sps[1]*1;\r\n\t\t\tvar d = sps[2]*1;\r\n\t\t\treturn !(m<=0 || m>12 || d<=0 || d>31);\r\n\t\t}\r\n\t\tvar h = sps[0]*1;\r\n\t\tvar m = sps[1]*1;\r\n\t\tvar s = sps[2]*1;\r\n\t\treturn  !(h<0||h>23 || m<0||m>59 || s<0|| s>59);\r\n\t};\r\n\t\r\n\treturn {\r\n\t\tsetDS : function(v){ds = v;},\r\n\t\tsetTS : function(v){ts = v;},\r\n\t\tsetUTC : function(isUTC){\r\n\t\t\t_isUTC= isUTC;\r\n\t\t}, \r\n\t\tgetDS : function(){return ds;},\r\n\t\tgetTS : function(){return ts;},\r\n\t\tisUTC :function(){\r\n\t\t\treturn _isUTC;\r\n\t\t},\r\n\t\t// return YYYY/MM/DD hh:mm:ss \r\n\t\tformat:format,\r\n\t\t// return YYYY/MM/DD\r\n\t\tformatDate:function(date) {\r\n\t\t\treturn format(date, \"Date\");\r\n\t\t},\r\n\t\t// return hh:mm:ss\r\n\t\tformatTime:function(date) {\r\n\t\t\treturn format(date, \"Time\");\r\n\t\t},\r\n\t\t\r\n\t\t// return YYYY/MM/DD hh:mm:ss \r\n\t\tformatStr:function(str) {\r\n\t\t\tstr = (str + \" \").split(\" \");\r\n\t\t\treturn _formatStr(str[0], ds) + \" \" + _formatStr(str[1], ts);\r\n\t\t},\r\n\t\t// return YYYY/MM/DD\r\n\t\tformatDateStr:function(str){\r\n\t\t\treturn _formatStr(str, ds);\r\n\t\t},\r\n\t\t// return hh:mm:ss\r\n\t\tformatTimeStr:function(str){\r\n\t\t\treturn _formatStr(str, ts);\r\n\t\t},\r\n\t\t\r\n\t\tgetDateText : function(olderTSInSec, tsInSec) {\r\n\t\t\tvar interval = tsInSec -olderTSInSec ;\r\n\t\t\tif (interval<10)\r\n\t\t\t\treturn \"\";\r\n\t\t\tif (interval<60)\r\n\t\t\t\treturn Math.round(interval) + \"\";\r\n\t\t\tinterval /= 60;\t\r\n\t\t\tif (interval<60)\r\n\t\t\t\treturn Math.round(interval) + \"\";\r\n\t\t\tinterval /= 60;\r\n\t\t\tif (interval<24)\r\n\t\t\t\treturn Math.round(interval) + \"\";\r\n\t\t\tinterval /= 24;\t\r\n\t\t\tif (interval<7)\r\n\t\t\t\treturn Math.round(interval) + \"\";\t\t\t\r\n\t\t\tinterval /= 7;\t\r\n\t\t\tif (interval<4.33)\r\n\t\t\t\treturn Math.round(interval) + \"\";\r\n\t\t\tinterval /= 4.33;\r\n\t\t\tif (interval<12)\r\n\t\t\t\treturn Math.round(interval) + \"\";\r\n\t\t\treturn Math.round(interval/12) + \"\";\t\t\r\n\t\t},\r\n\t\t\r\n\t\t// accept YYYY/MM/DD hh:mm:ss return true/false;\r\n\t\tisValid : function(dateStr, type) {\r\n\t\t\tvar dt = dateStr.split(\" \");\r\n\t\t\tif (type==\"Date\" ||type==\"Time\")\r\n\t\t\t\treturn dt.length==1 && isValid(dt[0], type);\r\n\t\t\t\r\n\t\t\treturn dt.length==2 && isValid(dt[0], \"Date\") && isValid(dt[1], \"Time\");\r\n\t\t},\r\n\t\t/*\r\n\t\t\tpara: \r\n\t\t\t\t_date: date string, e.g. 2010-01-01 9:20:30 or 2010/01/01 9:20:30\r\n\t\t\t\t_format: format string, e.g. \"yyyy-MM-dd HH:mm:ss\"\r\n\t\t\treturn \r\n\t\t\t\tstring\r\n\t\t*/\r\n\t\tgetDateByFormat: function (_dateStr, _formatType) {\r\n            try {\r\n            \tif(_dateStr == null || _dateStr === \"\") return \"\";\r\n                var _dateObj = typeof _dateStr == \"number\" ? new Date(_dateStr) : typeof _dateStr == \"string\" ? new Date((_dateStr+\"\").replace(/-/g, \"/\")) : _dateStr, dateFormat = _formatType || \"yyyy-MM-dd HH:mm:ss\";\r\n\r\n                dateFormat = dateFormat.replace(\"yyyy\", _dateObj.getFullYear());\r\n                var _month = _dateObj.getMonth() + 1,\r\n\t\t\t\t\t_day = _dateObj.getDate(),\r\n\t\t\t\t\t_hour = _dateObj.getHours(),\r\n\t\t\t\t\t_minute = _dateObj.getMinutes(),\r\n\t\t\t\t\t_second = _dateObj.getSeconds();\r\n                dateFormat = dateFormat.replace(\"MM\", _month > 9 ? _month : (\"0\" + _month));\r\n                dateFormat = dateFormat.replace(\"dd\", _day > 9 ? _day : (\"0\" + _day));\r\n                dateFormat = dateFormat.replace(\"HH\", _hour > 9 ? _hour : (\"0\" + _hour));\r\n                dateFormat = dateFormat.replace(\"mm\", _minute > 9 ? _minute : (\"0\" + _minute));\r\n                dateFormat = dateFormat.replace(\"ss\", _second > 9 ? _second : (\"0\" + _second));\r\n\r\n                return dateFormat;\r\n            } catch (ex) {\r\n                return _dateStr;\r\n            }\r\n        },\r\n        getTimeTickInSec : function (_dateStr) {\r\n        \tvar _str = IX.Date.getDateByFormat(_dateStr, 'yyyy/MM/dd HH:mm:ss');\r\n        \treturn parseInt((new Date(_str)).getTime() / 1000);\r\n        }\r\n\t};\r\n})();\r\n/**\r\n *\tIX.Net is a library for networking. It includes: {\r\n *\t\tloadFile(url, responseHandler): active AJAX requirement and let responseHandler deal with response(Text).\r\n *\t\tloadCss(cssUrl): load CSS and  apply to current document.\r\n *\t\tloadJsFiles(jsFileUrlArray, postHandler): load all js files in array, and execute postHandler after all jsFiles are loaded.\r\n *\t\ttryFn(fnName, argsArray,  dependency): try to execute function fnName with parameters argsArray.\r\n *\t\t\t\tIf the function is not existed, resolve the dependency and try it again.\r\n *\t\t\t\tdependency:{\r\n *\t\t\t\t\tbeforeFn: function before applying dependency.\r\n *\t\t\t\t\tcssFiles: all required CSS files for current function call.\r\n *\t\t\t\t\tjsFiles: all required JS files for current function call.\r\n *\t\t\t\t\tafterFn: function after executing current function call.\r\n *\t\t\t\t\tdelay: the milliseconds for waiting after js files are loaded.\r\n *\t\t\t\t}\r\n *\t}\r\n */\r\nIX.Net = (function(){\r\n\tvar head= document.getElementsByTagName('head')[0];\r\n\tvar getRequestFn = function(){\r\n\t\tif (\"XMLHttpRequest\" in window) {\r\n\t\t\treturn new XMLHttpRequest();\r\n\t\t}\r\n\t\tif (\"ActiveXObject\" in window){\r\n\t\t\treturn new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\tvar loadFn = function(durl, cbFun){\r\n\t\tvar request = getRequestFn();\r\n\t\tif(!request){\r\n\t\t\t$XE(\"unsupport AJAX. Failed\");return;\r\n\t\t}\r\n\t\trequest.onreadystatechange  = function(){\r\n\t\t\tif (request.readyState == 4){\r\n\t\t\t\tif (request.status == 200){\r\n\t\t\t\t\tif (IX.isFn(cbFun)){cbFun(request.responseText);}\r\n\t\t\t\t} else { \r\n\t\t\t\t\t$XE(\"There was an error: (\" + request.status + \") \" + request.statusText);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\trequest.open(\"GET\", durl, true);\r\n\t\trequest.send(\"\");\r\n\t};\r\n\tvar loadJsFn = function(durl, nextFn){\r\n\t\tvar script= document.createElement('script');\r\n\t\tscript.type= 'text/javascript';\r\n\t\tscript.src= durl;\r\n\t\tif (IX.isFn(nextFn)){\r\n\t\t\tif (script.readyState){ // IE\r\n\t\t\t\tscript.onreadystatechange= function () {\r\n\t\t\t\t\tlog(\"STATE: [\" +durl +\"]:\" +  this.readyState);\r\n\t\t\t\t\tif (script.readyState == 'complete' || script.readyState=='loaded') {\r\n\t\t\t\t\t\tscript.onreadystatechange = null;\r\n\t\t\t\t\t\tnextFn();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tscript.onload= nextFn;\r\n\t\t\t}\r\n\t\t}\r\n\t\thead.appendChild(script);\r\n\t};\r\n\tvar loadJsFilesInSeqFn = function(jsFiles, nextFn){\r\n\t\tvar _nextFn = IX.isFn(nextFn)?nextFn:IX.emptyFn;\r\n\t\tif (!jsFiles || jsFiles.length==0)\r\n\t\t\treturn _nextFn();\r\n\t\tvar n = jsFiles.length;\r\n\t\tvar idx =0;\r\n\t\tvar fn = function(){\r\n\t\t\tloadJsFn(jsFiles[idx], function(){\r\n\t\t\t\tidx +=1;\r\n\t\t\t\treturn (idx<n)?fn():_nextFn();\r\n\t\t\t});\r\n\t\t};\r\n\t\tfn();\r\n\t};\r\n\tvar loadCssFn = function(cssFile){\r\n\t\tvar cssNode = document.createElement('link');\r\n\t\tcssNode.type = 'text/css';\r\n\t\tcssNode.rel = 'stylesheet';\r\n\t\tcssNode.href = cssFile;\r\n\t\tcssNode.media = 'screen';\r\n\t\thead.appendChild(cssNode);\r\n\t};\r\n\treturn {\r\n\t\tloadFile:loadFn,\r\n\t\tloadCss:loadCssFn,\r\n\t\tloadJsFiles:function(jsFiles, nextFun, mode){\r\n\t\t\t//if (!mode || mode==\"seq\" ){\r\n\t\t\t\tloadJsFilesInSeqFn(jsFiles, nextFun);\r\n\t\t\t//}\r\n\t\t},\r\n\t\ttryFn:function(fnName, argList,dependencyConfig){\r\n\t\t\tvar fn = function(){\t\t\t\t\r\n\t\t\t\tIX.execute(fnName, argList);\r\n\t\t\t\tIX.tryFn(dependencyConfig.afterFn);\r\n\t\t\t};\r\n\t\t\tif (!IX.nsExisted(fnName)){\r\n\t\t\t\tif (!dependencyConfig){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar config = dependencyConfig;\r\n\t\t\t\tIX.tryFn(config.beforeFn);\r\n\t\t\t\tIX.iterate(config.cssFiles, loadCssFn);\r\n\t\t\t\tvar delay = config.delay || 100;\r\n\t\t\t\tloadJsFilesInSeqFn(config.jsFiles, function(){\r\n\t\t\t\t\tsetTimeout(fn,delay);\r\n\t\t\t\t});\r\n\t\t\t} else\r\n\t\t\t\tfn();\r\n\t\t}\r\n\t};\r\n})();\r\n\r\nIX.win = (function(){\r\n\tvar fnHT = {}, eventFnHT = {}, handlersHT = IX.I1ToNManager();\r\n\tvar keySn = 0;\r\n\tvar genKey = function(){return \"f_\" + (keySn++);};\r\n\t\r\n\tvar hasEventListener = (\"addEventListener\" in window) ;\r\n\tvar attachEvent = hasEventListener?function(target, eName, fn){\r\n\t\ttarget.addEventListener(eName, fn, false);\r\n\t}:function(target, eName, fn){\r\n\t\ttarget.attachEvent(\"on\" + eName, fn);\r\n\t};\r\n\tvar detachEvent = hasEventListener?function(target, eName, fn){\r\n\t\ttarget.removeEventListener(eName, fn, false);\r\n\t}:function(target, eName, fn){\r\n\t\ttarget.detachEvent(\"on\" + eName, fn);\r\n\t};\r\n\t\r\n\tvar executeEvent = function(eName, e){\r\n\t\tIX.iterate(handlersHT.get(eName), function(fKey){\r\n\t\t\t//try{\r\n\t\t\tif (IX.isFn(fnHT[fKey]))\r\n\t\t\t\tfnHT[fKey](e);\r\n\t\t\t//}catch(ex){\r\n\t\t\t//\tconsole.log(ex);\r\n\t\t\t//}\r\n\t\t});\r\n\t};\r\n\t\r\n\tvar _register = function(eName, fn){\r\n\t\tvar _key = genKey();\r\n\r\n\t \tif(!fn._key){\r\n\t \t\tfn._key = _key;\r\n\t\t\tfnHT[_key] = fn;\r\n\t\t\thandlersHT.put(eName, _key);\t\t\r\n\t\t}\r\n\r\n\t\tif (eName in eventFnHT)\r\n\t\t\treturn _key;\r\n\t\teventFnHT[eName] = function(evt){\r\n\t\t\tvar e = evt || window.event;\r\n\t\t\tif (!(\"target\" in e))\r\n\t\t\t\te.target = e.srcElement; // for IE hack\r\n\t\t\treturn executeEvent(eName, e);\r\n\t\t};\r\n\t\tattachEvent(window, eName, eventFnHT[eName]);\r\n\t\treturn _key;\r\n\t};\r\n\tvar _unregister = function(eName, fnKey){\r\n\t\tfnHT[fnKey] = null;\r\n\t\thandlersHT.remove(eName, fnKey);\r\n\t\tif (handlersHT.hasValue(eName))\r\n\t\t\treturn;\r\n\t\tdetachEvent(window, eName, eventFnHT[eName]);\r\n\t\teventFnHT[eName] = null;\r\n\t};\r\n\t\r\n\tvar _bindHandlers = function(handlers, isBind){\r\n\t\tvar bindFn = isBind?_register: _unregister;\r\n\t\tvar ids = IX.loop([\"click\", \"resize\", \"scroll\" ,\"mousedown\", \"mouseover\", \"mouseout\"], {}, function(acc, eventName){\r\n\t\t\tif (eventName in handlers)\r\n\t\t\t\tacc[eventName] = bindFn(eventName, handlers[eventName]);\r\n\t\t\treturn acc;\r\n\t\t});\r\n\t\tif (isBind)\r\n\t\t\treturn ids;\r\n\t};\r\n\treturn {\r\n\t\t/**\r\n\t\t * handlers :{\r\n\t\t * \t\tclick : fun\r\n\t\t * \t\tresize : fun\r\n\t\t * }\r\n\t\t * return {\r\n\t\t * \t\tclick : handlerId1,\r\n\t\t * \t\tresize : handlerId2\r\n\t\t * }\r\n\t\t */\r\n\t\tbind : function(handlers){return _bindHandlers(handlers, true);},\r\n\t\t/**\r\n\t\t * handlerIds {\r\n\t\t * \t\tclick : handlerId1,\r\n\t\t * \t\tresize : handlerId2\r\n\t\t * }\r\n\t\t */\r\n\t\tunbind : function(handlerIds){_bindHandlers(handlerIds, false);},\r\n\t\tscrollTo : function(x,y){\r\n\t\t\twindow.scrollTo(x, y);\r\n\t\t\texecuteEvent(\"scroll\", null);\r\n\t\t}\r\n\t};\r\n})();\r\n\r\n$Xw = IX.win;\r\n\r\n(function() {\t\r\nfunction defaultParamFn(_name, _params){return _params;}\r\nfunction defaulRspFn(data, cbFn){IX.isFn(cbFn) && cbFn(data);}\r\nfunction getFunProp(_cfg, _name, defFn){\r\n\tvar _fn = $XP(_cfg, _name);\r\n\treturn IX.isFn(_fn)?_fn :defFn;\r\n}\r\n\r\nfunction ajaxRouteFn(callerRouteDef){\r\n\treturn {\r\n\t\tchannel : $XP(callerRouteDef, \"channel\", callerRouteDef.name),\r\n\t\ttype : $XP(callerRouteDef, \"type\", \"POST\"),\r\n\t\tdataType : $XP(callerRouteDef, \"dataType\", \"form\"),\r\n\t\tonsuccess : getFunProp(callerRouteDef, \"onsuccess\", defaulRspFn),\r\n\t\tpreAjax : getFunProp(callerRouteDef, \"preAjax\", defaultParamFn),\r\n\t\tpostAjax : $XF(callerRouteDef, \"postAjax\"),\r\n\t\tonfail : getFunProp(callerRouteDef, \"onfail\", defaulRspFn)\r\n\t};\r\n}\r\nfunction urlRouteFn(routeDef, ifAjax){\r\n\tvar _url = $XP(routeDef, \"url\");\r\n\tif (IX.isEmpty(_url))\r\n\t\treturn null;\r\n\tvar route = ifAjax ? ajaxRouteFn(routeDef) : {};\r\n\troute.url = _url;\r\n\troute.urlType = $XP(routeDef, \"urlType\", \"base\") + \"Url\";\t\r\n\treturn route;\t\r\n}\r\nfunction createRouteHT(routes, ifAjax){\r\n\treturn IX.loop(routes, {}, function(acc, routeDef){\r\n\t\tvar _name = $XP(routeDef, \"name\");\r\n\t\tif (IX.isEmpty(_name))\r\n\t\t\treturn acc;\r\n\t\tvar route = urlRouteFn(routeDef, ifAjax);\r\n\t\tif (route)\r\n\t\t\tacc [_name] = route;\r\n\t\treturn acc;\r\n\t});\r\n}\r\n\r\nfunction UrlRouter(routes, urlFac){\r\n\tvar _routeHT = createRouteHT(routes);\r\n\tvar r = function(_name, params){\r\n\t\treturn urlFac.genUrl(_routeHT[_name], params);\r\n\t};\r\n\treturn r;\r\n}\r\n\r\nfunction tryLockChannel(channel){\r\n\tvar id = \"ajaxChannel_\" + channel;\r\n\tif ($X(id))\r\n\t\treturn false;\r\n\tIX.createDiv(id, \"ajax-channel\");\r\n\t//console.log (\"lock channel: \" + channel);\r\n\treturn true;\r\n}\r\nfunction unlockChannel(channel){\r\n\tvar el = $X(\"ajaxChannel_\" + channel);\r\n\tif (el)\r\n\t\tel.parentNode.removeChild(el);\r\n\t//console.log (\"unlock channel: \" + channel);\r\n}\r\nfunction AjaxCaller(routes, _ajaxFn, urlFac){\r\n\tvar _callerHT = createRouteHT(routes, true);\r\n\tvar c = function(_name, params, cbFn, failFn){\r\n\t\tvar _caller = _callerHT[_name];\r\n\t\tif (!_caller)\r\n\t\t\treturn;\r\n\r\n\t\tvar channel = params && params._channel_ ? params._channel_ : _caller.channel;\r\n\t\tif (!$XP(params, '_t')) {\r\n\t\t\tparams = IX.inherit(params, {_t : ''});\r\n\t\t}\r\n\r\n\t\tif (!tryLockChannel(channel)){\r\n\t\t\t_caller.onfail({\r\n\t\t\t\tcode : 0,\r\n\t\t\t\terr : \"channel in using:\"+ channel\r\n\t\t\t}, failFn, params);\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar _cbFn = IX.isFn(cbFn) ? cbFn : IX.emptyFn;\r\n\t\tvar _contentType =  _caller.dataType == 'json' ? 'application/json; charset=UTF-8' : 'application/x-www-form-urlencoded; charset=UTF-8';\r\n\t\tvar _data = _caller.preAjax(_name, params);\r\n\t\t_data = _caller.dataType == 'json' ? JSON.stringify(_data) : _data;\r\n\t\t_ajaxFn({\r\n\t\t\turl : urlFac.genUrl(_caller, params),\r\n\t\t\ttype :  _caller.type,\r\n\t\t\tcontentType : _contentType,\r\n\t\t\tdata : _data,\r\n\t\t\tsuccess : function(data) {\r\n\t\t\t\tunlockChannel(channel);\r\n\t\t\t\t_caller.onsuccess(data, _cbFn, params);\r\n\t\t\t},\r\n\t\t\tfail: function(data){\r\n\t\t\t\tunlockChannel(channel);\r\n\t\t\t\t_caller.onfail(data, failFn, params);\r\n\t\t\t},\r\n\t\t\terror: function(data){\r\n\t\t\t\tunlockChannel(channel);\r\n\t\t\t\t_caller.onfail(data, failFn, params);\r\n\t\t\t}\r\n\t\t});\r\n\t\t_caller.postAjax(_name, params, _cbFn);\r\n\t};\r\n\treturn c;\r\n}\r\n\r\nfunction UrlFactory(){\r\n\tvar _urls = {};\r\n\tvar genUrl = function(_route, params){\r\n\t\tif (!_route)\r\n\t\t\treturn \"\";\r\n\t\tvar url = _route.url;\r\n\t\tvar _url = IX.isFn(url)?url(params):url.replaceByParams(params);\r\n\t\tvar _urlBase = (_route.urlType in _urls)?_urls[_route.urlType] : _urls.baseUrl;\r\n\t\treturn _urlBase + _url;\r\n\t};\r\n\treturn {\r\n\t\tinit : function(cfg){_urls = IX.inherit(_urls, cfg);},\r\n\t\tgenUrl : genUrl\r\n\t};\r\n}\r\n\r\nfunction UrlEngine(ifAjax){  \r\n\tvar _ajaxFn = null, _urlFac = new UrlFactory();\r\n\t\r\n\tvar init = function(cfg){\r\n\t\tif (ifAjax && IX.isFn(cfg.ajaxFn))\r\n\t\t\t_ajaxFn = cfg.ajaxFn;\r\n\t\t_urlFac.init(cfg);\t\t\r\n\t};\r\n\treturn IX.inherit({\r\n\t\t/** cfg : {\r\n\t\t * \t\tajaxFn :function(ajaxParams)\r\n\t\t * \t\tbaseUrl : \"https://...\",\r\n\t\t * \t\t[name]Url : \"https: //....\"\r\n\t\t * }\r\n\t\t */\r\n\t\tinit : init, // function(cfg)\r\n\t\treset : init,\t\r\n\t\t/** routes : [{ \r\n\t\t * \t\tname : \"page.entry\",\r\n\t\t * \t\turl : \"/session\" / function(params){return \"/abc\";},\r\n\t\t * \t\turlType : \"urlName\", //default \"base\"\r\n\t\t * \t}]\t\r\n\t\t *  return : function(name, params){}\r\n\t\t */\r\n\t\tcreateRouter : function(routes){\r\n\t\t\treturn new UrlRouter(routes, _urlFac);\r\n\t\t}\t\r\n\t}, ifAjax?{\r\n\t\t/** routes : [{ \r\n\t\t * \t\tname : \"signIn\",\r\n\t\t * \t\turl : \"/session\" / function(params){return \"/abc\";},\r\n\t\t * \t\turlType : \"urlName\", //default \"base\"\r\n\t\t * \r\n\t\t * \t\tchannel : \"named-channel\", //default common\r\n\t\t * \t\ttype : \"POST\"/\"GET\"/\"DELETE\" , //default \"POST\"\r\n\t\t * \t\tpreAjax : function(name, params){return params;}, // default null;\r\n\t\t * \t\tpostAjax : function(name, params, cbFn){}, //default null;\r\n\t\t * \t\tonsuccess : function(data,cbFn, params), \r\n\t\t * \t\tonfail : function(data, failFn, params) // default null;\r\n\t\t * \t}]\t\r\n\t\t * return : function(name, params, cbFn, failFn){}\r\n\t\t */\r\n\t\tcreateCaller: function(routes){\r\n\t\t\treturn new AjaxCaller(routes, function(ajaxParam){\r\n\t\t\t\tif (IX.isFn(_ajaxFn)) _ajaxFn(ajaxParam);\r\n\t\t\t}, _urlFac);\r\n\t\t}\r\n\t} : {});\r\n}\r\n \r\nIX.urlEngine = new UrlEngine();\r\nIX.ajaxEngine = new UrlEngine(true);\r\n})();\r\n/**\r\n * \tIX.Xml is a library to deal with XML string or document. It includes: {\r\n * \t\tparser(xmlString): it convert xmlString to XML document object and return.\r\n * \t\tgetXmlString(xmlDocument) : it convert XML document to string and return.\r\n *  \tduplicate(xmlDocument) : it duplicate xml document object and return.\r\n * \t}\r\n */\r\nIX.Xml = (function(){return {\r\n\tparser:function(str){\r\n\t\tstr = IX.isString(str)?str:\"\";\r\n\t\tvar doc = null;\r\n\t\tif (\"DOMParser\" in window) {\r\n\t\t\tdoc = (new DOMParser()).parseFromString(str, \"text/xml\");\r\n\t\t}else if (\"ActiveXObject\" in window){\r\n\t\t\tdoc=new ActiveXObject(\"Microsoft.XMLDOM\");\r\n\t\t\tdoc.async=\"false\";\r\n\t\t\tdoc.loadXML(str);\r\n\t\t} else {\r\n\t\t\t$XE(\"this browser can't support XML parser.\");\r\n\t\t}\r\n\t\treturn doc;\r\n\t},\r\n\tgetXmlString:function(xmlDoc){\r\n\t\tif(!xmlDoc==null){\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tif(IX.nsExisted(\"document.implementation.createDocument\")) {\r\n\t\t\treturn (new XMLSerializer()).serializeToString(xmlDoc);\r\n\t\t}else if (\"ActiveXObject\" in window){\r\n\t\t\treturn xmlDoc.xml;\r\n\t\t} else {\r\n\t\t\t$XE(\"this browser can't support XML parser.\");\r\n\t\t}\r\n\t\treturn \"\";\r\n\t},\r\n\tduplicate:function(xmlDoc){\r\n\t\treturn this.parser(this.getXmlString(xmlDoc));\r\n\t}\r\n};})();\r\n\r\n/**\r\n * \tIX.Dom is a library to deal with DOM. It includes :{\r\n * \t\tfirst(node, tagN): try to get the first child of DOM element node which tag name is tagN.\r\n * \t\tnext(node, tagN): try to get the first next sibling of DOM element node which tag name is tagN.\r\n * \t\tcdata(node, tagN): try to get the text of DOM element node which is involved by CDATA tag.\r\n * \t\ttext (node, tagN): try to get the text of DOM element node.\r\n * \t\tattr (node, attN): try to get the value of attribute of DOM element node which name is attrN.\r\n * \t\t\r\n * \t\tinTag(tagN, content, attrs): \r\n * \t\tinPureTag(tagN, content, attrs): \r\n * }\r\n */\r\nIX.Dom = (function(){\r\n\tvar loopFn = function(node, type, checkFn, valueFn) {\r\n\t\tif (!node) return valueFn(null);\r\n\t\tvar cnode = (\"firstChild\" in node)?node[type==\"first\"?\"firstChild\":\"nextSibling\"]:null;\r\n\t\twhile(cnode!=null && !checkFn(cnode))\r\n\t\t\tcnode = cnode.nextSibling;\r\n\t\treturn valueFn(cnode);\r\n\t};\r\n\t\r\n\tvar getFn = function(node, tagN, type){\r\n\t\treturn IX.isString(tagN)?loopFn(node, type, function(cnode){\r\n\t\t\t\t\treturn cnode.nodeName.toLowerCase()==tagN;\r\n\t\t\t\t},function(cnode){\r\n\t\t\t\t\treturn cnode;\r\n\t\t\t\t}\r\n\t\t\t):null;\r\n\t};\r\n\tvar textFn = IX.isMSIE?function(node){return node? node.innerText:\"\";}:function(node){return node?node.textContent:\"\";};\r\n\t\r\n\tvar cdataFn = function(node){\r\n\t\tif (!node)\r\n\t\t\treturn \"\";\r\n\t\treturn loopFn(node,\"first\",function(cnode){\r\n\t\t\t\treturn cnode.nodeType==4;\r\n\t\t\t},function(cnode){\r\n\t\t\t\treturn cnode?cnode.nodeValue:\"\";\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\tvar firstFn = function(node,tagN) {\r\n\t\treturn getFn(node,tagN, \"first\");\r\n\t};\r\n\t\t\r\n\tvar inTagFn = function(tag, content, attrs){//attrs should like [[pramName, paramValue],...\r\n\t\tvar _attrs = IX.loop(attrs, [],  function(acc, item){\r\n\t\t\treturn acc.concat(' ', item[0], '=\"', item[1], '\"');\r\n\t\t});\r\n\t\tvar arr = [].concat(\"<\", tag, _attrs, \">\", content, \"</\", tag, \">\");\r\n\t\treturn arr.join(\"\");\r\n\t};\r\n\tvar inPureTagFn = function(tag, content, attrs){\r\n\t\treturn inTagFn(tag, [\"<![CDATA[\", content, \"]]>\"].join(\"\"),  attrs);\r\n\t};\r\n\tvar attrFn = function(node, attN){\r\n\t\tif(!node)\r\n\t\t\treturn \"\";\r\n\t\tvar val = node.getAttribute(attN);\r\n\t\treturn IX.isEmpty(val)?\"\":val;\r\n\t};\r\n\tvar setAttrFn = function(node, attN, val){\r\n\t\tif(!node)\r\n\t\t\treturn;\r\n\t\tif (val)\r\n\t\t\tnode.setAttribute(attN, val);\r\n\t\telse\r\n\t\t\tnode.removeAttribute(attN);\t\t\t\r\n\t};\r\n\treturn {\r\n\t\tfirst:firstFn,\r\n\t\tnext:function(node, tagN){\r\n\t\t\treturn getFn(node, tagN,\"next\");\r\n\t\t},\r\n\t\tcdata:function(node, tagN){\r\n\t\t\treturn cdataFn(firstFn(node, tagN));\r\n\t\t},\r\n\t\ttext:function(node, tagN){\r\n\t\t\treturn textFn(firstFn(node, tagN));\r\n\t\t},\r\n\t\tattr:attrFn,\r\n\t\tsetAttr:setAttrFn,\r\n\t\tdataAttr :function(node, name){\r\n\t\t\treturn attrFn(node, \"data-\" + name);\r\n\t\t},\r\n\t\tsetDataAttr : function(node, name, val){\r\n\t\t\tsetAttrFn(node, \"data-\" + name, val);\r\n\t\t},\r\n\t\tremove: function(node){\r\n\t\t\tif(node)\r\n\t\t\t\tif(node.parentNode)\r\n\t\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t},\r\n\t\tisAncestor : function(node, ancestor){\r\n\t\t\tvar el = node;\r\n\t\t\twhile(el){\t\t\t\t\r\n\t\t\t\tif (el== ancestor)\r\n\t\t\t\t\treturn true;\r\n\t\t\t\tvar nodeName = el.nodeName.toLowerCase();\r\n\t\t\t\tel = (nodeName==\"body\")? null: el.parentNode;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tancestor : function(node, tagName){\r\n\t\t\tif (!node)\r\n\t\t\t\treturn null;\r\n\t\t\tvar el =  node;\r\n\t\t\twhile(el){\r\n\t\t\t\tvar nodeName = el.nodeName.toLowerCase();\r\n\t\t\t\tif (nodeName==tagName)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tel =(nodeName==\"body\")? null: el.parentNode;\r\n\t\t\t}\r\n\t\t\treturn el;\r\n\t\t},\r\n\t\tis : function(el, tagName){\r\n\t\t\treturn el.nodeName.toLowerCase() == tagName;\r\n\t\t},\r\n\t\tinTag : inTagFn,\r\n\t\tinPureTag : inPureTagFn\r\n\t};\r\n})();\r\n$XD = IX.Dom;\r\n/*\r\n*\t\tgetStyle(node, styleName): get node's style. e.g. $XD.getStyle(node, \"border-left-width\"), $XD.getStyle(node, \"font-size\")\r\n*/\r\nIX.HtmlDocument = (function(){\r\n\tvar hasFn = function(el, clzName){\r\n\t\treturn el!=null && (\"className\" in el)&& IX.Array.isFound(clzName, (el.className+\"\").split(\" \"));\r\n\t};\r\n\tvar removeFn = function(el, clzName){\r\n\t\tif (!el) return;\r\n\t\tvar clz = IX.Array.remove(el.className.split(\" \"), clzName);\r\n\t\tel.className = clz.join(\" \");\r\n\t};\r\n\tvar addFn = function(el, clzName) {\r\n\t\tif (!el) return;\r\n\t\tvar clzs = IX.Array.toSet(el.className.split(\" \").concat(clzName));\r\n\t\tel.className = clzs.join(\" \");\r\n\t};\r\n\tvar nextFn = function(node, clzName){\r\n\t\tif (!node)\r\n\t\t\treturn null;\r\n\t\tvar el = node.nextSibling;\r\n\t\twhile(el){\r\n\t\t\tif (hasFn(el, clzName))\r\n\t\t\t\treturn el;\r\n\t\t\tel = el.nextSibling;\r\n\t\t}\r\n\t\treturn el;\r\n\t};\r\n\r\n\tvar getStyle = function(_elem,styles){\r\n        var _value=null, elem= IX.get(_elem);\r\n        styles = styles != \"float\" ? styles : document.defaultView ? \"float\" : \"styleFloat\";\r\n        if(styles == \"opacity\"){\r\n        \tif(elem.filters){//IE, two ways to get opacity because two ways to set opacity and must be set opacity before get\r\n        \t\tif(elem.filters.length > 0){\r\n\t\t            try {\r\n\t\t                _value = elem.filters['DXImageTransform.Microsoft.Alpha'].opacity / 100;\r\n\t\t            }catch(e) {\r\n\t\t                try {\r\n\t\t                    _value = elem.filters('alpha').opacity;\r\n\t\t                } catch(err){}\r\n\t\t            }\r\n\t        \t}else{\r\n\t        \t\t_value = \"1\";\r\n\t        \t}\r\n        \t}else{//w3c\r\n        \t\t_value = elem.style.opacity;\r\n        \t}\r\n        }else{\r\n\t        _value=elem.style[styles] || elem.style[styles.camelize()];\r\n\t        if(!_value){\r\n\t             if (document.defaultView && document.defaultView.getComputedStyle) {\r\n\t                var _css=document.defaultView.getComputedStyle(elem, null);\r\n\t                _value= _css ? _css.getPropertyValue(styles) : null;\r\n\t             }else if (elem.currentStyle){\r\n\t                _value = elem.currentStyle[styles.camelize()];\r\n\t             }\r\n\t        }\r\n\t        if(_value==\"auto\" && IX.Array.indexOf([\"width\",\"height\"], function(_i){return styles == _i;}) > -1 && elem.style.display!=\"none\"){\r\n\t            _value=elem[\"offset\"+styles.capitalize()]+\"px\";\r\n\t        }\r\n        }\r\n        return _value==\"auto\" ? null :_value;\r\n    };\r\n\treturn {\r\n\t\tgetStyle : getStyle,\r\n\t\thasClass : hasFn,\r\n\t\tremoveClass : removeFn,\r\n\t\taddClass : addFn,\r\n\t\ttoggleClass : function(el, clzName){\r\n\t\t\tif (!el) return;\r\n\t\t\tif (hasFn(el, clzName))\r\n\t\t\t\tremoveFn(el, clzName);\r\n\t\t\telse addFn(el, clzName);\r\n\t\t},\r\n\t\tnext :nextFn,\r\n\t\tfirst : function(parentEl, clzName){\r\n\t\t\tif (!parentEl)\r\n\t\t\t\treturn null;\r\n\t\t\tvar el = parentEl.firstChild;\r\n\t\t\treturn hasFn(el, clzName)?el: nextFn(el, clzName);\r\n\t\t},\r\n\t\tisAncestor : function(node, pnode) {\r\n\t\t\tif (!node)\r\n\t\t\t\treturn false;\r\n\t\t\tvar el =  node;\r\n\t\t\twhile(el!=null){\r\n\t\t\t\tif (el==pnode)\r\n\t\t\t\t\treturn true;\r\n\t\t\t\tel = el.parentNode;\r\n\t\t\t\tif (el && el.nodeName.toLowerCase()==\"body\")\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tancestor : function(node, clzName){\r\n\t\t\tif (!node)\r\n\t\t\t\treturn null;\r\n\t\t\tvar el =  node;\r\n\t\t\twhile(el!=null && !hasFn(el, clzName)){\r\n\t\t\t\tel = el.parentNode;\r\n\t\t\t\tif (el && el.nodeName.toLowerCase()==\"body\")\r\n\t\t\t\t\tel = null;\r\n\t\t\t}\r\n\t\t\treturn el;\r\n\t\t},\r\n\t\t\r\n\t\tgetWindowScreen : function(){\r\n\t\t\tvar body = document.documentElement;\r\n\t\t\tvar win = window;\r\n\t\t\tvar _scrollX = \"scrollX\" in win?win.scrollX:body.scrollLeft,\r\n\t\t\t\t_scrollY = \"scrollX\" in win?win.scrollY:body.scrollTop;\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\tscroll : [_scrollX, _scrollY, body.scrollWidth, body.scrollHeight],\r\n\t\t\t\tsize : [body.clientWidth, body.clientHeight]\r\n\t\t\t};\r\n\t\t},\r\n\t\tgetScroll: function(_dom){\r\n            if (_dom && _dom.nodeType != 9){//not document\r\n            \treturn {\r\n                    scrollTop: _dom.scrollTop,\r\n                    scrollLeft: _dom.scrollLeft\r\n                };\r\n            }\r\n            var _window = !_dom ? window : _dom.defaultView || _dom.parentWindow;\r\n            return { scrollTop: _window.pageYOffset\r\n\t\t\t\t    || _window.document.documentElement.scrollTop\r\n\t\t\t\t    || _window.document.body.scrollTop\r\n\t\t\t\t    || 0,\r\n                scrollLeft: _window.pageXOffset\r\n\t\t\t\t    || _window.document.documentElement.scrollLeft\r\n\t\t\t\t    || _window.document.body.scrollLeft\r\n\t\t\t\t    || 0\r\n            };\r\n\t\t},\r\n\t\tgetZIndex : function(el) {\r\n\t\t\tvar style = null, zIndex = null;\r\n\t\t\twhile(el && el.tagName.toLowerCase()!=\"body\"){\r\n\t\t\t\tstyle = IX.getComputedStyle(el);\t\t\t\t\r\n\t\t\t\tif (style.zIndex !=\"auto\")\r\n\t\t\t\t\treturn style.zIndex - 0;\r\n\t\t\t\tel = el.offsetParent;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t},\r\n\t\t/* ri : [ left, top, width, height] */\r\n\t\trect : function(el, ri){\r\n\t\t\tIX.iterate([\"left\", \"top\", \"width\", \"height\"], function(attr, idx){\r\n\t\t\t\tif (ri[idx]!=null)\r\n\t\t\t\t\tel.style[attr] = ri[idx] + \"px\";\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetWindowScrollTop : function() {\r\n\t\t\treturn window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop\t|| 0;\r\n\t\t},\r\n\t\tgetPosition : function(el, isFixed){\r\n\t\t\t// getBoundingClientRect : Supported by firefox,chrome,IE8+,opera,safari\r\n\t\t\t// Return {top, left, right, bottom[, width, height]}\r\n\t\t\t// width and height are not supported in IE\r\n\t\t\t// top|left|right|bottom are offset value for visible part of window.\r\n\t\t\tvar rect = el.getBoundingClientRect(),\r\n\t\t\t\tdoc = document.documentElement || document.body;\r\n\t\t\treturn [\r\n\t\t\t\trect.left + (isFixed ? 0 : window.scrollX || doc.scrollLeft),\r\n\t\t\t\trect.top + (isFixed ? 0 : window.scrollY || doc.scrollTop),\r\n\t\t\t\tel.offsetWidth,\r\n\t\t\t\tel.offsetHeight\r\n\t\t\t];\r\n\t\t}\r\n\t};\t\r\n})();\r\n$XH = IX.HtmlDocument;\r\n\r\nIX.Cookie = (function(){\r\n\tvar getOptions = function(options){\r\n\t\tif (!options)\r\n\t\t\treturn [];\r\n\t\tvar vals = [];\r\n\t\tif (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {\r\n\t\t\tvar date;\r\n\t\t\tif (typeof options.expires == 'number') {\r\n\t\t\t\tdate = new Date();\r\n\t\t\t\tdate.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));\r\n\t\t\t} else {\r\n\t\t\t\tdate = options.expires;\r\n\t\t\t}\r\n\t\t\tvals.push('; expires=' + date.toUTCString()); // use expires attribute, max-age is not supported by IE\r\n\t\t}\r\n\t\tif (\"path\" in options)vals.push('; path=' + options.path);\r\n\t\tif (\"domain\" in options)vals.push('; domain=' + options.domain);\r\n\t\tif (\"secure\" in options)vals.push('; secure=' + options.secure);\r\n\t\tvals.push(';HttpOnly');\r\n\t\treturn vals;\r\n\t};\r\n\tvar _set = function(name, value, options){\r\n\t\tvar vals = [name, '=', encodeURIComponent(value)].concat(getOptions(options));\r\n\t\tdocument.cookie = vals.join('');\t\r\n\t};\r\n\t\r\n\treturn {\r\n\t\tget : function(name){\r\n\t\t\tif (IX.isEmpty(document.cookie))\r\n\t\t\t\treturn \"\";\r\n\t\t\tvar cookies = document.cookie.split(';');\r\n\t\t\tfor (var i = 0; i < cookies.length; i++) {\r\n\t\t\t\tvar cookieN = cookies[i].trim();\r\n\t\t\t\t// Does this cookie string begin with the name we want?\r\n\t\t\t\tif (cookieN.substring(0, name.length + 1) == (name + '='))\r\n\t\t\t\t\treturn decodeURIComponent(cookieN.substring(name.length + 1));\r\n\t        }\r\n\t        return \"\";\r\n\t\t},\r\n\t\tset : _set,\r\n\t\tremove : function(name){\r\n\t\t\t_set(name, '', {\r\n\t\t\t\texpires: -1\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n})();\r\n\r\n/** interval : n milliseconds */\r\nIX.Task = function(taskFn, interval, times){\r\n\tvar ts = -1;\r\n\tvar h = null;\r\n\tvar execFlag = false;\r\n\tvar _times = 0, _total = isNaN(times)?-1:times;\r\n\tvar getTimeInMS = IX.getTimeInMS;\r\n\tfunction _fn(){\r\n\t\tif (!execFlag)\r\n\t\t\treturn;\r\n\t\ttaskFn(_times);\r\n\t\t_times ++ ;\r\n\t\tif (_total>0 && _times>=_total)\r\n\t\t\treturn;\r\n\t\tvar _ts = getTimeInMS();\r\n\t\th= setTimeout(_fn, ts + 2 * interval - _ts);\r\n\t\tts = _ts; \r\n\t}\r\n\t\r\n\treturn {\r\n\t\tstart : function(){\r\n\t\t\tts = getTimeInMS();\r\n\t\t\texecFlag = true;\r\n\t\t\t_times = 0;\r\n\t\t\th = setTimeout(_fn, interval);\r\n\t\t},\r\n\t\tstop : function(){\r\n\t\t\texecFlag = false;\r\n\t\t\tclearTimeout(h);\r\n\t\t\th = null;\r\n\t\t\tts = -1;\t\r\n\t\t}\r\n\t};\r\n};\r\n(function(){\r\n/**\r\n * \r\n * @param {} config \r\n *  tpl :  the HTML template definition.\r\n *  tplDataFn : the function to provide data to tpl[tplId]\r\n *  \r\n * @return {}\r\n */\r\nvar tplRegex = new RegExp('(?:<tpl.*?>)|(?:<\\/tpl>)', 'img');\r\nvar rpRegex = /([#\\{])([\\u4E00-\\u9FA5\\w\\.-]+)[#\\}]/g;\r\nvar idRegex = /['\"]/;\r\n\r\nvar regSplit = function(str, reg){\r\n\tvar _splitArr = [], _matchArr = str.match(reg), _len = _matchArr ? _matchArr.length : 0;\r\n\tfor(var i = 0;i < _len;i++){\r\n\t\tvar _arr = _matchArr[i], _idx = str.indexOf(_arr);\r\n\t\tif(_idx == -1)\r\n\t\t\tcontinue;\r\n\t\t_splitArr.push(str.substring(0,_idx));\r\n\t\tstr = str.substring(_idx + _arr.length);\r\n\t}\r\n\t_splitArr.push(str);\r\n\treturn {separate : _splitArr, arr : _matchArr};\r\n};\r\nvar parseTpl = function(tplstr){\r\n\tvar tplMgr = {};\r\n\tvar newTpl = function(name, html){tplMgr[name] = {name : name,tpl : [html]};};\r\n\tvar appendTpl = function(name, html){tplMgr[name].tpl.push(html);};\r\n\tvar reformTpl = function(name){\r\n\t\tvar curTpl = tplMgr[name];\r\n\t\tvar html =  curTpl.tpl.join(\"\");\r\n\t\tcurTpl.tpl = html; \r\n\t\tcurTpl.list =  IX.Array.toSet(html.match(rpRegex)).sort();\r\n\t};\r\n\tvar _openTpl = function(acc, newName, html){\r\n\t\tvar newTplName = acc[0] + \".\" + newName;\r\n\t\tappendTpl(acc[0], \"#\"+ newName + \"#\");\r\n\t\tacc.unshift(newTplName);\r\n\t\tnewTpl(newTplName, html);\r\n\t\treturn acc;\t\r\n\t};\r\n\tvar _closeTpl = function(acc, html){\r\n\t\treformTpl(acc[0]);\r\n\t\tacc.shift();\r\n\t\tappendTpl(acc[0], html);\t\t\t\t\r\n\t\treturn acc;\r\n\t};\r\n\tvar _regSplit = tplstr.regSplit(tplRegex);\r\n\tvar tplArr = _regSplit.arr, contentArr = _regSplit.separate;\r\n\tnewTpl(\"root\", contentArr[0]);\r\n\tvar nameArr = IX.loop(tplArr, [\"root\"], function(acc, item, idx) {\r\n\t\tif (item==\"</tpl>\")\r\n\t\t\treturn _closeTpl(acc, contentArr[idx + 1]);\r\n\t\tvar arr = item.split(idRegex);\r\n\t\treturn _openTpl(acc, arr[1], contentArr[idx + 1]);\r\n\t});\r\n\treformTpl(\"root\");\r\n\t\r\n\treturn (nameArr.length==1 && nameArr[0]==\"root\")?tplMgr : null;\r\n};\r\n\r\nvar emptyTpl = {\r\n\trender:function(){return \"\";},\r\n\trenderData:function(){return \"\";},\r\n\tdestroy : function() {},\r\n\tgetTpl: function(){return \"\";}\r\n};\r\nIX.ITemplate = function(config){\r\n\tvar _tpl = $XP(config, \"tpl\", []);\r\n\t_tpl = [].concat(_tpl).join(\"\");\t\r\n\tif(IX.isEmpty(_tpl))\r\n\t\treturn emptyTpl;\t\r\n\tvar tplMgr = parseTpl(_tpl);\r\n\tif (!tplMgr) {\r\n\t\talert(\"unformated Tpl: \" + _tpl);\r\n\t\treturn emptyTpl;\r\n\t}\r\n\t\r\n\tvar _dataFn = $XP(config, \"tplDataFn\");\r\n\tif (!IX.isFn(_dataFn))\r\n\t\t_dataFn = function(){return null;};\r\n\t\r\n\tvar getProps = function(data, name){\r\n\t\tif (!IX.hasProperty(data,name))\r\n\t\t\treturn null;\r\n\t\tvar v = $XP(data, name);\r\n\t\treturn IX.isEmpty(v)?\"\":v;\r\n\t};\r\n\tvar renderFn = function(tplId, data){\r\n\t\tvar tpl = tplMgr[tplId];\r\n\t\tif (!tpl) {\r\n\t\t\talert(\"can't find templete by name: \" + tplId);\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tvar html = tpl.tpl;\r\n\t\tvar arr = IX.loop(tpl.list, [], function(acc, item){\r\n\t\t\tvar t = item.charAt(0);\r\n\t\t\tvar _name = item.substring(1, item.length-1);\r\n\t\t\tif (t=='{') {\r\n\t\t\t\tvar v = getProps(data, _name);\r\n\t\t\t\tif (v!=null)\r\n\t\t\t\t\tacc.push([item, v]);\t\t\t\r\n\t\t\t} else if (t=='#') {\r\n\t\t\t\tvar h = IX.map($XP(data, _name, []), function(itm, idx) {\r\n\t\t\t\t\tvar idata = IX.inherit(itm, {idx: idx});\r\n\t\t\t\t\treturn renderFn(tplId+ \".\" + _name, idata);\r\n\t\t\t\t}).join(\"\");\r\n\t\t\t\tacc.push([item, h]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn acc;\r\n\t\t});\r\n\t\treturn html.loopReplace(arr);\r\n\t};\r\n\r\n\tvar _render = function(tplId, data){\r\n\t\tvar id = \"root\";\t\t\r\n\t\tif (!IX.isEmpty(tplId)) \r\n\t\t\tid = tplId.indexOf(\"root\")==0?tplId : (\"root.\" + tplId);\r\n\t\t\r\n\t\treturn renderFn(id, data?data:_dataFn(id)).replace(/\\[(\\{|\\})\\]/g, \"$1\");\r\n\t};\t\r\n\treturn IX.inherit({\t\t\r\n\t\trender : function(tplId){return _render(tplId);},\r\n\t\trenderData : function(tplId, data){return _render(tplId, data);},\r\n\t\tdestroy : function() {\r\n\t\t\ttplMgr.destroy();\r\n\t\t\ttplMgr = null;\r\n\t\t},\r\n\t\tgetTpl: function(tplId){\r\n\t\t\tif(!tplId)\r\n\t\t\t\treturn _tpl;\r\n\r\n\t\t\tvar _get_p_tpl = function(_id){\r\n\t\t\t\tvar tm = tplMgr[\"root.\" + _id];\r\n\t\t\t\tif(!tm) return \"\";\r\n\t\t\t\tvar ids = _id.split(\".\");\r\n\t\t\t\tvar s = tm.tpl, ci;\r\n\r\n\t\t\t\tif(!tm.list || tm.list.length == 0)\r\n\t\t\t\t\treturn _id == tplId ? s : (\"<tpl id = '\" + ids[ids.length - 1] + \"'>\" + s + \"</tpl>\");\r\n\t\t\t\t\r\n\t\t\t\tfor(var i = 0; i < tm.list.length; i ++){\r\n\t\t\t\t\tci = tm.list[i].replace(/#/g, \"\");\r\n\t\t\t\t\ts = s.replace(new RegExp(\"#\" + ci + \"#\", \"img\"),  _get_p_tpl(_id + \".\" + ci));\r\n\t\t\t\t}\r\n\t\t\t\treturn s;\r\n\t\t\t};\r\n\r\n\t\t\treturn _get_p_tpl(tplId);\r\n\t\t}\r\n\t});\r\n};\r\n\r\n/**\r\n * \tExtends String.prototype for some tool kits. \r\n */\r\nvar substrByLength = function(str, maxLength){\r\n\tvar stringArr = [], matchPRC_regx = /[^\\u0020-\\u007A]/g, strLen = str.length,\r\n\t\tsimpleCharLen = (str.match(/[\\u0020-\\u007A]/g) || []).length,\r\n\t\tsubStringByMaxLength = str.substring(0, maxLength);\r\n\tif((subStringByMaxLength.match(matchPRC_regx) || []).length){\r\n\t\tvar count = 0;\r\n\t\tfor(var i = 0;i < maxLength;i++){\r\n\t\t\tvar key = str[i];\r\n\t\t\tif(key === undefined || count >= maxLength){\r\n\t\t\t\ti < maxLength - 1 && i < strLen && stringArr.push(\"..\");\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcount += key.match(matchPRC_regx) ? 2 : 1;\r\n\t\t\tstringArr.push(key);\r\n\t\t}\r\n\t}else\r\n\t\tstringArr.push(subStringByMaxLength);\r\n\treturn {\r\n\t\treString : stringArr.join(\"\"),\r\n\t\treLength : strLen > maxLength ? maxLength : strLen,\r\n\t\tstringLength : (strLen - simpleCharLen) * 2 + simpleCharLen\r\n\t};\r\n};\r\nvar UrlRegEx = /\\w+:\\/\\/[\\w.]+[^\\s\\\"\\'\\<\\>\\{\\}]*/g;\r\n//var PwdPattern = /^(\\w){6,20}$/;\r\n//var EmailPattern = /^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\\.[a-zA-Z0-9_-])+/;\r\n//var EmailPattern = /^[a-zA-Z0-9]{1}[\\.a-zA-Z0-9_-]*[a-zA-Z0-9]{1}@[a-zA-Z0-9]+[-]{0,1}[a-zA-Z0-9]+[\\.]{1}[a-zA-Z]+[\\.]{0,1}[a-zA-Z]+$/;\r\n//var EmailPattern = /^[_a-zA-Z0-9.]+@(?:[_a-zA-Z0-9]+\\.)+[a-zA-Z0-9]{2,4}$/;\r\nvar EmailPattern = /^[_a-zA-Z0-9.]+[\\-_a-zA-Z0-9.]*@(?:[_a-zA-Z0-9]+\\.)+[a-zA-Z0-9]{2,4}$/;\r\nvar ScriptPattern = new RegExp( '(?:<script.*?>)((\\n|\\r|.)*?)(?:<\\/script>)', 'img');\r\nvar FormPattern = new RegExp( '(?:<form.*?>)|(?:<\\/form>)', 'img'); \r\nvar TrimPattern = /(^\\s*)|\\r/g;\r\nvar ReplaceKeyPattern = /{[^{}]*}/g;\r\nIX.extend(String.prototype, {\r\n\tcamelize: function(){ return this.replace(/\\-(\\w)/ig, function(B, A) {return A.toUpperCase();}); },\r\n\tcapitalize: function(){ return this.charAt(0).toUpperCase() + _str.substring(1).toLowerCase(); },\r\n\treplaceAll:function(os, ns){return this.replace(new RegExp(os,\"gm\"),ns);},\r\n\tloopReplace:function(varr){return IX.loop(varr, this, function(acc, item){\r\n\t\treturn acc.replaceAll(item[0], item[1]);\r\n\t});},\r\n\t\t\r\n\ttrim:function(){\r\n\t\tvar str = this.replace(TrimPattern, \"\"),\r\n\t\t\tend = str.length-1,\r\n\t\t\tws = /\\s/;\r\n\t\twhile(ws.test(str.charAt(end)))\t\r\n\t\t\tend --;\r\n\t\treturn str.substring(0, end+1);\r\n\t},\r\n\tstripTags:function() {return this.replace(/<\\/?[^>]+>/gi, '');},\r\n\tstripScripts: function() {return this.replace(ScriptPattern, '');},\r\n\tstripFormTag:function(){return this.replace(FormPattern, '');},\r\n\tstrip:function() {return this.replace(/^\\s+/, '').replace(/\\s+$/, '');},\r\n\tsubstrByLength : function(len){ return substrByLength(this.toString(), len); },\r\n\tisSpaces:function() {return (this.replace(/(\\n)|(\\r)|(\\t)/g, \"\").strip().length==0);},\r\n\r\n\tisPassword : function(){return this.length > 5 && this.length < 21;},\r\n\tisEmail : function(){\r\n\t\tvar email = this.trim();\r\n\t\treturn IX.isEmpty(email) || EmailPattern.exec(email);\r\n\t},\r\n\t\r\n\ttrunc:function(len){return (this.length>len)?(this.substring(0, len-3)+\"...\"):this;},\r\n\ttail:function(len){return (this.length>len)?(this.substring(this.length-len)):this;},\r\n\r\n\tdehtml:function(){return this.loopReplace([[\"&\", \"&amp;\"], [\"<\", \"&lt;\"],['\"', \"&quot;\"]]);},\r\n\tenhtml:function(){return this.loopReplace([[\"&lt;\", \"<\"],[\"&quot;\",'\"'], [\"&amp;\", \"&\"]]);},\r\n\r\n\tmulti:function(len){ return IX.Array.init(len, this).join(\"\");},\r\n\t\r\n\tpickUrls:function(){return this.match(UrlRegEx);},\r\n\treplaceUrls : function(_r, _f){return this.replace(_r || UrlRegEx, _f || function(a){return '<a href=\"'+ a + '\" target=\"_blank\">' + a + '</a>';});},\r\n\tregSplit : function(reg){ return regSplit(this, reg); },\r\n\t\r\n\tpick4Replace : function(){return this.match(ReplaceKeyPattern); },\r\n\treplaceByParams : function(data) {\r\n\t\tvar items = IX.Array.compact(this.match(ReplaceKeyPattern));\r\n\t\treturn IX.loop(items, this, function(acc, item){\r\n\t\t\tvar _key = item.slice(1,-1);\r\n\t\t\treturn IX.isEmpty(_key)?acc:acc.replaceAll(item, $XP(data, _key, \"\"));\r\n\t\t});\r\n\t},\r\n\tinPureTag :function(tagN, attrs){return IX.Dom.inPureTag(tagN, this, attrs);},\r\n\tinTag :function(tagN, attrs){return IX.Dom.inTag(tagN, this, attrs);},\r\n\r\n\ttoSafe : function(){\r\n\t\treturn this.replace(/\\$/g, \"&#36;\");\r\n\t},\r\n\t/**\r\n\t * \r\n\t * @param  {Number} nLen\t\r\n\t * @param  {String} ch \t\r\n\t * @return {String}\t\t\r\n\t */\r\n\tpadLeft : function (nLen, ch) {\r\n\t\tvar len = 0,\r\n\t\t\ts = this ? this : \"\";\r\n\t\t// 0\r\n\t\tch = ch ? ch : '0';\r\n\t\tlen = s.length;\r\n\t\twhile(len < nLen) {\r\n\t\t\ts = ch + s;\r\n\t\t\tlen++;\r\n\t\t}\r\n\t\treturn s;\r\n\t},\r\n\t/**\r\n\t * \r\n\t * @param  {Number} nLen\t\r\n\t * @param  {String} ch \t\t\r\n\t * @return {String}\t\t\t\r\n\t */\r\n\tpadRight : function (nLen, ch) {\r\n\t\tvar len = 0,\r\n\t\t\ts = this ? this : \"\";\r\n\t\t// 0\r\n\t\tch = ch ? ch : '0';\r\n\t\tlen = s.length;\r\n\t\twhile(len < nLen) {\r\n\t\t\ts = s + ch;\r\n\t\t\tlen++;\r\n\t\t}\r\n\t\treturn s;\r\n\t},\r\n\t/**\r\n\t * Math.pow(10, scale)\r\n\t * @param  {Number} scale \t\r\n\t * @return {String} \t\t\r\n\t */\r\n\tmovePointLeft : function (scale) {\r\n\t\tvar s, s1, s2, ch, ps, sign;\r\n\t\tch = '.';\r\n\t\tsign = '';\r\n\t\ts = this ? this : \"\";\r\n\t\tif (scale <= 0) return s;\r\n\t\tps = s.split('.');\r\n\t\ts1 = ps[0] ? ps[0] : \"\";\r\n\t\ts2 = ps[1] ? ps[1] : \"\";\r\n\t\tif (s1.slice(0, 1) == \"-\") {\r\n\t\t\t// \r\n\t\t\ts1 = s1.slice(1);\r\n\t\t\tsign = '-';\r\n\t\t}\r\n\t\tif (s1.length <= scale) {\r\n\t\t\tch = \"0.\";\r\n\t\t\ts1 = s1.padLeft(scale);\r\n\t\t}\r\n\t\treturn sign + s1.slice(0, -scale) + ch + s1.slice(-scale) + s2;\r\n\t},\r\n\t/**\r\n\t * Math.pow(10, scale)\r\n\t * @param  {Number} scale \t\r\n\t * @return {String} \t\t\r\n\t */\r\n\tmovePointRight : function (scale) {\r\n\t\tvar s, s1, s2, ch, ps;\r\n\t\tch = '.';\r\n\t\ts = this ? this : \"\";\r\n\t\tif (scale <= 0) return s;\r\n\t\tps = s.split('.');\r\n\t\ts1 = ps[0] ? ps[0] : \"\";\r\n\t\ts2 = ps[1] ? ps[1] : \"\";\r\n\t\tif (s2.length <= scale) {\r\n\t\t\tch = '';\r\n\t\t\ts2 = s2.padRight(scale);\r\n\t\t}\r\n\t\treturn s1 + s2.slice(0, scale) + ch + s2.slice(scale, s2.length);\r\n\t},\r\n\t/**\r\n\t * Math.pow(10, scale)\r\n\t * @param  {Number} scale \t\t0\r\n\t * @return {String} \t\t\t\r\n\t */\r\n\tmovePoint : function (scale) {\r\n\t\tif (scale >= 0) {\r\n\t\t\treturn this.movePointRight(scale);\r\n\t\t} else {\r\n\t\t\treturn this.movePointLeft(-scale);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/**\r\n * \t\tExtends Function.prototype which function bind.\r\n */\r\nFunction.prototype.bind = function() {\r\n\tvar __method = this, args = $XA(arguments), object = args.shift();\r\n\treturn function() {return __method.apply(object, args.concat($XA(arguments)));};\r\n};\r\n})();\r\n/**\r\n * \tIX.UUID is a generator to create UUID.\r\n */\r\nIX.UUID = (function(){\r\n\tvar itoh = '0123456789ABCDEF';\r\n\treturn {\r\n\t\tgenerate:function() {\r\n\t\t\tvar  s = new Array() ;\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i = 0; i <36; i++)\r\n\t\t\t\ts[i] = Math.floor(Math.random()*0x10);\r\n\t\t\ts[14] = 4;\r\n\t\t\ts[19] = (s[19] & 0x3) | 0x8;\r\n\t\t\t\r\n\t\t\tfor (i = 0; i <36; i++) s[i] = itoh[s[i]];\r\n\t\t\ts[8] = s[13] = s[18] = s[23] = ''; // seperator\r\n\t\t\treturn s.join('');\r\n\t\t}\r\n\t};\r\n})();\r\n\r\nIX.ns(\"IX.Util\");\r\n// Not be supported by IE serials\r\nIX.Util.Image = (function(){\r\n\tvar _getImageDataUrl = function(img,cw,ch, w, h){\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tcanvas.width = cw;  \r\n\t\tcanvas.height = ch;\r\n\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\tctx.drawImage(img, (cw-w)/2, (ch-h)/2, w, h);\r\n\t\tvar dataURL = canvas.toDataURL(\"image/png\");\r\n\t\tdelete canvas;\r\n\t\treturn dataURL;\r\n\t};\r\n\tvar getRatioWH = function(w, h, rw, rh){\r\n\t\tvar wratio = w/rw, hratio = h/rh;\r\n\t\tif (wratio>=1 && hratio>=1)\r\n\t\t\treturn [rw, rh];\r\n\t\twratio = Math.min(wratio, hratio);\r\n\t\treturn [rw * wratio, rh *wratio];\t\t\r\n\t};\r\n\t/* cfg : {width, height}\r\n\t * return : {url, w, h, data}\r\n\t */\r\n\tvar getImageData = function(imgEl, cfg){\r\n\t\tif (!imgEl)\r\n\t\t\treturn null;\r\n\t\tvar img = new Image();\r\n\t\timg.src = imgEl.src;\r\n\t\tvar wh =getRatioWH($XP(cfg, \"width\", img.width), $XP(cfg, \"height\", img.height), img.width, img.height);\r\n\t\tif (wh[0] * wh[1] == 0)\r\n\t\t\treturn null;\r\n\t\tvar dataURL = _getImageDataUrl(img, wh[0], wh[1], wh[0], wh[1]);\r\n\t\tdelete img;\r\n\t\treturn {\r\n\t\t\turl : imgEl.src,\r\n\t\t\tw: wh[0], \r\n\t\t\th: wh[1],\r\n\t\t\tdata : dataURL\r\n\t\t};\r\n\t};\r\n\tvar setImageData = function(imgEl, imgData, keepRatio){\r\n\t\tif (!imgEl)\r\n\t\t\treturn;\r\n\t\tvar img = new Image();\r\n\t\timg.src = imgData.data;\r\n\t\tvar cwEl = keepRatio?imgEl:img;\r\n\t\tvar wh =getRatioWH(cwEl.width, cwEl.height, img.width, img.height);\r\n\t\t//console.log(wh +\":\" + imgEl.width + \":\" + imgEl.height);\r\n\t\tvar dataURL = _getImageDataUrl(img,cwEl.width, cwEl.height, wh[0], wh[1]);\r\n\t\tdelete img;\r\n\t\timgEl.src = dataURL;\r\n\t};\r\n\t\r\n\treturn {\r\n\t\tgetData : getImageData,\r\n\t\tsetData : setImageData\r\n\t};\r\n})();\r\nIX.Util.Date = function(timeInSecond) {\r\n\tvar date = new Date(timeInSecond*1000);\t\r\n\tvar getFieldValues = function(_time){\r\n\t\tvar getPrefix = \"get\" + (IX.Date.isUTC()?\"UTC\":\"\");\r\n\t\treturn IX.map([\"FullYear\", \"Month\", \"Date\", \"Hours\", \"Minutes\", \"Day\"], function(f){\r\n\t\t\tvar v  = _time[getPrefix + f]() - (f==\"Month\"?-1:0);\r\n\t\t\tif (f!=\"Hours\" && f!=\"Minutes\")\r\n\t\t\t\treturn v;\r\n\t\t\tvar s = \"00\"+ v;\r\n\t\t\treturn s.substring(s.length-2);\r\n\t\t});\r\n\t};\r\n\tvar _formatStr = function(x, len) {\r\n\t\tvar str = \"\" + x;\r\n\t\tvar l = len || 2;\r\n\t\treturn (\"0\".multi(l) + str).substr(str.length, l);\r\n\t}; \r\n\tvar time = getFieldValues(date);\r\n\treturn {\r\n\t\ttoText: function(){return IX.Date.format(date);},\r\n\t\ttoWeek : function() {return time[5];},\r\n\t\ttoDate: function(incYear){\r\n\t\t\tvar curTime = getFieldValues(new Date());\r\n\t\t\tincYear = incYear || (curTime[0]>time[0]);\r\n\t\t\treturn [incYear?time[0]:\"\", incYear?\"\":\"\",time[1], \"\", time[2], \"\"].join(\"\");\r\n\t\t},\r\n\t\ttoTime : function(){return [time[3], time[4]].join(\":\");},\r\n\t\ttoShort : function(){\r\n\t\t\tvar ds = IX.Date.getDS(), ts = IX.Date.getTS();\r\n\t\t\tvar curTime = getFieldValues(new Date());\r\n\t\t\tvar strs = new Array();\r\n\t\t\tvar shouldAppend = false;\r\n\t\t\tif (time[0] != curTime[0]){\r\n\t\t\t\tshouldAppend = true;\r\n\t\t\t\tstrs.push(_formatStr(time[0], 4));\r\n\t\t\t\tstrs.push(ds);\r\n\t\t\t}\r\n\t\t\tif (shouldAppend || time[1] != curTime[1] || time[2] != curTime[2]){\r\n\t\t\t\tstrs.push(_formatStr(time[1]));\r\n\t\t\t\tstrs.push(ds);\r\n\t\t\t\tstrs.push(_formatStr(time[2]));\r\n\t\t\t\tstrs.push(' ');\r\n\t\t\t}\r\n\t\t\tstrs.push(_formatStr(time[3]));\r\n\t\t\tstrs.push(ts);\r\n\t\t\tstrs.push(_formatStr(time[4]));\t\r\n\t\t\treturn strs.join(\"\");\r\n\t\t},\r\n\t\ttoInterval : function(tsInSec){\r\n\t\t\tvar _date = tsInSec?(new Date(tsInSec*1000)) :(new Date());  \r\n\t\t\tvar v = _date.getTime()/1000-timeInSecond;\r\n\t\t\tif (v< 10)\r\n\t\t\t\treturn \"\";\r\n\t\t\telse if (v<60)\r\n\t\t\t\treturn Math.round(v)+ \"\";\r\n\t\t\telse if (v<3600)\r\n\t\t\t\treturn Math.round(v/60) + \"\";\r\n\t\t\tvar ds = \"/\", ts = \":\";\r\n\t\t\tvar curTime = getFieldValues(_date);\r\n\t\t\tvar strs = new Array();\r\n\t\t\tvar shouldAppend = false;\r\n\t\t\tif (time[0] != curTime[0]){\r\n\t\t\t\tshouldAppend = true;\r\n\t\t\t\tstrs.push(_formatStr(time[0], 4));\r\n\t\t\t\tstrs.push(ds);\r\n\t\t\t}\r\n\t\t\tif (shouldAppend || time[1] != curTime[1] || time[2] != curTime[2]){\r\n\t\t\t\tstrs.push(_formatStr(time[1]));\r\n\t\t\t\tstrs.push(ds);\r\n\t\t\t\tstrs.push(_formatStr(time[2]));\r\n\t\t\t\tstrs.push(' ');\r\n\t\t\t} else \r\n\t\t\t\tstrs.push(\"\");\r\n\t\t\t\r\n\t\t\tstrs.push(_formatStr(time[3]));\r\n\t\t\tstrs.push(ts);\r\n\t\t\tstrs.push(_formatStr(time[4]));\t\r\n\t\t\treturn strs.join(\"\");\r\n\t\t},\r\n\t\ttoSimpleInterval : function(){\r\n\t\t\treturn IX.Date.getDateText(timeInSecond,IX.getTimeInMS() /1000);\r\n\t\t}\r\n\t};\r\n}; \r\n\r\nIX.Util.Event = {\r\n\ttarget: function(e){\r\n\t\treturn e.target||e.srcElement;\r\n\t},\r\n\tstopPropagation : function(e) {\r\n\t\t//IE\r\n\t\tif ( e && e.stopPropagation )\r\n\t\t\t//W3CstopPropagation()\r\n\t\t\te.stopPropagation();\r\n\t\telse\r\n\t\t\t//IE\r\n\t\t\twindow.event.cancelBubble = true;\r\n\t},\r\n\tpreventDefault : function( e ) {\t//\r\n\t\t//(W3C)\r\n\t\tif ( e && e.preventDefault )\r\n\t\t\te.preventDefault();\r\n\t\t//IE\r\n\t\telse\r\n\t\t\twindow.event.returnValue = false;\r\n\t\treturn false;\r\n\t},\r\n\tstop: function(e){\r\n\t\tIX.Util.Event.preventDefault(e);\r\n\t\tIX.Util.Event.stopPropagation(e);\r\n\t}\r\n};\r\n///////////////////////////////////////////////////// UTILS finished///////////\r\n/**\r\n * \r\n * Basic class definition\r\n * @param {} config {\r\n * \t\tid: the identified object(String, number, ...). If not provider, use IX.UUID to create one.\r\n * \t\ttype: the object type, can be anything which's meaning is assigned by inherit class.\r\n * }\r\n * @return {\r\n * \t\tgetId(): return current object identification.\r\n * \t\tsetId(id): replace identification's value\t\r\n * \t\tgetType() : return current object type. Maybe null.\r\n * \t\tequal(dst) : return if they have same identification.\r\n * \t\tdestroy(): it is better to have  for each new class.\r\n * }\r\n */\r\n/** //Unused temporary \r\nIX.IObject = function(config){\r\n\tvar _id = $XP(config, \"id\", IX.UUID.generate());\r\n\tvar _type = $XP(config, \"type\");\r\n\t\r\n\treturn {\r\n\t\tgetId:function(){\r\n\t\t\treturn _id;\r\n\t\t},\r\n\t\tsetId:function(id){\r\n\t\t\t_id = id;\r\n\t\t},\r\n\t\tgetType:function(){\r\n\t\t\treturn _type;\r\n\t\t},\r\n\t\tequal : function(dst) {\r\n\t\t\treturn _id == dst.getId(); \r\n\t\t},\r\n\t\tdestroy: function(){}\r\n\t};\r\n};\r\n*/\r\nvar getIXScriptEl = function(){\r\n\tif (\"scripts\" in document) {\r\n\t\tvar scripts =document.scripts;\r\n\t\tfor(var i=0; i<scripts.length; i++) {\r\n\t\t\tif (scripts[i].src.indexOf(\"ixutils.js\")>=0)\r\n\t\t\t\treturn scripts[i];\r\n\t\t}\r\n\t}\r\n\tvar head = $XD.first(document.documentElement, \"head\");\r\n\tvar ixEl = $XD.first(head, \"script\");\r\n\twhile(ixEl){\r\n\t\tif (ixEl.src.indexOf(\"ixutils.js\")>=0)\r\n\t\t\tbreak;\t\t\t\r\n\t\tixEl = $XD.next(ixEl, \"script\");\r\n\t}\r\n\treturn ixEl;\r\n};\r\n(function(){\r\nvar ixEl = getIXScriptEl();\r\nvar path = ixEl?ixEl.src:\"\";\r\nIX.SELF_PATH = path;\r\nIX.SCRIPT_ROOT = path.substring(0, path.indexOf(\"lib/ixutils.js\")); \r\n})();\r\n;// Route Engine\r\n(function () {\r\n\tvar RouteAttrDefValue = {name :\"\", url : \"\", urlType : \"site\", type : \"GET\"};\r\n\tfunction urlItemFn(columns, urlDef){\r\n\t\treturn IX.loop(columns, {}, function(acc, name, idx){\r\n\t\t\tvar _value = urlDef.length>idx?urlDef[idx]:null;\r\n\t\t\tif (IX.isEmpty(_value))\r\n\t\t\t\t_value = RouteAttrDefValue[name];\r\n\t\t\tacc[name] = _value;\r\n\t\t\treturn acc;\r\n\t\t});\r\n\t}\r\n\t// columns : [\"name\", \"url\", \"urlType\"] , // or  [\"name\", \"url\", \"urlType\", \"type\"]\r\n\tfunction UrlStore(columns){\r\n\t\tvar _routes = new IX.IListManager();\r\n\t\tvar _urlItemFn = function(urlDef){\r\n\t\t\tvar routeName = urlDef[0];\r\n\t\t\tif (!IX.isEmpty(routeName))\r\n\t\t\t\t_routes.register(routeName, urlItemFn(columns, urlDef));\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tmap : function(urlList){IX.iterate(urlList, _urlItemFn);},\r\n\t\t\tgetAll : _routes.getAll,\r\n\t\t\tget :  _routes.get\r\n\t\t};\r\n\t}\r\n\r\n\tvar urlEngine = IX.urlEngine, ajaxEngine = IX.ajaxEngine;\r\n\tvar urlStore = new UrlStore([\"name\", \"url\", \"urlType\"]),\r\n\t\tajaxStore = new UrlStore([\"name\", \"url\", \"urlType\", \"type\"]);\r\n\tvar urlGenerator = null; //function(name, params){return \"\";};\r\n\tfunction _urlGenerator(name, params){\r\n\t\treturn  IX.isFn(urlGenerator)?urlGenerator(name, params):\"\";\r\n\t}\r\n\r\n\t/** routeDef : \"routeName\" or  {\r\n\t * \t\tname:  \"routeName\",\r\n\t * \t\tchannel: \"\",\r\n\t * \t\turl : function(params){},\r\n\t * \t\tpreAjax : function(name, params){return paramsl;}, // default null;\r\n\t * \t\tpostAjax : function(name, params, cbFn){}, //default null;\r\n\t * \t\tonsuccess : function(data,cbFn, params), \r\n\t * \t\tonfail : function(data, failFn, params) // default null;\r\n\t *  }\r\n\t */\r\n\tfunction createEntries(routes, isCaller){\r\n\t\treturn ajaxEngine[isCaller?\"createCaller\": \"createRouter\"](IX.map(routes, function(routeDef){\r\n\t\t\tvar isRef = IX.isString(routeDef);\r\n\t\t\treturn IX.inherit(ajaxStore.get(isRef?routeDef:routeDef.name), isRef?{}:routeDef);\r\n\t\t}));\r\n\t}\r\n\tfunction initEngine (cfg){\r\n\t\turlEngine.init(cfg);\r\n\t\tajaxEngine.init(cfg);\r\n\t}\r\n\r\n\tIX.ns(\"Hualala\");\r\n\r\n\tHualala.urlEngine = {\r\n\t\tinit : initEngine,\r\n\t\treset :initEngine,\r\n\t\t/**  urlList : [ [name, url, urlType], ...]  */\r\n\t\tmappingUrls : function(urlList){\r\n\t\t\turlStore.map(urlList);\r\n\t\t\turlGenerator = urlEngine.createRouter(urlStore.getAll());\r\n\t\t},\r\n\t\tgenUrls : function(names){return IX.map(names, _urlGenerator);},\r\n\t\tgenUrl : function(name, params){return _urlGenerator(name, params);}\r\n\t};\r\n\tHualala.ajaxEngine = {\r\n\t\tinit : initEngine,\r\n\t\treset :initEngine,\r\n\t\t/**  urlList : [ [name, url, urlType, type], ...]  */\r\n\t\tmappingUrls : ajaxStore.map, //function(urlList)\r\n\t\t\r\n\t\tcreateCaller :  function(routes){return createEntries(routes, true);},\r\n\t\tcreateRoute : createEntries\r\n\t};\r\n})();\r\n\r\n// CommonFn\r\n(function ($) {\r\n\tIX.ns(\"Hualala.Common\");\r\n\t/**\r\n\t * ,\r\n\t * \r\n\t * [protocol] [domain] [path] [fileName] [extension]\r\n\t * [http://] [res.hualala.com] [/group1/M00/1E/3B/][wKgBZE5Izt6pUY8WAAD2HTq6pjo419][.jpg]\r\n\t * @param {String} path ()\r\n\t * @param {Object} cfg \r\n\t *         cfg : {\r\n\t *         \t\t//\r\n\t *         \t\twatermark : true|false \t(,false)\r\n\t *         \t\t//\r\n\t *         \t\tscale : \t'percent'() | \r\n\t *         \t\t\t\t'lockMin'()() | 'lockMax'() | 'unlock'() |\r\n\t *         \t\t\t\t'lockMinZoomOut'(**) | \r\n\t *         \t\t\t\t'lockMinZoomIn'(**) |\r\n\t *         \t\t\t\t'lockMaxZoomOut'(**) |\r\n\t *         \t\t\t\t'lockMaxZoomIn'(**) | \r\n\t *         \t\t\t\t'unlockZoomOut'(**) | \r\n\t *         \t\t\t\t'unlockZoomIn'(**) \r\n\t *         \t\twidth : 300,\r\n\t *         \t\theight : 200,\r\n\t *         \t\t// \r\n\t *         \t\t//NOTEcut\r\n\t *         \t\tcut : \tnull() | 'normal'() | 'max'()\r\n\t *         \t\toffsetX : 0,\r\n\t *         \t\toffsetY : 0,\r\n\t *         \t\t//\r\n\t *         \t\trotate :  degree(0~360) | null\r\n\t *         \t\t//\r\n\t *         \t\tquality : (1-100) | null\r\n\t *         }\r\n\t * @return {String} \r\n\t */\r\n\tHualala.Common.getSourceImage = function (path, cfg) {\r\n\t\tvar settings = IX.inherit({\r\n\t\t\twatermark : false,\r\n\t\t\tscale : 'lockMin',\r\n\t\t\twidth : null,\r\n\t\t\theight : null,\r\n\t\t\tcut : null,\r\n\t\t\toffsetX : null,\r\n\t\t\toffsetY : null,\r\n\t\t\trotate : null,\r\n\t\t\tquality : null\r\n\t\t}, cfg);\r\n\t\tvar imgDomain = !$XP(settings, 'watermark', false) ? \r\n\t\t\tHualala.Global.IMAGE_RESOURCE_DOMAIN : Hualala.Global.IMAGE_RESOURCE_WATERMARK_DOMAIN;\r\n\t\tif (!path || IX.isObject(path)) return '';\r\n\t\tvar lastSlash = path.lastIndexOf('/');\r\n\t\t\tfileName = path.slice(lastSlash + 1),\r\n\t\t\tsuffix = '',\r\n\t\t\tpath = path.slice(0, lastSlash);\r\n\t\tsuffix = fileName.replace(/^(.*)\\.(jpg|jpeg|png|gif|ico)/i, '$2').toLowerCase();\r\n\t\tfileName = fileName.replace(/^(.*)\\.(jpg|jpeg|png|gif|ico)/i, '$1');\r\n\r\n\t\tvar w = $XP(settings, 'width', null), h = $XP(settings, 'height', null),\r\n\t\t\tx = $XP(settings, 'offsetX', null), y = $XP(settings, 'offsetY', null);\r\n\r\n\t\tvar scale = $XP(settings, 'scale'), scaleE = '';\r\n\t\tvar cut = $XP(settings, 'cut', null), cutE = '';\r\n\t\tvar rotate = $XP(settings, 'rotate', null), quality = $XP(settings, 'quality', null),\r\n\t\t\tparamE = [];\r\n\t\tvar scaleRule = {\r\n\t\t\t// < width- >x< height- >\r\n\t\t\t'percent' : '-',\r\n\t\t\t// < width >x< height >\r\n\t\t\t'lockMin' : '',\r\n\t\t\t// < width >x< height>_ 300x200_\r\n\t\t\t'lockMax' : '_',\r\n\t\t\t//  < width >x< height>! 300x200!\r\n\t\t\t'unlock' : '!',\r\n\t\t\t//  < width >x< height>) 600x200)\r\n\t\t\t'lockMinZoomOut' : ')',\r\n\t\t\t//  < width >x< height>( 600x200(\r\n\t\t\t'lockMinZoomIn' : '(',\r\n\t\t\t//  < width >x< height>)_ 600x200)_\r\n\t\t\t'lockMaxZoomOut' : ')_',\r\n\t\t\t//  < width >x< height>(_ 600x200(_\r\n\t\t\t'lockMaxZoomIn' : '(_',\r\n\t\t\t//  < width >x< height>)! 600x200)!\r\n\t\t\t'unlockZoomOut' : ')!',\r\n\t\t\t//  < width >x< height>(! 600x200(!\r\n\t\t\t'unlockZoomIn' : '(!',\r\n\t\t};\r\n\t\tvar cutRule = {\r\n\t\t\t//  c< width >x< height>+< offset_x>+< offset_y>\r\n\t\t\t'normal' : 'c',\r\n\t\t\t'max' : 'C'\r\n\t\t};\r\n\t\t// scale\r\n\t\tif (IX.isEmpty(w) && IX.isEmpty(h)) {\r\n\t\t\tscaleE = '';\r\n\t\t} else if (IX.isEmpty(w) || IX.isEmpty(h)) {\r\n\t\t\tscaleE = scale == 'percent' ? \r\n\t\t\t\t('=' + (IX.isEmpty(w) ? h : w) + scaleRule[scale]) : '';\r\n\t\t} else {\r\n\t\t\tscaleE = '=' + w + (scale == 'percent' ? scaleRule[scale] : '') + 'x' + h + scaleRule[scale];\r\n\t\t}\r\n\r\n\t\t// \r\n\t\t// NOTE:\r\n\t\tif (!IX.isEmpty(cut)) {\r\n\t\t\tscaleE = '';\r\n\t\t\tif (IX.isEmpty(w) || IX.isEmpty(h)) {\r\n\t\t\t\tcutE = '';\r\n\t\t\t} else {\r\n\t\t\t\tcutE = cutRule[cut] + w + 'x' + h + '+' + (x || 0) + '+' + (y || 0);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcutE = '';\r\n\t\t}\r\n\r\n\t\t// \r\n\t\tif (!IX.isEmpty(rotate) && rotate > 0) {\r\n\t\t\tparamE.push('rotate=' + rotate);\r\n\t\t}\r\n\t\t// \r\n\t\tif (!IX.isEmpty(quality) &&  quality > 0) {\r\n\t\t\tparamE.push('quality=' + quality);\r\n\t\t}\r\n\t\tparamE = paramE.join('&');\r\n\t\tvar ret = imgDomain + '/' \r\n\t\t\t+ path + '/' \r\n\t\t\t+ fileName + scaleE + cutE + '.' + suffix \r\n\t\t\t+ (paramE.length > 0 ? ('?' + paramE) : '');\r\n\t\treturn ret;\r\n\t};\r\n})(jQuery);\r\n\r\n\r\n// CommonFn\r\n(function ($) {\r\n\tIX.ns(\"Hualala.Common\");\r\n\t// Image Oprater\r\n\tvar CacheTypes = {\r\n\t\tlogo : \"logo\",\r\n\t\tphoto : \"user\",\r\n\t\tdocThumb : \"thumb\"\r\n\t};\r\n\tHualala.Common.loadImageErr = function (imgEl, type) {\r\n\t\tif (!imgEl || !imgEl.parentNode)\r\n\t\t\treturn ;\r\n\t};\r\n\tvar defaultPhotoImg = null;\r\n\tHualala.Common.avatarFn = function (src, type, clz) {\r\n\t\tif (IX.isEmpty(src)) {\r\n\t\t\tif (!defaultPhotoImg) {\r\n\t\t\t\tdefaultPhotoImg = Hualala.Global.getDefaultImage(\"photo\");\r\n\t\t\t}\r\n\t\t\tsrc = defaultPhotoImg;\r\n\t\t}\r\n\t\treturn '<img src=\"' + src + '\" class=\"' + (clz || \"avatar-32\") +\r\n\t\t\t'\" onerror=\"Hualala.Common.loadImageErr(this, ' + \"'\" + (type || \"photo\") + \"'\" + ');\"/>';\r\n\t};\r\n\r\n\t// Date\r\n\tHualala.Date = IX.Util.Date;\r\n\t/**\r\n\t * Ajax\r\n\t * yyyyMMddHHmmss\r\n\t * yyyy/MM/dd HH:mm:ss\r\n\t * @param  {String} v \tyyyyMMddHHmmss\r\n\t * @return {String}\t\t  yyyy/MM/dd HH:mm:ss\r\n\t */\r\n\tHualala.Common.formatDateTimeValue = function (v) {\r\n\t\tif (IX.isEmpty(v) || !IX.isString(v)) return '';\r\n\t\tvar fullLen = 14, l = v.length, r = '00000000000000';\r\n\t\tif (l < fullLen) {\r\n\t\t\tv += r.slice(0, (fullLen - l));\r\n\t\t}\r\n\t\treturn v.replace(/([\\d]{4})([\\d]{2})([\\d]{2})([\\d]{2})([\\d]{2})([\\d]{2})/g, '$1/$2/$3 $4:$5:$6');\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * offset : {top : [int], left : [int]}\r\n\t */\r\n\tHualala.Common.setCenter = function (el, parentEl, offset) {\r\n\t\t!parentEl && (parentEl = document.documentElement || document.body);\r\n\t\t!offset && (offset = {});\r\n\t\tel.style.top = (((parentEl.clientHeight - el.clientHeight) / 2) + (offset.top || 0)) + 'px';\r\n\t\tel.style.left = (((parentEl.clientWidth - el.clientWidth) / 2) + (offset.left || 0)) + 'px';\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * str : [String]\r\n\t */\r\n\tHualala.Common.strByteLength = function (str) {\r\n\t\tvar i, sum = 0;\r\n\t\tfor (i = 0; i < str.length; i++) {\r\n\t\t\tvar charCode = str.charCodeAt(i);\r\n\t\t\tif ((charCode >= 0) & (charCode <= 255)) {\r\n\t\t\t\tsum += 1;\r\n\t\t\t} else {\r\n\t\t\t\tsum += 2;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn sum;\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * str : [String], n : [int]\r\n\t */\r\n\tHualala.Common.substrByte = function (str, n) {\r\n\t\tvar s2 = str.slice(0, n),\r\n\t\t\ti = s2.replace(/[^\\x00-\\xff]/g, \"**\").length;\r\n\t\tif (i <= n) return s2;\r\n\t\ti -= s2.length;\r\n\t\tswitch (i) {\r\n\t\t\tcase 0 : return s2;\r\n\t\t\tcase n : return str.slice(0, n >> 1);\r\n\t\t\tdefault :\r\n\t\t\t\tvar k = n - i,\r\n\t\t\t\t\ts3 = str.slice(k, n),\r\n\t\t\t\t\tj = s3.replace(/[\\x00-\\xff]/g, \"\").length;\r\n\t\t\t\treturn j ? str.slice(0, k) + Hualala.Common.substrByte(s3, j) : str.slice(0, k);\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * @return {Object} {browserName:version}\r\n\t */\r\n\tHualala.Common.Browser = (function () {\r\n\t\tvar browser = {},\r\n\t\t\tua = navigator.userAgent.toLowerCase(),\r\n\t\t\tmatch = null;\r\n\t\t(match = ua.match(/rv:([\\d.]+)\\) like gecko/)) ? browser['ie'] = match[1] :\r\n\t\t(match = ua.match(/msie ([\\d.]+)/)) ? browser['ie'] = match[1] :\r\n\t\t(match = ua.match(/chrome\\/([\\d.]+)/)) ? browser['chrome'] = match[1] : \r\n\t\t(match = ua.match(/firefox\\/([\\d.]+)/)) ? browser['firefox'] = match[1] :\r\n\t\t(match = ua.match(/opera.([\\d.]+)/)) ? browser['opera'] = match[1] : \r\n\t\t(match = ua.match(/version\\/([\\d.]+).*safari/)) ? browser['safari'] = match[1] : 0;\r\n\t\treturn browser;\r\n\t})();\r\n\r\n\t/**\r\n\t * \r\n\t * @param  {Object} cfg {startLabel, start, end}\r\n\t *          cfg : {\r\n\t *          \tstartLabel : value0label\r\n\t *          \tstart : \r\n\t *          \tend : \r\n\t *          }\r\n\t * @return {[type]}     [description]\r\n\t */\r\n\tHualala.Common.getMinuteIntervalOptions = function (cfg) {\r\n\t\tvar startLabel = $XP(cfg, 'startLabel', ''),\r\n\t\t\tstart = $XP(cfg, 'start', 0),\r\n\t\t\tend = $XP(cfg, 'end', (Hualala.Constants.SecondsOfDay / 60));\r\n\t\t\r\n\t};\r\n    /**\r\n\t *  plainObject\r\n\t * @param  {DOM | jQuery Objuect | selector string} form\r\n\t * @return {Object | null}    { formFiledName1: value1, formFiledName2: value2, ... }\r\n\t */\r\n    Hualala.Common.parseForm = function (form) {\r\n\t\tvar $form = $(form);\r\n        if(!$form[0]) return null;\r\n        \r\n        var fields = $form.serializeArray();\r\n        if(!fields.length) return null;\r\n        \r\n        var result = {};\r\n        $.each(fields, function (i, o) { result[o.name] = o.value; });\r\n        \r\n        return result;\r\n\t\t\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * @param  {String} code  \r\n\t * @param  {Int} start \r\n\t * @param  {Int} end   \r\n\t * @return {Object}\t\t{orig, val}       \r\n\t */\r\n\tHualala.Common.codeMask = function (code, start, end) {\r\n\t\tcode = !code ? '' : code.toString();\r\n\t\tvar len = code.length,\r\n\t\t\tstr = '';\r\n\t\tstart = IX.isEmpty(start) ? 0 : parseInt(start);\r\n\t\tend = IX.isEmpty(end) ? len : parseInt(end);\r\n\t\tstr = code.slice(0, start) + code.slice(start, end).replace(/[\\w]/g, '*') + code.slice(end);\r\n\t\treturn {\r\n\t\t\torig : code,\r\n\t\t\tval : str\r\n\t\t};\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * @param  {String} bankCode \r\n\t * @return {Object}          {code, name, icon_16, icon_32, icon_48, icon_64}\r\n\t */\r\n\tHualala.Common.mapBankInfo = function (bankCode) {\r\n\t\tvar banks = Hualala.TypeDef.BankOptions,\r\n\t\t\tbankHT = new IX.IListManager(),\r\n\t\t\ticonSizes = [16, 32, 48, 64];\r\n\t\t_.each(banks, function (el) {\r\n\t\t\tvar c = $XP(el, 'value'),\r\n\t\t\t\tn = $XP(el, 'label');\r\n\t\t\tvar icons = {};\r\n\t\t\t_.each(iconSizes, function (el) {\r\n\t\t\t\ticons['icon_' + el] = 'icon-' + c + '-' + el;\r\n\t\t\t});\r\n\t\t\tbankHT.register(c, IX.inherit({\r\n\t\t\t\tcode : c,\r\n\t\t\t\tname : n\r\n\t\t\t}, icons));\r\n\t\t});\r\n\t\treturn bankHT.get(bankCode);\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * @param  {Int} \r\n\t * @return {Object} \t{value(), valueStr(), label}\r\n\t */\r\n\tHualala.Common.getGender = function (v) {\r\n\t\tif (IX.isEmpty(v)) return null;\r\n\t\tvar l = Hualala.TypeDef.GENDER;\r\n\t\tvar m = _.find(l, function (el) {\r\n\t\t\tvar id = $XP(el, 'value');\r\n\t\t\treturn id == v;\r\n\t\t});\r\n\t\treturn m;\r\n\t};\r\n\r\n\t/**\r\n\t * \r\n\t * @param  {} v\r\n\t * @return {Object} {value, label}\r\n\t */\r\n\tHualala.Common.getOrderStatus = function (v) {\r\n\t\tif (IX.isEmpty(v)) return null;\r\n\t\tvar l = Hualala.TypeDef.OrderStatus;\r\n\t\tvar m = _.find(l, function (el) {\r\n\t\t\treturn $XP(el, 'value') == v;\r\n\t\t});\r\n\t\treturn m;\r\n\t};\r\n\r\n    /**\r\n\t * shopIDwwwURL\r\n\t * @param  {String} shopID ID\r\n\t * @return {String}    URL\r\n\t */\r\n    Hualala.Common.getShopUrl = function(shopID)\r\n    {\r\n        return Hualala.Global.HualalaWebSite + '/shop_' + shopID;\r\n    };\r\n\r\n})(jQuery);\r\n\r\n// Common Math Fn\r\n(function ($) {\r\n\t// 3\r\n\tvar prettyNumeric = function (num, separator) {\r\n\t\tif (isNaN(num)) return num.toString();\r\n\t\tvar s = num.toString().split('.'),\r\n\t\t\ts1 = s[0],\r\n\t\t\ts2 = s[1],\r\n\t\t\tl = s1.length,\r\n\t\t\tr = '';\r\n\t\tseparator = !separator ? ',' : separator;\r\n\t\tif (l > 3) {\r\n\t\t\tvar l1 = parseInt(l / 3),\r\n\t\t\t\tidx = l % 3;\r\n\t\t\tr = idx == 0 ? '' : s1.slice(0, idx) + separator;\r\n\t\t\tfor (var i = 0; i < l1; i++) {\r\n\t\t\t\tr += s1.slice(idx + (i * 3), (idx + (i + 1) * 3)) + separator;\r\n\t\t\t}\r\n\t\t\tr = r.slice(0, -1) + '.' + s2;\r\n\t\t} else {\r\n\t\t\tr = num;\r\n\t\t}\r\n\t\treturn r;\r\n\t};\r\n\t// \r\n\tvar restoreNumeric = function (str, separator) {\r\n\t\tseparator = !separator ? ',' : separator;\r\n\t\tvar s = str.split(separator).join('');\r\n\t\treturn isNaN(s) ? str : Number(s);\r\n\t};\r\n\t// 2\r\n\tvar prettyPrice = function (price) {\r\n\t\tprice = parseFloat(price).toFixed(2).toString();\r\n\t\tprice = price.replace(/0+$/, '');\r\n\t\tvar dot = price.indexOf('.');\r\n\t\tif (dot == price.length - 1) {\r\n\t\t\tprice = price.substr(0, dot);\r\n\t\t}\r\n\t\treturn price;\r\n\t};\r\n\t\r\n\tvar add = function () {\r\n\t\tvar baseNum = 0, args = $XA(arguments);\r\n\t\tvar ret = 0;\r\n\t\t_.each(args, function (v) {\r\n\t\t\tvar v1 = 0;\r\n\t\t\ttry {\r\n\t\t\t\tv1 = v.toString().split('.')[1].length;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tv1 = 0;\r\n\t\t\t}\r\n\t\t\tbaseNum = v1 > baseNum ? v1 : baseNum;\r\n\t\t});\r\n\t\t// javascriptbug\r\n\t\t// baseNum = Math.pow(10, baseNum);\r\n\t\t_.each(args, function (v) {\r\n\t\t\t// ret += v * baseNum;\r\n\t\t\tret += Number(v.toString().movePoint(baseNum));\r\n\t\t});\r\n\t\t// return ret / baseNum;\r\n\t\treturn Number(ret.toString().movePoint(-baseNum));\r\n\t};\r\n\tvar sub = function () {\r\n\t\tvar baseNum = 0, args = $XA(arguments),\r\n\t\t// \r\n\t\t\tprecision;\r\n\t\tvar ret = 0;\r\n\t\t_.each(args, function (v) {\r\n\t\t\tvar v1 = 0;\r\n\t\t\ttry {\r\n\t\t\t\tv1 = v.toString().split(\".\")[1].length;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tv1 = 0;\r\n\t\t\t}\r\n\t\t\tbaseNum = v1 > baseNum ? v1 : baseNum;\r\n\t\t});\r\n\t\tprecision = baseNum;\r\n\t\t// javascriptbug\r\n\t\t// baseNum = Math.pow(10, baseNum);\r\n\t\t\r\n\t\t_.each(args, function (v, i) {\r\n\t\t\t// ret = i == 0 ? (v * baseNum) : (ret - v * baseNum);\r\n\t\t\tret = i == 0 ?\r\n\t\t\t\tNumber(v.toString().movePoint(baseNum)) : (ret - Number(v.toString().movePoint(baseNum)));\r\n\t\t\t// if (i == 0) {\r\n\t\t\t// \t// ret += v * baseNum;\r\n\t\t\t// \tret += Number(v.toString().movePoint(baseNum));\r\n\t\t\t// } else {\r\n\t\t\t// \t// ret -= v * baseNum;\r\n\t\t\t// \tret -= Number(v.toString().movePoint(baseNum));\r\n\t\t\t// }\r\n\t\t});\r\n\t\t// return (ret / baseNum).toFixed(precision);\r\n\t\treturn Number(numberToFixed(Number(ret.toString().movePoint(-baseNum)), precision));\r\n\t};\r\n\tvar multi = function () {\r\n\t\tvar baseNum = 0, args = $XA(arguments);\r\n\t\tvar ret = 1;\r\n\t\t_.each(args, function (v) {\r\n\t\t\ttry {\r\n\t\t\t\tbaseNum += v.toString().split('.')[1].length;\r\n\t\t\t} catch (e) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\t\t_.each(args, function (v) {\r\n\t\t\tret *= Number(v.toString().replace(\".\", \"\"));\r\n\t\t});\r\n\t\t// javascriptbug\r\n\t\t// return ret / Math.pow(10, baseNum);\r\n\t\treturn Number(ret.toString().movePoint(-baseNum));\r\n\t};\r\n\tvar div = function () {\r\n\t\tvar baseNum = [], baseNum1 = [], args = $XA(arguments);\r\n\t\tvar ret = 1, scale = 0;\r\n\t\t_.each(args, function (v) {\r\n\t\t\ttry {\r\n\t\t\t\tbaseNum.push(v.toString().split(\".\")[1].length);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tbaseNum.push(0);\r\n\t\t\t}\r\n\t\t});\r\n\t\twith (Math) {\r\n\t\t\t_.each(args, function (v, i) {\r\n\t\t\t\tvar v1 = Number(v.toString().replace(\".\", \"\"));\r\n\t\t\t\tret = i == 0 ? v1 : (ret / v1);\r\n\t\t\t});\r\n\t\t\t_.each(baseNum, function (v, i) {\r\n\t\t\t\tscale = i == 0 ? v : (scale - v);\r\n\t\t\t});\r\n\t\t\t// javascriptbug\r\n\t\t\t// return ret * pow(10, scale);\r\n\t\t\treturn Number(ret.toString().movePoint(-scale));\r\n\t\t}\r\n\t};\r\n\tvar numberToFixed = function (num, scale) {\r\n\t\tvar s, s1, s2, start;\r\n\t\tscale = scale || 0;\r\n\t\ts1 = num + \"\";\r\n\t\tstart = s1.indexOf('.');\r\n\t\ts = s1.movePoint(scale);\r\n\t\tif (start >= 0) {\r\n\t\t\ts2 = Number(s1.substr(start + scale + 1, 1));\r\n\t\t\tif (s2 >= 5 && num >= 0 || s2 < 5 && num < 0) {\r\n\t\t\t\ta = Math.ceil(s);\r\n\t\t\t} else {\r\n\t\t\t\ta = Math.floor(s);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Number(a.toString().movePoint(-scale));\r\n\t};\r\n\tIX.ns(\"Hualala.Common\");\r\n\tHualala.Common.Math = {\r\n\t\tprettyNumeric : prettyNumeric,\r\n\t\trestoreNumeric : restoreNumeric,\r\n\t\tprettyPrice : prettyPrice,\r\n\t\tadd : add,\r\n\t\tsub : sub,\r\n\t\tmulti : multi,\r\n\t\tdiv : div,\r\n\t\tnumberToFixed : numberToFixed\r\n\t};\r\n})(jQuery);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;(function ($) {\r\n\tIX.ns(\"Hualala.TypeDef\");\r\n\r\n\t// \r\n\tHualala.TypeDef.SiteNavType = [\r\n\t\t{name : 'order', label : ''},\r\n\t\t{name : 'account', label : ''},\r\n\t\t{name : 'shop', label : ''},\r\n\t\t{name : 'setting', label : ''},\r\n\t\t{name : 'user', label : ''}\r\n\t];\r\n\r\n\tHualala.TypeDef.OrderSubNavType = [\r\n\t\t{name : 'order', label : '', pkeys : []},\r\n\t\t{name : 'orderQuery', label : '', pkeys : ['startDate','endDate','cityID','shopID','orderStatus','userMobile','orderID','s_orderTotal','e_orderTotal']},\r\n\t\t{name : 'orderQueryDay', label : '', pkeys : ['startDate','endDate','cityID','shopID','orderStatus']},\r\n\t\t{name : 'orderQueryDuring', label : '', pkeys : ['startDate','endDate','cityID','shopID','orderStatus']},\r\n\t\t{name : 'orderDishesHot', label : '', pkeys : ['startDate','endDate','cityID','shopID','foodCategoryName']},\r\n\t\t{name : 'orderQueryCustomer', label : '', pkeys : ['startDate','endDate','cityID','shopID','userLoginMobile','userName']}\r\n\t];\r\n\r\n\tHualala.TypeDef.GENDER = [\r\n\t\t{value : '0', valueStr : 'female', label : ''},\r\n\t\t{value : '1', valueStr : 'male', label : ''},\r\n\t\t{value : '2', valueStr : 'unkonwn', label : ''}\r\n\t];\r\n\t/**\r\n\t * \r\n\t * 10:203040455060\r\n\t */\r\n\tHualala.TypeDef.ShopNoteType = {\r\n\t\tTASTE : 10,\r\n\t\tCOOKING : 20,\r\n\t\tFOOD_COMMENT : 30,\r\n\t\tORDER_COMMENT : 40,\r\n\t\tFREE_REASON : 45,\r\n\t\tRETURN_REASON : 50,\r\n\t\tCHARGE_BACK : 60\r\n\t};\r\n\t/**\r\n\t * \r\n\t * 10 11  12 15 20 21 \r\n\t */\r\n\tHualala.TypeDef.OrderSubType = {\r\n\t\tEATIN : 0,\r\n\t\tRESERVE : 10,\r\n\t\tFlash : 11,\r\n\t\tDIY : 12,\r\n\t\tQUEUE : 15,\r\n\t\tTAKEOUT : 20,\r\n\t\tPICKUP : 21\r\n\t};\r\n\t/**\r\n\t * \r\n\t */\r\n\tHualala.TypeDef.TimeID = {\r\n\t\tallday : {value : 0, label : \"\"},\r\n\t\tbreakfast : {value : 1, label : \"\"},\r\n\t\tlunch : {value : 2, label : \"\"},\r\n\t\tafternoon : {value : 3, label : \"\"},\r\n\t\tdinner : {value : 4, label : \"\"},\r\n\t\tsupper : {value : 5, label : \"\"}\r\n\t};\r\n\t/**\r\n\t * \r\n\t */\r\n\tHualala.TypeDef.ShopStatus = [\r\n\t\t{value : 0, label : \"\"},\r\n\t\t{value : 1, label : \"\"},\r\n\t\t{value : 2, label : \"\"},\r\n\t\t{value : 3, label : \"\"},\r\n\t\t{value : 4, label : \"\"},\r\n\t\t{value : 5, label : \"\"},\r\n\t\t{value : 8, label : \"\"},\r\n\t\t{value : 9, label : \"\"}\r\n\t];\r\n\r\n\t/**\r\n\t * \r\n\t * @type {Array}\r\n\t */\r\n\tHualala.TypeDef.OrderStatus = [\r\n\t\t{value : '', label : \"\"},\r\n\t\t// {value : '0', label : \"\"},\r\n\t\t// {value : '10', label : \"\"},\r\n\t\t// {value : '15', label : \"\"},\r\n\t\t{value : '20', label : \"()\"},\r\n\t\t{value : '30', label : \"\"},\r\n\t\t{value : '40', label : \"\"}\r\n\t\t// {value : '50', label : \" \"},\r\n\t];\r\n\r\n\t/**\r\n\t * \r\n\t */\r\n\tHualala.TypeDef.FoodAttr = {\r\n\t\t// \r\n\t\tAUTOADD : 1,\r\n\t\t// \r\n\t\tSPECIALTY : 1,\r\n\t\t// \r\n\t\tRECOMMEND : 1,\r\n\t\t// \r\n\t\tNEW : 1,\r\n\t\t// \r\n\t\tDISCOUNT : 1,\r\n\t\t// \r\n\t\tCOMMENTS : 1,\r\n\t\t// \r\n\t\tCANREFUND : 1,\r\n\t\t// \r\n\t\tSETFOOD : 1,\r\n\t\t// \r\n\t\tTakeawayTag : {\r\n\t\t\tNOTAKEAWAY : 0,\r\n\t\t\tTAKEAWAY : 1,\r\n\t\t\tONLYTAKEAWAY : 2\r\n\t\t},\r\n\t\tHASIMAGE : 1\r\n\t};\r\n\t/**\r\n\t *  \r\n\t * 101+ 102+ 199+ 201- 202- 203- 204- 205- 206- 299-\r\n\t */\r\n\tHualala.TypeDef.FSMTransType = [\r\n\t\t{value : '', label : \"\"},\r\n\t\t{value : 101, label : \"\", tpl : \"tpl_orderpay_detail\", queryCall : \"Hualala.Global.queryAccountOrderPayDetail\", queryKeys : \"orderKey,orderID\"},\r\n\t\t{value : 102, label : \"\", tpl : \"tpl_fsmcustomer_detail\", queryCall : \"Hualala.Global.queryAccountFsmCustomerDetail\", queryKeys : \"SUA_TransItemID,transType\"},\r\n\t\t{value : 103, label : \"\", tpl : \"tpl_orderpay_detail\", queryCall : \"Hualala.Global.queryAccountOrderPayDetail\", queryKeys : \"orderKey,orderID\"},\r\n\t\t{value : 104, label : \"\", tpl : \"tpl_chktick_detail\", queryCall : null, queryKeys : null},\r\n\t\t{value : 105, label : \"\", tpl : \"tpl_fsmcustomer_detail\", queryCall : \"Hualala.Global.queryAccountFsmCustomerDetail\", queryKeys : \"SUA_TransItemID,transType\"},\r\n\t\t{value : 199, label : \"\"},\r\n\t\t{value : 201, label : \"\", tpl : \"tpl_orderpay_detail\", queryCall : \"Hualala.Global.queryAccountOrderPayDetail\", queryKeys : \"orderKey,orderID\"},\r\n\t\t{value : 202, label : \"\"},\r\n\t\t{value : 203, label : \"\", tpl : \"tpl_orderpay_detail\", queryCall : \"Hualala.Global.queryAccountOrderPayDetail\", queryKeys : \"orderKey,orderID\"},\r\n\t\t// {value : 204, label : \"\"},\r\n\t\t// {value : 205, label : \"\"},\r\n\t\t// {value : 206, label : \"\"},\r\n\t\t{value : 207, label : \"\", tpl : \"tpl_orderpay_detail\", queryCall : \"Hualala.Global.queryAccountOrderPayDetail\", queryKeys : \"orderKey,orderID\"},\r\n\t\t{value : 299, label : \"\"},\r\n\t\t{value : 410, label : \"\", tpl : \"tpl_orderpay_detail\", queryCall : \"Hualala.Global.queryAccountOrderPayDetail\", queryKeys : \"orderKey,orderID\"}\r\n\t];\r\n\t/**\r\n\t * \r\n\t * 0 1 2\r\n\t * \r\n\t */\r\n\tHualala.TypeDef.FSMTransStatus = [\r\n\t\t{value : '', label : \"\"},\r\n\t\t{value : 0, label : \"\"},\r\n\t\t{value : 1, label : \"\"},\r\n\t\t{value : 2, label : \"\"}\r\n\t];\r\n\t/**\r\n\t * \r\n\t *  10. 11. 12. 13. 18. 20. 21. 22. 23. 24. 30. 31. 32. 33. \r\n\t */\r\n\tHualala.TypeDef.FSMTransDetail = [\r\n\t\t{value : 10, label : \".\"},\r\n\t\t{value : 11, label : \".\"},\r\n\t\t{value : 12, label : \".\"},\r\n\t\t{value : 13, label : \".\"},\r\n\t\t{value : 18, label : \".\"},\r\n\t\t{value : 20, label : \".\"},\r\n\t\t{value : 21, label : \".\"},\r\n\t\t{value : 22, label : \".\"},\r\n\t\t{value : 23, label : \".\"},\r\n\t\t{value : 24, label : \".\"},\r\n\t\t{value : 30, label : \".\"},\r\n\t\t{value : 31, label : \".\"},\r\n\t\t{value : 32, label : \".\"},\r\n\t\t{value : 33, label : \".\"}\r\n\t];\r\n\r\n\t/**\r\n\t * \r\n\t * @type {Array} 1:;2:\r\n\t */\r\n\tHualala.TypeDef.AccountReceiverTypes = [\r\n\t\t{value : 2, label : \"\"},\r\n\t\t{value : 1, label : \"\"}\r\n\t];\r\n\r\n\t/**\r\n\t * \r\n\t * 101120214142\r\n\t * \r\n\t * advanceTime: int  0\r\n\t * noticeTime:POS int  0|null \r\n\t * minAmount: int 0\r\n\t * serviceAmount: int 0\r\n\t * freeServiceAmount:\r\n\t * holidayFlag: 0:1:2:\r\n\t * openDays:  int\r\n\t * servicePeriods:  string hhmm,hhmm; 2\r\n\t * reserveTableTime:  int \r\n\t * reserveTableDesc: 40\r\n\t * takeawayDeliveryAgent: \"\"\r\n\t * takeawayDeliveryTime:  int \r\n\t * takeawayScope: floor \r\n\t * takeawayScopeDesc: 200\r\n\t * submitSMSTemplateID: ID\r\n\t * checkSMSTemplateID: ID\r\n\t * payMethod:  int 012\r\n\t * needInputTableName:  int 01\r\n\t * supportInvoice:  int 0;1:\r\n\t * supportCommitToSoftware:  01\r\n\t * payMethodAtShop:  int 0123\r\n\t * payBeforeCommit:  int 01\r\n\t * fetchFoodMode :  int 012\r\n\t * \r\n\t */\r\n\tHualala.TypeDef.ShopBusiness = [\r\n\t\t{\r\n\t\t\tid : 10, label : \"\", name : \"commonreserve_order\", businessIsSupported : false, \r\n\t\t\tcallServer : null,\r\n\t\t\tformKeys : 'advanceTime,noticeTime,minAmount,holidayFlag,servicePeriods,reserveTableTime,reserveTableDesc,payMethod'\r\n\t\t},\r\n\t\t{id : 11, label : \"\", name : \"justeat_order\", businessIsSupported : true,\r\n\t\t\tcallServer : 'Hualala.Global.setJustEatParams',\r\n\t\t\tformKeys : 'advanceTime,noticeTime,minAmount,holidayFlag,servicePeriods,reserveTableTime,reserveTableDesc,payMethod'\r\n\t\t},\r\n\t\t{id : 20, label : \"\", name : \"takeaway_order\", businessIsSupported : false,\r\n\t\t\tcallServer : null,\r\n\t\t\tformKeys : 'advanceTime,noticeTime,minAmount,serviceAmount,freeServiceAmount,holidayFlag,servicePeriods,takeawayDeliveryAgent,takeawayDeliveryTime,takeawayScope,takeawayScopeDesc,payMethod'\r\n\t\t},\r\n\t\t{id : 21, label : \"\", name : \"takeout_order\", businessIsSupported : false,\r\n\t\t\tcallServer : null,\r\n\t\t\tformKeys : 'advanceTime,freeServiceAmount,holidayFlag,minAmount,serviceAmount,servicePeriods,noticeTime,payMethod'\r\n\t\t},\r\n\t\t{id : 41, label : \"\", name : \"spot_order\", businessIsSupported : true,\r\n\t\t\tcallServer : 'Hualala.Global.setSpotOrderParams',\r\n\t\t\tformKeys : 'fetchFoodMode,payMethodAtShop,payBeforeCommit,supportCommitToSoftware',\r\n\t\t\toperationMode : {\r\n\t\t\t\t// \r\n\t\t\t\t0 : 'fetchFoodMode,supportCommitToSoftware',\r\n\t\t\t\t// \r\n\t\t\t\t1 : 'payMethodAtShop,payBeforeCommit,supportCommitToSoftware'\r\n\t\t\t}\r\n\t\t}\r\n\t\t// {id : 42, label : \"\", name : \"spot_pay\"}\r\n\t];\r\n\r\n\tHualala.TypeDef.PayMethodOptions = [\r\n\t\t{value : 0, label : \"\"},\r\n\t\t{value : 1, label : \"\"},\r\n\t\t{value : 2, label : \"\"},\r\n\t];\r\n\r\n\tHualala.TypeDef.PayMethodAtShopOptions = [\r\n\t\t{value : 0, label : \"\"},\r\n\t\t{value : 1, label : \"\"},\r\n\t\t{value : 2, label : \"\"},\r\n\t\t{value : 3, label : \"\"}\r\n\t];\r\n\r\n\tHualala.TypeDef.FetchFoodModeOptions = [\r\n\t\t{value : 0, label : \"\"},\r\n\t\t{value : 1, label : \"\"},\r\n\t\t{value : 2, label : \"\"}\r\n\t];\r\n\r\n\tHualala.TypeDef.HolidayFlagOptions = [\r\n\t\t{value : 0, label : \"\"},\r\n\t\t{value : 1, label : \"\"},\r\n\t\t{value : 2, label : \"\"}\r\n\t];\r\n\r\n\t/**\r\n\t * ()\r\n\t * 115\r\n\t * 1-330\r\n\t * 3-123\r\n\t * 2424\r\n\t * @param {NULL | int} endMin \r\n\t * @return {Array} [{value : minutes, label : 'time format string'}]\r\n\t */\r\n\tHualala.TypeDef.MinuteIntervalOptions = function (endMin) {\r\n\t\tvar start = 0, end = endMin || Hualala.Constants.SecondsOfDay / 60, gap = 15, i = 1;\r\n\t\tvar list = [], cur = 0, minsOfHour = Hualala.Constants.SecondsOfHour / 60,\r\n\t\t\tminsOfDay = minsOfHour * 24;\r\n\t\tvar formatTime = function (m) {\r\n\t\t\tif (m == 0) return '';\r\n\t\t\tvar day = m % minsOfDay == 0 ? m / minsOfDay : 0;\r\n\t\t\t\thour = (m < minsOfHour || m % minsOfDay == 0) ? 0 : (m == minsOfHour) ? 1 : parseInt(m / minsOfHour),\r\n\t\t\t\tmin = m % minsOfHour;\r\n\t\t\treturn (day == 0 ? '' : day + '') + (hour == 0 ? '' : hour + '') + (min == 0 ? '' : (min + ''));\r\n\t\t};\r\n\t\twhile(cur <= end) {\r\n\t\t\tlist.push({\r\n\t\t\t\tvalue : cur,\r\n\t\t\t\tlabel : formatTime(cur)\r\n\t\t\t});\r\n\t\t\tif (cur < minsOfHour) {\r\n\t\t\t\tcur += gap * i;\r\n\t\t\t} else if (cur < minsOfHour * 3) {\r\n\t\t\t\ti = 2;\r\n\t\t\t\tcur += gap * i;\r\n\t\t\t} else if (cur < minsOfHour * 12) {\r\n\t\t\t\ti = 4 * 3;\r\n\t\t\t\tcur += gap * i;\r\n\t\t\t} else if (cur <= minsOfHour * 24) {\r\n\t\t\t\ti = 4 * 12;\r\n\t\t\t\tcur += gap * i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn list;\r\n\t};\r\n\r\n\t/**/\r\n\tHualala.TypeDef.BankOptions = [\r\n\t\t{\r\n\t\t\tvalue: \"CBC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"BC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"ABC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"ICBC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"PSBC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"CEBB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"CGB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"CMB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"CMBC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"CDB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"CIB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"BCM\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"HXB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"SPDB\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"HSBC\",\r\n\t\t\tlabel: \"\"\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: \"Other\",\r\n\t\t\tlabel: \"\"\r\n\t\t}\r\n\t];\r\n\r\n\r\n})(jQuery);;(function ($) {\r\n\tIX.ns(\"Hualala.Constants\");\r\n\t\r\n\tIX.extend(Hualala.Constants, {\r\n\t\tNameOfDay : [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tSecondsOfHour : 3600,\r\n\t\tSecondsOfDay : 24 * 3600,\r\n\t\tSecondsOfWeek : 7 * 24 * 3600,\r\n\t\tNumberKeys : [1,2,3,4,5,6,7,8,9,0],\r\n\t\tAlphabet : 'abcdefghijklmnopqrstuvwxyz'.split(''),\r\n\t\tPersonUnit : \"\",\r\n\t\tCashUnit : \"\"\r\n\t});\r\n})(jQuery);;(function ($, window) {\r\n\t/**\r\n\t * JavascriptRouter\r\n\t * Routerrouter\r\n\t * routerrouter\r\n\t * \r\n\t * \t\t1.URL, http://site.com#shop/list\r\n\t * \t\t2.History APIHistory APIlocation\r\n\t * \t\t3.\r\n\t * \t\t4.\r\n\t * \t\t5.\r\n\t * \t\t6.\r\n\t * @type {Object}\r\n\t */\r\n\tvar Router = {\r\n\t\t// \r\n\t\troutes : [],\r\n\t\t// hash|historyrouterHistory API\r\n\t\tmode : null,\r\n\t\t// pushState\r\n\t\troot : '',\r\n\t\t/**\r\n\t\t * router\r\n\t\t * @param  {Object} options {mode, root}\r\n\t\t * @return {Router}         \r\n\t\t */\r\n\t\tconfig : function (options) {\r\n\t\t\t// pushStateHistory APIhash\r\n\t\t\tthis.mode = $XP(options, 'mode', 'history') == 'history' && !!(history.pushState) ? 'history' : 'hash';\r\n\t\t\t// hashrootclearSlashesoptions.rootURL/\r\n\t\t\tthis.root = options && options.root ? ('/' + this.clearSlashes(options.root) + '/') : '/';\r\n\t\t},\r\n\t\t/**\r\n\t\t * URLHistory APIlocation hash\r\n\t\t * @return {[String]} URL\r\n\t\t */\r\n\t\tgetFragment : function () {\r\n\t\t\tvar fragment = '';\r\n\t\t\tif (this.mode == 'history') {\r\n\t\t\t\tfragment = this.clearSlashes(decodeURI(location.pathname + location.search));\r\n\t\t\t\t// historyget\r\n\t\t\t\tfragment = fragment.replace(/\\?(.*)$/, '');\r\n\t\t\t\t// add hash part by huhao\r\n\t\t\t\tfragment = fragment + location.hash;\r\n\r\n\t\t\t\t// historyroot\r\n\t\t\t\tfragment = this.root != '/' ? fragment.replace(this.root, '') : fragment;\r\n\t\t\t} else {\r\n\t\t\t\tvar match = window.location.href.match(/#(.*)$/);\r\n\t\t\t\tfragment = match ? match[1] : '';\r\n\t\t\t}\r\n\t\t\treturn this.clearSlashes(fragment);\r\n\t\t},\r\n\t\tclearSlashes : function (path) {\r\n\t\t\treturn path.toString().replace(/\\/$/, '').replace(/^\\//, '');\r\n\t\t},\r\n\t\t/**\r\n\t\t * \r\n\t\t * ,\r\n\t\t * @param {String} re      \r\n\t\t * @param {Function} handler \r\n\t\t * @return {Router} \r\n\t\t */\r\n\t\tadd : function (re, handler) {\r\n\t\t\tif (IX.isFn(re)) {\r\n\t\t\t\thandler = re;\r\n\t\t\t\tre = '';\r\n\t\t\t}\r\n\t\t\tthis.routes.push({re : re, handler : handler});\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * \r\n\t\t * handler\r\n\t\t * @param  {regular|function} param |\r\n\t\t * @return {Router}       \r\n\t\t */\r\n\t\tremove : function (param) {\r\n\t\t\tfor (var i = 0, r, l = this.routes.length; i < l, r = this.routes[i]; i++) {\r\n\t\t\t\tif (r.handler === param || r.re === param) {\r\n\t\t\t\t\tthis.routes.splice(i, 1);\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Router\r\n\t\t * @return {Router} \r\n\t\t */\r\n\t\tflush : function () {\r\n\t\t\tthis.routes = [];\r\n\t\t\tthis.mode = null;\r\n\t\t\tthis.root = '/';\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * \r\n\t\t * getFragment\r\n\t\t * \r\n\t\t * @param  {String} f \r\n\t\t * @return {Router}       \r\n\t\t */\r\n\t\tcheck : function (f) {\r\n\t\t\tvar fragment = f || this.getFragment();\r\n\t\t\tfor (var i = 0, l = this.routes.length; i < l; i++) {\r\n\t\t\t\tvar match = fragment.match(this.routes[i].re);\r\n\t\t\t\tif (match) {\r\n\t\t\t\t\tmatch.shift();\r\n\t\t\t\t\tthis.routes[i].handler.apply({}, match);\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * \r\n\t\t * check\r\n\t\t * \r\n\t\t * History APIpopstateURL\r\n\t\t * modehashsetInterval\r\n\t\t * @return {Router}       \r\n\t\t */\r\n\t\tlisten : function () {\r\n\t\t\tvar self = this;\r\n\t\t\t// URL\r\n\t\t\tvar current = self.getFragment();\r\n\t\t\tvar fn = function () {\r\n\t\t\t\tif (current !== self.getFragment()) {\r\n\t\t\t\t\tcurrent = self.getFragment();\r\n\t\t\t\t\tself.check(current);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tclearInterval(this.interval);\r\n\t\t\tthis.interval = setInterval(fn, 50);\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\t/**\r\n\t\t * URL\r\n\t\t * @param  {String} path \r\n\t\t * @return {Router}       \r\n\t\t */\r\n\t\tnavigate : function (path) {\r\n\t\t\tpath = path || '';\r\n\t\t\tif (this.mode == 'history') {\r\n\t\t\t\t// history.pushState(null, null, this.root + this.clearSlashes(path));\r\n\t\t\t\thistory.pushState(null, null, this.root + \"#\" + this.clearSlashes(path));\r\n\t\t\t} else {\r\n\t\t\t\twindow.location.href.match(/#(.*)$/);\r\n\t\t\t\twindow.location.href = window.location.href.replace(/#(.*)$/, '') + '#' + path;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\t};\r\n\tIX.ns('Hualala');\r\n\tHualala.Router = Router;\r\n})(jQuery, window);;/* \r\n:\r\nvar p = new Pymatch([{id:1,name:\"\",py:\"zhang;san\"},{id:2,name:\"\",py:\"li;si\"},{id:5,name:\"JohnSmithMary\",py:\"zhang;li;si\"},{id:8,name:\"\",py:\"cha,zha;li\"}])\r\n','\"cha,zha\"\r\n:\r\np.match(\"zs\")p.clear();p.input(\"zs\");return p.get_match()\r\n:\r\np.input('z')\r\np.input('h')\r\np.input('an')\r\np.input('gsa')\r\np.input('n')\r\np.input(\"\")\r\n:\r\np.back(1) // \"zhangsan\"\r\np.back(3) // \"zhangs\"\r\n:\r\np.clear()\r\n():\r\np.setNames([{name:\"\",py:\"zhang;san\"},{name:\"\",py:\"li;si\"},{name:\"JohnSmithMary\",py:\"zhang;li;si\"},{name:\"\",py:\"wang;er\"}])\r\n\r\np\r\nrnames:[{id:1,...}, {id:2,...}, {id:5,...}, {id:8,...}, {id:9,...}], // ===setNamesnames\r\nnames:[[\"\",[\"zhang\"],[\"san\"]],[\"\",[\"li\"],[\"si\"]],[\"\",[\"wang\"],[\"san\"],[\"biao\"]],[[\"\"],[\"zhang\"],[\"yue\"],[\"wu\"]],[\";\", [\"zhang\"], [\"mary\"]],[\"\",[\"cha\",\"zha\"],[\"li\"]]],\r\npyidx:{\r\nz:[0,0,3,0,4,0], // 0,2,4,6,...znames\r\ns:[0,1,1,1,2,1],\r\n'ln':[1,0],\r\nw:[2,0,3,2],\r\nb:[2,2],\r\ny:[3,1],\r\nm:[4,1]\r\n}\r\nidx:{\r\n:[0,0,3,0,4,0],\r\n:[0,1,2,1],\r\n:[1,0],\r\n:[1,1],\r\n:[2,0],\r\n:[2,2],\r\n:[3,1],\r\n:[3,2]\r\n}\r\n*/\r\nvar Pymatch=(function(){\r\n  function constructor(name2pys) { this.setNames(name2pys); }\r\n\r\n  var simpy = { 'l': 'ln', 'n': 'ln' };\r\n  var W_hzmatch = 1.2, // \r\n      W_first_exactly_match = 0.3, // \r\n      W_other_match = 1 - W_first_exactly_match, // \r\n      W_fuzzy_match = 0.0, // \r\n      W_zcs_match_zhchsh = 0.1; // zcszhchsh\r\n\r\n  // a,b\r\n  function is_sim(a, b) {\r\n    var sa=simpy[a];\r\n    if(sa) {\r\n      var sb = simpy[b];\r\n      return sb && sa==sb;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function getAlt(py) {\r\n    var c1 = py.charAt(0), c2;\r\n    if(c1=='z' || c1=='c' || c1=='s') {\r\n      c2 = py.charAt(1);\r\n      return c1 + (c2 == 'h'? py.substr(2) : 'h' + py.substr(1));\r\n    }\r\n    var sc = simpy[c1];\r\n    if(!sc) return false;\r\n    c2 = sc.charAt(0);\r\n    return (c2 == c1? sc.charAt(1): c2) + py.substr(1);\r\n  }\r\n\r\n  function split2(s, pinyin, cache) {\r\n    var n=s.length, a=[];\r\n    var t = s.charAt(0);\r\n    if(t<'a' || t>'z') {\r\n      if(n<=1)\r\n        a = [[t]];\r\n      else {\r\n        var r = s.substr(1);\r\n        var b = cache[r];\r\n        if(b==undefined)\r\n          b = split2(r, pinyin, cache);\r\n        if(b) {\r\n          if(b.length <= 1) b = b[0];\r\n          a = [[t].concat(b)];\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      for(var k=1; k<=n; ++k) {\r\n        t = s.substr(0, k);\r\n        if(!pinyin[t])\r\n          break;\r\n        if(k<n) {\r\n          var r = s.substr(k);\r\n          var b = cache[r];\r\n          if(b==undefined)\r\n            b = split2(r, pinyin, cache);\r\n          if(!b) continue;\r\n          if(b.length <= 1) b = b[0];\r\n          a.unshift([t].concat(b));\r\n        }\r\n        else\r\n          a.unshift([t]);\r\n      }\r\n    }\r\n    if(a.length <= 0)\r\n      a = false;\r\n    cache[s] = a;\r\n    return a;\r\n  }\r\n\r\n  /* \r\n   pyprefix-\r\n   pys-,\r\n   isHz-true, false\r\n   : false-, -\r\n   */\r\n  function pymatch(pyprefix, pys, isHz) {\r\n    var n = pys.length, i, k = pyprefix.length;\r\n    for(i=0; i<n; ++i) {\r\n      var py = pys[i];\r\n      if(py.substr(0,k)==pyprefix) {\r\n        var v = py.length-1;\r\n        return v<=0? W_first_exactly_match: (W_first_exactly_match+W_other_match*(k-1)/v);\r\n      }\r\n    }\r\n\r\n    if(isHz) {\r\n      var alt = getAlt(pyprefix);\r\n      if(!alt) return false;\r\n      k = alt.length;\r\n      for(i=0; i<n; ++i) {\r\n        var py = pys[i];\r\n        if(py.substr(0,k)==alt) {\r\n          var v = py.length-1, m=W_fuzzy_match;\r\n          var c1 = py.charAt(0);\r\n          if(c1=='z'||c1=='c'||c1=='s') {\r\n            m += W_zcs_match_zhchsh;\r\n            var c2 = py.charAt(1);\r\n            if(c2 == 'h') {\r\n              k -= 1;\r\n              v -= 1;\r\n            }\r\n          }\r\n          if(v<=0)\r\n            return m;\r\n          return m+W_other_match*(k-1)/v;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /*\r\n   pattern: split\r\n   name: , [0], [1]()\r\n   i: \r\n   e: ()\r\n   inplace: false-, true-\r\n   : false, [, , ]\r\n   */\r\n  function pmatch(pattern, name, i, e, inplace) {\r\n    if(!pattern) return false;\r\n    var r, k=pattern.length, v=0;\r\n    for(; v<k; ++v) {\r\n      if(typeof(pattern[v])!=\"string\")\r\n        break;\r\n    }\r\n    while(i+v<=e) {\r\n      var q = i, j=0, m=0.0;\r\n      for(; j<v; ++j, ++q) {\r\n        var p = pattern[j];\r\n        var c = p.charAt(0);\r\n        if(c>='a'&&c<='z') {\r\n          r = pymatch(p, name[q], (name[0].charAt(q-1)!=';'));\r\n          if(r===false) break;\r\n          m += r;\r\n        }\r\n        else if(c == name[0].charAt(q-1))\r\n          m += W_hzmatch;\r\n        else\r\n          break;\r\n      }\r\n      if(j>=v) {\r\n        if(j>=k) return [i, v, m];\r\n        for(; j<k; ++j) {\r\n          var p = pattern[j];\r\n          r = pmatch(p, name, q, e, true);\r\n          if(r)\r\n            return [i, v+r[1], m+r[2]];\r\n        }\r\n      }\r\n      if(inplace) return false;\r\n      ++i;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function match2(s, name, i, e) {\r\n    if(s.length<=0) return false;\r\n\r\n    if(i==undefined)\r\n      i = 1;\r\n    if(e==undefined)\r\n      e = name.length;\r\n    pinyin = {};\r\n    for(var j=i; j<e; ++j) {\r\n      var pys = name[j];\r\n      var k = pys.length, m;\r\n      var isHz = (name[0].charAt(j-1)!=';');\r\n      for(m=0; m<k; ++m) {\r\n        var py = pys[m];\r\n        var n = py.length, v;\r\n        for(v=1; v<=n; ++v)\r\n          pinyin[py.substr(0,v)] = true;\r\n        if(isHz) {\r\n          var alt = getAlt(py);\r\n          if(!alt) continue;\r\n          n = alt.length;\r\n          for(v=1; v<=n; ++v)\r\n            pinyin[alt.substr(0,v)] = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    var p = split2(s, pinyin, {});\r\n    return pmatch(p, name, i, e, false);\r\n  }\r\n\r\n  // [idx, , , ]\r\n  function input_c() {\r\n    var k=this.stkp - 1;\r\n    var i, n, a, b=[], t, ai;\r\n    if(k<=0) {\r\n      var c = this.instr[k];\r\n      var is_py = (c>='a' && c<='z');\r\n      if(is_py) {\r\n        var sc = simpy[c];\r\n        if(!sc) sc = c;\r\n        a = this.pyidx[sc];\r\n      }\r\n      else\r\n        a = this.idx[c];\r\n      if(a) {\r\n        n = a.length;\r\n        for(i=0; i<n; i+=2) {\r\n          var x = a[i], j=a[i+1], name=this.names[x];\r\n          if(is_py) {\r\n            var tpys = name[j+1];\r\n            var tn = tpys.length, ti;\r\n            var m = W_fuzzy_match; // \r\n            for(ti=0; ti<tn; ++ti) {\r\n              var tpy = tpys[ti], d = tpy.charAt(0);\r\n              if(c == d) {\r\n                if(name[0].charAt(j)!=';' && (c=='z'||c=='c'||c=='s') && tpy.charAt(1)=='h')\r\n                  m = W_zcs_match_zhchsh; // zcszh/ch/sh\r\n                else\r\n                  m = W_first_exactly_match; // \r\n                break;\r\n              }\r\n              if(is_sim(c, d))\r\n                break;\r\n            }\r\n            if(ti>=tn) throw \"Pymatch internal data error\";\r\n            t = [x, j+1, 1, m];\r\n          }\r\n          else\r\n            t = [x, j+1, 1, W_hzmatch]; // \r\n          b.push(t);\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      a = this.stack[k-1];\r\n      n = a.length;\r\n      var s = this.instr.substr(0,k+1);\r\n      for(i=0; i<n; ++i) {\r\n        ai = a[i];\r\n        var x = ai[0];\r\n        t = match2(s, this.names[x], ai[1]);\r\n        if(t)\r\n          b.push([x].concat(t));\r\n      }\r\n    }\r\n    this.stack[k] = b;\r\n  }\r\n\r\n  constructor.prototype = {\r\n    setNames: function(name2pys) {\r\n      this.rnames = name2pys;\r\n      this.names = [];\r\n      this.pyidx = {};\r\n      this.idx = {};\r\n      this.stack = [];\r\n      this.instr = \"\";\r\n      this.stkp = 0;\r\n\r\n      var i, n = name2pys ? name2pys.length : 0;\r\n      for(i=0; i<n; ++i) {\r\n        var name2py = name2pys[i];\r\n        var hz = name2py.name;\r\n        var pys = name2py.py;\r\n        pys = ((!pys || pys==\"\") ? []: pys.split(';'));\r\n        var k=hz.length, j, m, nhz=\"\", t=0, x=i;\r\n        var searchLetter=true; // 0-(), 1-\r\n        for(j=0; j<k; ++j) {\r\n          var c = hz.charAt(j);\r\n          if(searchLetter) {\r\n            if((c>='A' && c<='Z') || (c>='a'&&c<='z')) {\r\n              searchLetter = false;\r\n              m = j;\r\n              continue;\r\n            }\r\n          }\r\n          else {\r\n            if(c>='a' && c<='z') continue;\r\n            nhz += ';';\r\n            pys.splice(t, 0, hz.substr(m, j-m).toLowerCase());\r\n            ++t;\r\n            if(c>='A' && c<='Z') {\r\n              m = j;\r\n              continue;\r\n            }\r\n            searchLetter = true;\r\n          }\r\n          if(nhz.indexOf(c) < 0) {\r\n            var a = this.idx[c];\r\n            if(a)\r\n              a.push(x, t);\r\n            else\r\n              this.idx[c] = [x, t];\r\n          }\r\n          nhz += c;\r\n          ++t;\r\n        }\r\n        if(!searchLetter) {\r\n          nhz += ';';\r\n          pys.splice(t, 0, hz.substr(m).toLowerCase());\r\n          ++t;\r\n        }\r\n        var handledIdx={};\r\n        for(j=0; j<t; ++j) {\r\n          if(!pys[j])\r\n          \tcontinue;\r\n\t\t\tpys[j] = pys[j].split(',');\r\n          var b = pys[j];\r\n          var bn = b.length, bi;\r\n          for(bi=0; bi<bn; ++bi) {\r\n            var c = b[bi].charAt(0);\r\n            var sc = simpy[c];\r\n            if(sc) c = sc;\r\n            if(handledIdx[c]) continue;\r\n            var a = this.pyidx[c];\r\n            if(a)\r\n              a.push(x, j);\r\n            else\r\n              this.pyidx[c] = [x, j];\r\n            handledIdx[c] = true;\r\n          }\r\n        }\r\n        pys.unshift(nhz);\r\n        this.names.push(pys);\r\n      }\r\n    },\r\n\r\n    input: function(s) {\r\n      var i, n=s.length;\r\n      for(i=0; i<n; ++i) {\r\n        var c = s.charAt(i);\r\n        if(c==';') continue;\r\n        var j = this.stkp;\r\n        this.stkp = j+1;\r\n        if(j>=this.instr.length || c != this.instr.charAt(j)) {\r\n          if(c>='A' && c<='Z') c = c.toLowerCase();\r\n          this.instr = this.instr.substr(0, j) + c;\r\n          input_c.apply(this);\r\n        }\r\n      }\r\n    },\r\n\r\n    back: function(n) {\r\n      var k = this.stkp;\r\n      if(n<=k)\r\n        this.stkp = k - n;\r\n    },\r\n    \r\n    clear: function() { this.stkp = 0; },\r\n    \r\n    match: function(s) {\r\n      this.clear();\r\n      this.input(s);\r\n      return this.get_match();\r\n    },\r\n    \r\n    get_input: function() {\r\n      return this.instr.substr(0,this.stkp);\r\n    },\r\n    \r\n    get_match: function() {\r\n      var k = this.stkp;\r\n      if(k<=0) return [];\r\n      var a = this.stack[k-1];\r\n      var n = a.length, b=[];\r\n      for(var i=0; i<n; ++i) {\r\n        var ai = a[i], x = ai[0], e = this.names[x][0].length;\r\n        // 1.0, \r\n        b.push([this.rnames[x], (ai[3] + (e - ai[1] + 1)/e)/e]);\r\n      }\r\n      b.sort(function(x,y){return y[1]-x[1];});\r\n      return b;\r\n    }\r\n  };\r\n\r\n  return constructor;\r\n}());\r\n;// Hualala.Matcher\r\n(function(){\r\n\tIX.ns(\"Hualala\");\r\n\t\r\n\t//\r\n\tvar langs = \"zh-cn,zh-tw,en,\";\r\n\t/*\r\n\t\tvar matcher = new Matcher();\r\n\t\tmatcher.match\r\n\t\t\tparams : key  \r\n\t\t\t\t\t callback   infolist[{id,name,py}......]\r\n\t\t\t\t\t lang  config.lang\r\n\t\tmatcher.refresh\t\r\n\t*/\r\n\tHualala.Matcher = function(cfg){\r\n\t\tvar config = $.extend(true, {\r\n\t\t\tlang : \"zh-cn\"\r\n\t\t}, cfg);\r\n\r\n\t\tvar _matcher = new Pymatch([]);\r\n\r\n\t\tvar _loadMatchConfig = function(lang, callback){\r\n\t\t\t//IX.Net.loadFile(\"../\" + lang + \".json\", function(rspTxt){});\r\n\t\t\tcallback && callback();\r\n\t\t};\r\n\r\n\t\tvar _match = function(key,data, callback){\r\n\t\t\t_matcher.setNames(data);\r\n\t\t\tcallback.call(null,_matcher.match(key));\t\r\n\t\t};\r\n\t\t_loadMatchConfig(config.lang);\r\n\r\n\t\treturn {\r\n\t\t\tmatch: function(key, data, callback, lang){\r\n\t\t\t\tif(lang && langs.indexOf(lang + \",\") > -1){\r\n\t\t\t\t\t_loadMatchConfig(lang, function(){\r\n\t\t\t\t\t\t_match(key,data, callback);\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\t_match(key, data, callback);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trefresh:function(lang){\r\n\t\t\t\tlang = lang && langs.indexOf(lang + \",\") > -1 ? lang : config.lang;\r\n\t\t\t\t_loadMatchConfig(config.lang);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n})();\r\n"]}